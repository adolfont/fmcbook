%{{{ [vim] 
% vim:foldmarker=%{{{,%}}}
% vim:foldmethod=marker
% vim:foldcolumn=7
%}}}
%% fmcmain.tex
%% author: Thanos Tsouanas <thanos@tsouanas.org>
%% Copyright (c) 2016, 2017 Thanos Tsouanas <thanos@tsouanas.org>
%% All rights reserved.

%%{{{ chapter: Introduction and prerequisites 
\chapter Introdução e prerequisitos.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

Pre-cálculo (revisão):
\cite{simmonsprecalculus}.

Sobre geometria euclideana:
\cite{elements},
\cite{coxeterrevisited};
\cite{hartshorneeuclidbeyond}.

Sobre calculus:
\cite{spivakcalculus},
\cite{hardypuremath};
\cite{apostol1}~\&~\cite{apostol2},
\cite{loomissternberg}.

Sobre álgebra linear:
\cite{janichlinalg},
\cite{halmoslapb},
\cite{halmosfdvs}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: The language of mathematics 
\chapter A linguagem de matemática.

%%{{{ Axioms, definitions, theorems, proofs 
\section Axiomas, definições, teoremas, provas.

\endsection
%%}}}

%%{{{ Notation: syntax and semantics 
\section Notação: sintaxe e semântica.

\endsection
%%}}}

%%{{{ Sets and functions 
\section Conjuntos e funções.

\endsection
%%}}}

%%{{{ Numbers, numerals, digits 
\section Números, numerais, dígitos.
% dígito aka "algarismo"
\endsection
%%}}}

%%{{{ Sorts of numbers 
\section Tipos de números.
% cyclic definitions
% from reals to nats
% from nats to reals
\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

\endchapter
%%}}}

%%{{{ chapter: The language of propositional logic 
\chapter A linguagem de lógica proposicional.

%%{{{ Its syntax 
\section Sua sintaxe.

\endsection
%%}}}

%%{{{ Its semantics 
\section Sua semântica.

\endsection
%%}}}

%%{{{ Its expressibility 
\section Sua expressibilidade.

\endsection
%%}}}

%%{{{ Syntactic sugar 
\section Açúcar sintática.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite[Cap.~1]{velleman}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: The language of predicate logic 
\chapter A linguagem de lógica de predicados.

%%{{{ Its syntax 
\section Sua sintaxe.

\endsection
%%}}}

%%{{{ Its semantics 
\section Sua semântica.

\endsection
%%}}}

%%{{{ Universes and structures 
\section Universos e mundos.

\endsection
%%}}}

%%{{{ Its expressibility 
\section Sua expressibilidade.

\endsection
%%}}}

%%{{{ Syntactic sugar 
\section Açúcar sintática.

\endsection
%%}}}

%%{{{ Sets and functions again 
\section Conjuntos e funções de novo.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite[Cap.~2]{velleman}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Direct proofs 
\chapter Provas diretas.

%%{{{ Proofs as games 
\section Provas como jogos.

\endsection
%%}}}

%%{{{ Attacking the logical structure of a proposition 
\section Atacando a estrutura logical duma proposição.

\endsection
%%}}}

%%{{{ Reductio ad absurdum 
\section Reductio ad absurdum.

\endsection
%%}}}

%%{{{ Proofs by cases 
\section Provas por casos.

\endsection
%%}}}

%%{{{ Existence and uniqueness proofs 
\section Provas de existência e unicidade.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite[Cap.~3]{velleman}

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Rational and irrational numbers 
\chapter Números racionais e irracionais.

%%{{{ Rationals and the pythagoreans 
\section Os racionais e os pitagoreanos.

\endsection
%%}}}

%%{{{ sqrt(2) is not rational 
\section O $\sqrt 2$ não é racional.

\endsection
%%}}}

%%{{{ But sqrt(2) surely is a number 
\section Mas o $\sqrt 2$ com certeza é um número.

\endsection
%%}}}

%%{{{ Irrational numbers 
\section Números irracionais.

\endsection
%%}}}

%%{{{ sqrt(3) is irrational 
\section O $\sqrt 3$ é irracional.

\endsection
%%}}}

%%{{{ A lemma 
\section Um lemma.

\endsection
%%}}}

%%{{{ What happens with sqrt(4) and sqrt(5) 
\section O que acontece com $\sqrt 4$ e $\sqrt 5$.

\endsection
%%}}}

%%{{{ A generalization theorem 
\section Um teorema de generalização.

\endsection
%%}}}

%%{{{ More irrational numbers 
\section Mais números irracionais.

\endsection
%%}}}

%%{{{ Algebraic and transcendental numbers 
\section Números algébricos e transcendentais.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{nivenirrational}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Recursion 
\chapter Recursão.

%%{{{ Defining functions 
\section Definindo funções.

\definition Os números Fibonacci.
\label{fibonacci}
\tdefined{Fibonacci}[seqüência]
Definimos os \emph{números Fibonacci}\Fibonacci[seqüência]\tdefined{Fibonacci}[números]{}
recursivamente assim:
$$
\align
    F_0     &= 0 \\
    F_1     &= 1 \\
    F_{n+2} &= F_{n+1} + F_n.
\endalign
$$

\note Computando seus valores.

\exercise Os números Lucas.
\label{lucas}%
\tdefined{Lucas}[números]%
Os números Lucas\Lucas[números]\tdefined{Lucas}[números]{} são definidos similarmente:
$$
\align
L_0     &= 2\\
L_1     &= 1\\
L_{n+2} &= L_{n+1} + L_n.
\endalign
$$
Calcule o valor $L_{12}$.

\endexercise

\endsection
%%}}}

%%{{{ The set of naturals, formally 
\section O conjunto dos naturais formalmente.

\endsection
%%}}}

%%{{{ Sums and products, formally 
\section Somatórios e produtórios formalmente.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\problem.
\label{products_in_disguise}
Seja $h \from\nats\to\nats$.
Defina recursivamente as funções $t \from \nats \to \nats$ e $T \from \nats^2 \to \nats$ que satisfazem:
$$
\align
t(n)   &= h(0)h(1)\dotsb h(n-1)     = \prod\limits_{i=0}^{n-1} h(i);\\
T(m,n) &= h(m)h(m+1)\dotsb h(m+n-1) = \prod\limits_{i=m}^{m+n-1} h(i).
\endalign
$$

\hint
Depois de definir confira tuas definições seguindo elas para calcular uns valores.
Por exemplo, $t(2)$ e $T(5,2)$ devem dar os resultados
$$
\xalignat2
t(2) &= h(0)h(1)
&
T(5,2) &= h(5)h(6).
\endxalignat
$$

\hint
Mesmo que a função $T$ tem aridade 2, escolhendo bem,
tu não precisarás escrever 4 equações, mas apenas 2.

\solution
Definimos
$$
\xalignat2
t      &\eqtype \nats\to\nats   &  T        &\eqtype \nats^2\to\reals\\
t(0)   &= 1                     &  T(m,0)   &= 1                     \\
t(n+1) &= h(n) \ntimes t(n)     &  T(m,k+1) &= h(m+k) \ntimes T(m,k).  
\endxalignat
$$
Tendo definido primeiro a $T$, podemos definir a $t$ assim:
$$
t(n) = T(0,n).
$$

\endproblem

\problem.
Tentando resolver o~\ref{products_in_disguise},
Victor definiu corretamente a $t$ e depois a usou
na sua definição de $T$, assim:
$$
T(m,n) = {t(m+n)}/{t(m)}.
$$
Qual o problema com essa definição?
(Assuma como conhecida uma definição recursiva da
operação $/$ de divisão inteira.)

\hint
Qual é o contradomínio da $h$?

\hint
$0\in\nats$.

\hint
O que acontece se $h(i) = 0$ para algum $i \in \nats$?

\solution
Se $h(i) = 0$ para algum $i \in \nats$,
o $t(j)=0$ para todo $j>i$.
Assim, a expressão
${t(m+n)}/{t(m)}$ não é definida para qualquer $m>i$.
Observe que a solução seria certa se
o contradomínio da $h$ fosse o $\nats\setminus\set0$.

\endproblem

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Functional programming 
\chapter Programação funcional.

%%{{{ Problems 
\problems.

\problem.
Considere as funções $q$, $r$, e $t$ definidas recursivamente:
$$
\xalignat3
q       &\eqtype \nats \to \nats   & r      &\eqtype \nats \to \nats   &  t          &\eqtype \nats^2 \to \bools     \\
q(0)    &=       0\phantom{666}    & r(0)   &=       0\phantom{666}    &  t(0,   0)  &=       \True          \\
q(1)    &=       0\phantom{666}    & r(1)   &=       1\phantom{666}    &  t(0,  Sn)  &=       \False         \\
q(2)    &=       0\phantom{666}    & r(2)   &=       2\phantom{666}    &  t(Sm,  0)  &=       \False         \\
q(n+3)  &=       q(n) + 1          & r(n+3) &=       r(n)              &  t(Sm, Sn)  &=       t(m,n)             
\endxalignat
$$
O que cada função calcula?

\hint
Calcule os valores $q(11)$, $q(12)$, $r(11)$, e $r(12)$.

\solution
\item{($q$:)}
    $q(n) = \bigg\lfloor{\dfrac n 3}\bigg\rfloor$.
\item{($r$:)}
    O $r(n)$ é o resto da divisão do $n$ por $3$.
\item{($t$:)}
    A $t$ decida se suas entradas são iguais ou não.

\endproblem

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{huttonhaskell},
\cite{lyah};
\cite{birdthinking},
\cite{thompsonhaskell};
\cite{birdfphaskell}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Induction 
\chapter Indução.

%%{{{ The principle of finite induction 
\section O princípio da indução finita (PIF).

\axiom Princípio da indução finita (PIF).
\tdefined{PIF}
\iiseealso{PIF}{indução}
\iisee{princípio}[da indução finita]{indução}
\tdefined{indução}
\label{FIP}
Seja $P(n)$ uma propriedade de naturais.
Se $P(0)$ e, para todo $k\in\nats$,
$P(k)$ implica $P(k+1)$,
então $P(n)$ é verdade para todo $n\in\nats$.

\note.
Esquematicamente o PIF:
$$
\left.
\aligned
\text{\casestyle{Base:}}\quad            & P(0)\\
\text{\casestyle{Passo Indutivo:}}\quad  & \lforall {k\in\nats} {P(k)\limplies P(k+1)}\quad
\endaligned
\right\}
\implies
\lforall {n\in\nats} {P(n)}.
$$

\example.
\label{gauss_child}
Prove que
$$
    1 + 2 + \cdots + n = \frac { n (n+1) } 2
$$
para todo $n\in\nats$.

\solution
Por indução, verificamos que a propriedade
$$
P(n)
\defiff
1 + 2 + \cdots + n = \frac { n (n+1) } 2
$$
é válida para todo $n$.
Primeiramente provamos a base
$$
P(0)
\iff
\underbrace{1 + 2 + \cdots + 0}_{\text{somatório vazio}}
= \frac { 0 (0+1) } { 2 }.
$$
Realmente, o lado esquerdo é um somatório vazio,
logo $0$, e o lado direito é o número $0(0+1)/2 = 0$ também.
Concluimos que $P(0)$.
\endgraf
Seja $k\in\nats$ tal que $P(k)$, ou seja,
$$
1 + 2 + \cdots + k = \frac { k (k+1) } 2.\tag{H.I.}
$$
Calculamos:
$$
\alignat 3
P(k+1)
&\iff& 1 + 2 + \cdots + (k+1)        &= \frac { (k+1) (k+2) } 2 \\
&\iff& 1 + 2 + \cdots + k + (k+1)    &= \frac { (k+1) (k+2) } 2 \\
&\iff& \frac { k (k+1) } 2  + (k+1)  &= \frac { (k+1) (k+2) } 2 \qqby{pela H.I.} \\
&\iff& k \cancel{(k+1)} + 2 \cancel{(k+1)} &= \cancel{(k+1)} (k+2) \\
&\iff& k + 2                         &= k + 2.
\endalignat
$$
\endexample

\exercise.
Prove que
$$
    1 + 8 + 27 + \cdots + n^3 = \paren{\frac { n (n+1) } { 2 } }^2
$$
para todo $n\in\nats$.

\hint
Lembre que o somatório vazio é $0$.

\endexercise

\exercise.
Observando os valores de:
$$
\align
    1
    +
    \frac 1 2
    &= 2 - \frac 1 2\\
    1
    +
    \frac 1 2
    +
    \frac 1 4
    &= 2 - \frac 1 4\\
    1
    +
    \frac 1 2
    +
    \frac 1 4
    +
    \frac 1 8
    &= 2 - \frac 1 8,
\intertext{adivinhe uma fórmula geral para o somatório}
    1 + \frac 1 2 + \frac 1 4 + \cdots + \frac 1 {2^n} &= \text{?}
\endalign
$$
e prove que ela é válida para todo $n\in\nats$.

\endexercise

\exercise.
Calculando os valores de:
$$
    \paren{1 - \frac 1 2},
   \qquad 
    \paren{1 - \frac 1 2}
    \paren{1 - \frac 1 3},
   \qquad
    \paren{1 - \frac 1 2}
    \paren{1 - \frac 1 3}
    \paren{1 - \frac 1 4},
$$
adivinhe uma fórmula geral para o produtório
$$
\prod_{i=2}^n\paren{ 1 - \frac 1 i}
=
    \paren{1 - \frac 1 2}
    \paren{1 - \frac 1 3}
    \paren{1 - \frac 1 4}
\dotsb
    \paren{1 - \frac 1 n}
$$
e prove que ela é válida para todo inteiro $n \geq 2$.

\endexercise

\exercise.
Prove que para todo $n \in\nats$,
$$
\sum_{i=1}^n i^2
= \frac {n^3} 3 + \frac {n^2} 2 + \frac n 6.
$$

\endexercise

\exercise.
Prove que para todo $n \in\nats$,
$$
\align
\sum_{i=1}^n i^3 &= \paren{\sum_{i=1}^n i}^2\\
\text{ou seja,}\qquad
1^3 + 2^3 + \dotsb + n^3 &= \paren{ 1 + 2 + 3 + \dotsb + n }^2.
\endalign
$$

\endexercise

\exercise.
\label{sum_of_threes_and_fives}
Qualquer número inteiro positivo $n \geq 8$ pode ser escrito
como somatório de $3$'s e $5$'s.

\endexercise

\exercise.
Seja
$$
P(n) \defiff 1 + 2 + \dotsb + n = \frac 1 8 \paren{2n + 1}^2.
$$
\item{(1)} Prove que para todo $k\in\nats$, se $P(k)$ então $P(k+1)$.
\item{(2)} Critique a sentença: ``\emph{Logo, por indução temos que $P(n)$ é válido para todo $n\in\nats$.}''
\item{(3)} Mudando o ``$=$'' para ``$>$'' ou ``$<$'', defina um novo predicado $P'(n)$, válido para todo $n\in\nats$, e prove a validade dele por indução.

\endexercise

\exercise.
Prove que para todo $n\in\nats$,
$$
\sum_{i=0}^n F_i = F_{n+2} - 1,
$$
onde $F_n$ o $n$-ésimo número Fibonacci.

\endexercise

\exercise.
Prove que para todo $n\in\nats$,
$$
\sum_{i=1}^n F_i^2 = F_n F_{n+1},
$$
onde $F_n$ o $n$-ésimo número Fibonacci.

\endexercise

\exercise.
Prove que para todo inteiro $n \geq 1$.
$$
    \frac 1 {1 \cdot 2} +
    \frac 1 {2 \cdot 3} +
    \frac 1 {3 \cdot 4} + \cdots + 
    \frac 1 {n (n+1)}
    =
    \frac n {n+1}
$$

\endexercise

\exercise.
Prove que para todo inteiro $n \geq 5$,
$$
    n^2 < 2^n.
$$

\endexercise

\endsection

%%}}}

%%{{{ When one base is not enough 
\section Quando uma base não é suficiente.

\proposition.
\label{lucas_altdef_first_attempt}
Para todo inteiro $n \geq 1$,
seja $\ell \from \nats\setminus\set0\to\nats$ a função definida pela equação
$$
    \ell(n) = F_{n-1} + F_{n+1},
$$
onde $F_n$ é o $n$-ésimo número \Fibonacci{}Fibonacci (veja~\ref{fibonacci}).
Queremos mostrar que para todo $n \geq 1$, $L_n = \ell(n)$,
onde $L_n$ é o $n$-ésimo número \Lucas{}Lucas (veja~\ref{lucas}).
\wrongproof.
Nos vamos provar por indução que \emph{para todo $n \geq 1$, $L_n = \ell(n)$}.
Vamos primeiramente verificar que para $n=1$, realmente temos $L_n = \ell(n)$:
$$
\alignat 2
\ell(1) &= F_0 + F_2      \qqby{def.~de $\ell(n)$} \\
        &= 0 + F_1 + F_0  \qqby{def.~de $F_n$}     \\
        &= 0 + 1 + 0      \qqby{def.~de $F_n$}     \\
        &= 1              \\
        &= L_1.           \qqby{def.~de $L_n$}
\intertext{Seja $k\in\nats$ com $k\geq 2$, tal que $L_{k-1} = \ell(k-1)$.
Realmente temos}
L_k
&= L_{k-1} + L_{k-2}                        \qqby{def.~de $L_n$}\\
&= \ell(k-1) + \ell(k-2)                    \qqby{H.I.}\\
&= (F_{k-2} + F_k) + (F_{k-3} + F_{k-1})    \qqby{def.~de $\ell(n)$}\\
&= (F_{k-2} + F_{k-3}) + (F_k + F_{k-1})    \qqby{ass.~e com.~de $+$}\\
&= F_{k-1} + F_{k+1}                        \qqby{def.~de $F_n$}\\
&= \ell(k)                                  \qqby{def.~de $\ell(n)$}.
\endalignat
$$
que termina nossa prova.
\mistaqed

\exercise.
\label{lucas_altdef_find_error}
Na prova em cima roubamos.
Ache onde e explique como, e pense numa solução.

\endexercise

\proposition.
\label{lucas_altdef_final}
Com a notação da~\ref{lucas_altdef_first_attempt},
para todo $n\geq 1$, $\ell(n) = L_n$.
\proof.
Nos vamos provar por indução que \emph{para todo $n \geq 1$, $L_n = \ell(n)$}.
Vamos primeiramente verificar que para $n=1$ e $n=2$, realmente temos $L_n = \ell(n)$.
Para $n=1$:
$$
\alignat 2
\ell(1) &= F_0 + F_2      \qqby{def.~de $\ell(n)$} \\
        &= 0 + F_1 + F_0  \qqby{def.~de $F_n$}     \\
        &= 0 + 1 + 0      \qqby{def.~de $F_n$}     \\
        &= 1              \\
        &= L_1.           \qqby{def.~de $L_n$}
\endalignat
$$
E para $n=2$:
$$
\xalignat2
\alignedat 2
      L_2 &= L_1 + L_0  \qqby{def.~de $L_n$} \\
          &= 1 + 2      \qqby{def.~de $L_n$} \\
          &= 3          
\endalignedat
&&
\alignedat 2
\ell(2) &= F_1 + F_3          \qqby{def.~de $\ell(n)$}  \\
        &= 1 + F_2 + F_1      \qqby{def.~de $F_n$}      \\
        &= 1 + 1 + 1          \\
        &= 3.
\endalignedat
&
\endxalignat
$$
Seja $k\in\nats$ com $k\geq 3$ tal que
$$
L_{k-1} = \ell(k-1)
\qquad
\text{e}
\qquad
L_{k-2} = \ell(k-2)
$$
(nossas \emph{duas} hipoteses indutivas).
Vamos provar que $L_k = \ell(k)$.
Realmente temos
$$
\alignat 2
L_k
&= L_{k-1} + L_{k-2}                        \qqby{def.~de $L_n$}\\
&= \ell(k-1) + \ell(k-2)                    \qqby{H.I.}\\
&= (F_{k-2} + F_k) + (F_{k-3} + F_{k-1})    \qqby{def.~de $\ell(n)$, $k\geq3$}\\
&= (F_{k-2} + F_{k-3}) + (F_k + F_{k-1})    \qqby{ass.~e com.~de $+$}\\
&= F_{k-1} + F_{k+1}                        \qqby{def.~de $F_n$, $k\geq3$}\\
&= \ell(k)                                  \qqby{def.~de $\ell(n)$},
\endalignat
$$
que termina nossa prova.
\qed

\exercise.
Ache uma nova prova do~\ref{sum_of_threes_and_fives} por indução
com três bases.

\hint
$k = (k-3) + 3$.

\solution
Seja $k\geq 8 + 3 = 11$ tal que $k-1$, $k-2$, e $k-3$
podem ser escritos como somatórios de $3$'s e $5$'s (H.I.).
Temos
$$
\alignat 2
k &= (k-3) + 3      \\
  &= (3x + 5y) + 3  \quad\text{para alguns $x,y\in\nats$} \qqby{pela H.I.} \\
  &= 3(x+1) + 5y.
\endalignat
$$
Como precisamos a vericidade da proposição para o valor $k-3$,
devemos mostrar as $3$ bases, para os inteiros $8$, $9$, e $10$:
$$
\alignat 2
8  &= 3 + 5     &&= 3\ntimes 1 + 5\ntimes 1\\
9  &= 3 + 3 + 3 &&= 3\ntimes 3 + 5\ntimes 0\\
10 &= 5 + 5     &&= 3\ntimes 0 + 5\ntimes 2.
\endalignat
$$

\endexercise

\endsection
%%}}}

%%{{{ Many variables 
\section Muitas variáveis.

%TODO explain that it's just one more tool to attack theorems
%TODO XXX Maybe refer to a weaker result from "irrationality"?
\lemma.
\label{odd_to_any_power_is_odd}
Para todo $n\in\nats$, e todo impar $k\in\ints$, $k^n$ é impar.
\proof.
Seja $k\in\ints$ impar, então $k=2a+1$ para um $a\in\ints$.%
\footnote{%
Aqui consideramos a seguinte definição de ``impar'':
\emph{um inteiro $n$ é \dterm{impar} sse existe inteiro $k$ tal que $n = 2k+1$.}
}
Vamos provar por indução que para todo $n\in\nats$, $k^n$ é impar.
Se $n=0$, imediatamente $k^0 = 1$ e é impar ($1 = 2\ntimes 0 + 1$).
Suponha que para algum $t\in\nats$, $k^t$ é impar, ou seja $k^t = 2b+1$ para um $b\in\ints$.
Falta provar que $k^{t+1}$ também é impar.
Calculando,
$$
\alignat2
k^{t+1}
&= k k^t               \qqby{definição de exponenciação} \\
&= (2a + 1) (2b + 1)   \qqby{hipoteses}    \\
&= 4ab + 2a + 2b + 1   \\
&= 2(2ab + a + b) + 1.
\endalignat
$$
Logo, como $2ab + a + b\in\ints$, $k^{t+1}$ é impar.
\qed

\endsection
%%}}}

%%{{{ Strong induction 
\section O princípio da indução finita forte (PIFF).
\label{sec:strong_induction}

\note.
O seguinte princípio parece mais forte que o PIF.
Na verdade, nos naturais, os dois princípios são equivalentes:

\theorem Princípio da indução finita forte (PIFF).
\tdefined{PIFF}
\iiseealso{PIFF}{indução}
\tdefined{indução}[forte]
\iisee{princípio}[da indução finita forte]{indução forte}
\label{FSIP}
Seja $P(n)$ uma propriedade de naturais.
Se para todo $k\in\nats$,
a hipótese que $P(i)$ é verdade para todo $i<k$
implica que $P(k)$ também é,
então $P(n)$ é verdade para todo $n\in\nats$.

\note.
Esquematicamente o PIFF:
$$
\lforall
    {k\in\nats}
    {\vphantom{\bigg(}\Big(\lforall {i < k} {P(i)}\Big) \limplies P(k)}
\implies
\lforall
    {n\in\nats}
    {P(n)}.
$$

\endsection
%%}}}

%%{{{ The well-ordering principle 
\section O princípio da boa ordem (PBO).
\label{sec:wop}%

\definition Elemento mínimo.
\tdefined{mínimo}%
\sdefined {\min {\holed A}} {mínimo do \holed A}%
Seja $A$ um conjunto ordenado.
Um elemento $m\in A$ é chamado
\dterm{(elemento) mínimo do $A$}
sse
$m$ é menor de todos os outros elementos do $A$.
Quando o conjunto $A$ possui elemento mínimo,
escrevemos $\min A$ para o denotar:
$$
m = \dsym{\min A} \defiff m\in A \;\land\; \lforall {a\in A} {a \neq m \limplies m < a}.
$$

Note que necessariamente o mínimo dum conjunto $A$ pertence no $A$.
Para justificar a definição do símbolo $\min A$, \emph{devemos} provar o seguinte:

\exercise Unicidade de mínimo.
Um conjunto não pode ter mais que um elemento mínimo.

\hint
Suponha que tem dois mínima diferentes
e aplicando a definição de ``mínimo''
e propriedades de $<$,
chega numa contradição.

\hint
Pela transitividade, $a<b$ e $b<a$ implicam uma contradição.

\endexercise

\exercise.
Seja $U$ um conjunto unitário ordenado.
Prove que ele tem elemento mínimo.

\endexercise

\exercise.
Seja $A$ um conjunto ordenado, e um subconjunto finito $A_0\finsubseteq A$,
com $A_0\neq\emptyset$.
O $A_0$ possui elemento mínimo.

\hint
Indução no tamanho do $A_0$.

\endexercise

\theorem Princípio da boa ordem (PBO).
\tdefined{PBO}%
\tdefined{princípio}[da boa ordem]%
\label{WOP}%
\iiseealso{PBO}{princípio da boa ordem}%
Cada subconjunto não vazio do\/ $\nats$ possui mínimo.
\sketch.
Seja $P(n)$ a propriedade que cada subconjunto $A\subseteq\nats$
que possui elementos menores ou iguais a $n$ tem mínimo.
Vamos mostrar por indução que para todo $n$, $P(n)$.
\qes

\exercise.
Quais dos $\ints$, $\rats$, $\rats_{>0}$, $\rats_{\geq0}$, $\reals$,
satisfázem a propriedade de boa ordem?

\endexercise

\exercise.
Seja $a\in\reals$.
Quais dos $\rats_{\geq a}$, $\reals_{\geq a}$,
e $\set{ 2^{-n} \st n \in\nats, n \leq a}$
satisfázem a propriedade de boa ordem?

\endexercise

\theorem.
\label{no_int_between_0_and_1}%
Não existe inteiro $k$ tal que\/ $0 < k < 1$.
\sketch.
Suponha que existe um tal inteiro $k$.
Então o conjunto $C=\set{c\in\ints\st 0 < c < 1}$ de todos os ``contraexemplos''
não é vazio.
Aplique o PBO para tomar seu menor elemento, e ache um outro contraexemplo,
ainda menor, chegando assim numa contradição.
\qes

\exercise.
Prove o \ref{no_int_between_0_and_1} usando indução.

\hint
Nenhum inteiro negativo satisfaz $0 < m < 1$.
Então para provar que nenhum inteiro fica estritamente entre $0$ e $1$, basta provar
que todos os não-negativos $n$ satisfazem $n=0$ ou $n\geq 1$

\hint
Seja
$
P(n) \defiff \text{$n=0$ ou $n\geq1$}
$.

\hint
A base é trivial.

\hint
Para o passo indutivo, tomando um $k\in\nats$ tal que $P(k)$, separa tua prova
em dois casos, dependendo da razão que o $P(k)$ seja verdade.

\endexercise

\exercise.
Sejam $a,b\in\ints$ com $ab=1$.
Prove que $a=\pm1$ e $b=\pm1$.

\endexercise

\theorem Indução, forma com conjuntos.
\tdefined{indução}[forma com conjuntos]
\label{PIF_set_form}
Seja $A\subseteq\nats$ tal que $0\in A$ e $n+1\in A$ para todo $n\in A$.
$A=\nats$.
\sketch.
Caso contrario, existeriam ``contraexemplos'', ou seja, naturais que não pertencem no $A$.
Aplique a PBO para escolher o menor tal contraexemplo, e chega num absurdo.
\qes

\exercise.
Prove que se um subconjunto $A$ de inteiros tem elementos maiores que um número fixo $n_0$,
então existe o $\min\set{a\in A\st n_0 < a}$.

\endexercise

\endsection
%%}}}

%%{{{ Problems 
\problems.

\problem.
Cada conjunto finito e não vazio $A\subseteq\reals$ possui
elemento mínimo $\min A$ e máximo $\max A$.

\hint
Indução no número de elementos do $A$.

\endproblem

\problem Triminôs.

\endproblem

\problem.
\ii{PIF}%
\ii{PIFF}%
$\text{PIF} \iff \text{PIFF}$.

\endproblem

\problem Cadê a base da indução forte?.
Seguindo o teorema em cima, parece que não precisamos provar uma ``base''
na indução forte.
Critique a seguinte afirmação:
``\emph{Quando quero provar um teorema da forma
$\forall n P(n)$
usando indução, eu preciso mostrar uma(s) base(s)
$P(0), P(1), \dotsc, P(b)$
e depois provar o $P(k+1)$,
dado apenas umas $b+1$ hipóteses:
$P(k), P(k-1), \dotsc, P(k-b)$.
No outro lado, usando indução forte eu preciso mostrar menos
coisas---não tenho que mostrar nenhuma base---,
e, alem disso, no meu esforço para provar o $P(k+1)$,
eu não vou ter apenas umas poucas hipóteses, mas
todos os $P(i)$ para $i<k+1$!
Como os dois princípios são equivalentes no $\nats$,
eu vou sempre usar indução forte.}''

\hint Quantos $i\in\nats$ satisfazem $i < 0$?

\endproblem

\endproblems
%%}}}

%%{{{ Further reading 
\further.

Mais informações sobre indução e indução forte,
veja o~\cite[Cap.~6]{velleman}.
Sobre o princípio da boa ordem e indução,
veja o~\cite[\S\S1.4--1.5]{babybm}

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Elementary number theory 
\chapter Teoria elementar de números.
\label{chap:elementary_number_theory}

%%{{{ Factorization 
\section Fatorização.
\label{sec:factorization}

\question.
\emph{Dado um inteiro positivo $n$, como podemos ``o quebrar'' em blocos de construção?}

\note.
Vamos primeiramente responder nessa questão com outra:
\emph{Qual seria nosso ``cimento''?}
Tome como exemplo o número $n=28$.
Usando $+$ para o construir com blocos, podemos o quebrar:
$$
\align
28 &= 16 + 12.
\intertext{E agora quebramos esses dois blocos:}
   &= \overbrace{10 + 6}^{16} + \overbrace{11 + 1}^{12};
\intertext{e esses:}
   &= \overbrace{3 + 7}^{10} + \overbrace{3 + 3}^{6} + \overbrace{4 + 7}^{11} + 1
\intertext{e o $1$ não é mais ``quebrável''.
Nesse sentido, ele é um bloco atómico, um ``tijolo''.
Repetimos esse processo até chegar num somatório cujos termos são todos tijolos:}
 &= \underbrace{1 + 1 + 1 + 1 + \dotsb + 1}_{\text{$28$ termos}}.
\endalign
$$
O leitor é convidado pensar sobre as próximas observações:
\beginol
\li
Começando com qualquer inteiro positivo $n$,
depois um \emph{finito} número de passos, o processo termina:
nenhum dos termos que ficam pode ser quebrado.
\li
Existe apenas um tipo de bloco atómico: o $1$.
Podemos então formar qualquer número $n$ começando com $n$ tijolos ($n$ $1$'s)
e usando a operação $+$ para os juntar.
\endol

\exercise.
\label{partitioning_restricted_best_strategy}
Qual é a melhor estratégia para desconstruir o $n$ em $1$'s conseguindo
o menor número de passos possível?  Quantos passos precisa?
Suponha que em cada passo tu tens que escolher apenas \emph{um} termo (não
atómico) e decidir em quais duas partes tu o quebrarás.

\hint
Olha na forma final do somatório.
O que acontece em cada passo?

\solution
Todas as estratégias são iguais: em cada passo, um $+$ é adicionado,
e todas terminam no mesmo somatório com $n$ $1$'s e $n-1$ $+$'s.
Então começando com qualquer número $n$, depois de $n-1$ passos chegamos
na sua forma $n = 1+1+\dotsb +1$.

\endexercise

\exercise.
Prove formalmente tua resposta no~\ref{partitioning_restricted_best_strategy}.

\hint
Como nos livramos dos pontos informais ``$\dotsb$''?

\hint
Indução.

\hint
Seja $steps(x)$ o número de passos necessários para quebrar o $x$ em $1$'s.

\endexercise

\note ``$\,\ntimes\,$'' ao invés de ``$\,+\,$''.
Vamos agora usar como cimento a operação $\ntimes$,
ilustrando o processo com o número $2016$:
\goodbreak
$$
\align
2016
&= 12 \ntimes 168
\intertext{e repitimos\dots}
&= \overbrace{4\ntimes 3}^{12} \ntimes \overbrace{28 \ntimes 6}^{12}
\intertext{e agora vamos ver:
o $4$ pode se quebrado sim ($2\ntimes2$), mas o $3$?
Escrever $3 = 3\ntimes 1$ com certeza não é um jeito aceitável para quebrar o $3$
em blocos de construção ``mais principais'': o lado direto é mais complexo!
Quebrando com $\ntimes$ então, o $3$ é um bloco atómico, um tijolo!
Continuando:}
&= \overbrace{2\ntimes 2}^{4}{} \ntimes 3 \ntimes (7\ntimes 4) \ntimes (2\ntimes3)\\
&= 2\ntimes 2 \ntimes 3 \ntimes 7 \ntimes \overbrace{2\ntimes2}^4{} \ntimes 2\ntimes3
\intertext{onde todos os fatores são atómicos.
Podemos construir o número $2016$ então assim:}
2016 &= 2\ntimes 2 \ntimes 3 \ntimes 7 \ntimes 2\ntimes2 \ntimes 2\ntimes3,
\endalign
$$
usando os tijolos 2, 3, e 7, e a operação de multiplicação.
Nos vamos definir formalmente esses tijolos (são os \ii{primo}[informalmente]\dterm{primos},~\ref{prime}),
e estudar suas propriedades.

Ilustrando com o mesmo número $2016$, um outro caminho para processar seria o seguinte:
$$
\align
2016
&= 48 \ntimes 42 \\
&= \overbrace{8 \ntimes 6}^{48} \ntimes \overbrace{6\ntimes 7}^{42}\\
&= \overbrace{2\ntimes 4}^{8} \ntimes \overbrace{2\ntimes 3}^{6} \ntimes \overbrace{2\ntimes 3}^{6}{}\ntimes 7\\
&= 2 \ntimes \overbrace{2\ntimes 2}^{4}{} \ntimes 2\ntimes 3 \ntimes 2\ntimes 3\ntimes 7
\intertext{então no final temos:}
2016&= 2 \ntimes 2 \ntimes 2 \ntimes 2 \ntimes 3 \ntimes 2 \ntimes 3 \ntimes 7.
\endalign
$$

\exercise.
\label{fundamental_theorem_of_arithmetic_omen}
O que tu percebes sobre as duas desconstruções?:
$$
\align
2016 &= 2\ntimes 2 \ntimes 3 \ntimes 7 \ntimes 2\ntimes2 \ntimes 2\ntimes3;\\
2016 &= 2 \ntimes 2 \ntimes 2 \ntimes 2 \ntimes 3 \ntimes 2 \ntimes 3 \ntimes 7.
\endalign
$$

\solution
Esquecendo a ordem que os fatores parecem, são iguais:
cada construção precisa os mesmos blocos atómicos (o $2$, o $3$, e o $7$),
e cada um deles foi usado o mesmo número de vezes:
$2016 = 2^5 3^2 7$.

\endexercise

\exercise.
\label{factorize_some_integers}%
Fatorize os inteiros $15$, $16$, $17$, $81$, $100$, $280$, $2015$, e $2017$
em fatores primos.

\solution
Calculamos:
$$
\alignat 4
15   &= 3 \ntimes 5 \qquad&  17   &= 17          \qquad& 100  &= 2^2\ntimes 5^2           \qquad& 2015 &= 5\ntimes 13\ntimes 31  \\
16   &= 2^4         \qquad&  81   &= 3^4         \qquad& 280  &= 2^3 \ntimes 5 \ntimes 7  \qquad& 2017 &= 2017.
\endalignat
$$

\endexercise

\codeit FactorNaive.
\label{program_factor_naive}
Escreva um programa que mostra para cada entrada, sua fatorizações em primos.
Executa teu programa para verificar tuas respostas no~\ref{factorize_some_integers}.
\endcodeit

\question.
Usando adição, nos precisamos apenas um tipo de tijolo para construir qualquer
inteiro positívo: o $1$.
Usando a multiplicação nos já percebemos que vários tipos são necessários; mas quantos?

\note.
A pergunta e sua resposta não são triviais!
Recomendo para ti, tentar responder e \emph{provar} tua afirmação.
Logo vamos encontrar a resposta (de Euclides)
que é um dos teoremas mais famosos e importantes na história de matemática
(\ref{primes_is_infinite}).

No fim do capítulo chegamos no resultado principal
que esclareçará o~\ref{fundamental_theorem_of_arithmetic_omen}:
o Teorema Fundamental de Aritmética (\ref{fundamental_theorem_of_arithmetic}),
ilustrado (parcialmente!) já por \Euclid{}Euclides
(circa~\oldstyle{300}~a.C.)~nos seus \Euclid[Elementos]\emph{Elementos}
de Euclides\Euclid~\cite{elements}
e provado completamente e formalmente por \Gauss{}Gauss
(no ano \oldstyle{1798}) no seu
\emph{Disquisitiones Arithmeticæ}\Gauss[Disquisitiones Arithmiticæ]~\cite{disquisitiones}.

\endsection
%%}}}

%{{{ Divisibility 
\section Divisibilidade.
\label{sec:divisibility}

\definition Divisibilidade.
\label{divides}%
\tdefined{divide}%
\tdefined{divisor}%
\tdefined{multiplo}%
\tdefined{divisível}%
\sdefined {\holed a\divides \holed b} {\holed a divide \holed b}%
Sejam $a,b\in\ints$.
Digamos que \dterm{o $a$ divide o $b$} (ou \dterm{o $b$ é divisível por $a$}), sse existe $b = ak$ para algum $k\in\ints$.
Nesse caso, escrevemos $a\divides b$.
Em símbolos:
$$
a\divides b \defiff \lexists {k\in\ints} {b = ak}.
$$
Os \dterm{divisores} do $a$ são todos os inteiros $d$ tais que $d \divides a$.
Naturalmente, usamos a notação $a\ndivides b$ quando $a$ não divide $b$.

\example. $3 \divides 12$, porque $12 = 3 \ntimes 4$ e $4\in\ints$, mas
$8 \ndivides 12$, porque nenhum inteiro $u$ satisfaz $12 = 8u$.
\endexample

\exercise Propriedades da divisibilidade.
\label{divides_properties}
Sejam $a,b,x,y,m\in\ints$.
Prove que:
\doublecolumns
\beginol
\li[1_is_the_bottom_of_divides] $1 \divides a$
\li[0_is_the_top_of_divides] $a \divides 0$
\li $a \divides b \implies a \divides bx$
\li $a \divides b \implies a \divides -b \mland -a \divides b$
\li $a \divides b \mland a \divides c \implies a \divides b + c$
\li $a \divides b \mland a \divides c \implies a \divides bx + cy$
\li $a \divides b \mland b \neq 0 \implies \abs a \leq \abs b$
\li se $m\neq0$ então: $a \divides b \!\iff\! ma \divides mb$.
\endol
\singlecolumn

\hint Aplique a definição do $\divides$.

\endexercise

\exercise Mais propriedades da divisibilidade.
\label{divides_is_almost_antisymmetric}%
\label{divides_is_a_partial_order_on_nats}%
Para todos $a,b,c\in\ints$,
$$
\alignat 2
&a \divides a                                           &&\text{(reflexividade)}\\
&a \divides b \mland b \divides c \implies a \divides c &&\text{(transitividade)}\\
&a \divides b \mland b \divides a \implies \abs a = \abs b.   &&
\intertext{
Se $a,b\in\nats$, a terceira propriedade fica mais forte:
}
&a \divides b \mland b \divides a \implies a = b        &\quad&\text{(antisimetria)}.
\endalignat
$$

\endexercise

\proposition.
\label{wrong_property_of_product_dividing_common_multiple}
Sejam $a,b,m\in\ints$.  Se $a \divides m$ e $b \divides m$, então $ab \divides m$.
\wrongproof.
Como $a\divides m$, pela definição de $\divides$, existe $u\in\ints$ tal que
$a = mu$.  Similarmente, como $b\divides m$, existe $v\in\ints$ tal que
$b = mv$.  Multiplicando as duas equações por partes, temos
$$
ab = (mu)(mv) = m(umv),
$$
e como $umv\in\ints$, $ab \divides m$.
\mistaqed

\exercise.
Ache o erro na prova em cima e \emph{prove} que a proposição é falsa!

\hint Presta atenção na definição do $\divides$.

\hint Procure um contraexemplo onde $a$ e $b$ tem um fator em comun.

\solution
O erro fica na aplicação da definição de $a \divides b$\thinspace:
ao invés de $\lexists {k\in\ints} {b = ak}$,
a prova usou $\lexists {k\in\ints} {a = bk}$.
\endgraf
Para ver que a proposição realmente é falsa, considere o contraexemplo seguinte:
$$
a = 6,\qquad
b = 15,\qquad
m = 30.
$$
Realmente temos
$6  \divides 30$ e 
$15 \divides 30$,
mas
$6\ntimes 15 = 90 \ndivides 30$.

\endexercise

\note.
Nos encontramos a ``versão correta'' da proposição falsa em cima no item~\refn{wrong_property_of_product_dividing_common_multiple} depois (\ref{product_of_coprimes_divides_common_multiple}).

\exercise.
\label{implications_with_divisibility_of_linear_combinations}
Sejam $a,b,c\in\ints$.
Para cada afirmação em baixo, prove-la ou desprove-la:
$$
\alignat2
&\text{(i)}   \qquad& a \divides \phantom1b + c\phantom1                          &\implies a \divides b \mland a \divides c\\
&\text{(ii)}  \qquad& a \divides b + c \mland a \divides \phantom1b - c\phantom2  &\implies a \divides b                    \\
&\text{(iii)} \qquad& a \divides b + c \mland a \divides \phantom1b + 2c          &\implies a \divides b                    \\
&\text{(iv)}  \qquad& a \divides b + c \mland a \divides 2b + 2c                  &\implies a \divides b                    \\
&\text{(v)}   \qquad& a \divides b + c \mland a \divides 2b + 3c                  &\implies a \divides 3b + 2c\,.
\endalignat
$$

\solution
A (ii) é falsa: um contraexemplo seria o $a = 2$, $b = c = 1$.
Realmente, temos
$$
2 \divides 1 + 1 = 2 \mland 2 \divides 1 - 1 = 0,\qquad \text{mas}\qquad 2\ndivides 1.
$$
\endgraf
A (iii) é verdadeira:
$$
\left.
\aligned
        a\divides b + c \implies a\divides 2b + 2c\\
                                 a\divides \phantom1b + 2c
\endaligned
\right\}
\implies
a \divides \underbrace{(2b + 2c) - (b + 2c)}_{\dsize b}.
$$

\endexercise

\definition Primo.
\label{prime}
\tdefined{primo}
\tdefined{composto}
\iiseealso{composto}{primo}
\iiseealso{primo}{composto}
Seja $p\in\nats$, com $p \geq 2$.
Chamamos o $p$ \dterm{primo} sse $p$ é divisível apenas por $\pm 1$ e $\pm p$.
Caso contrario, ele é \dterm{composto}.

\exercise.
O $0$ é primo?  Composto?
O $1$ é primo?  Composto?

\solution
Nenhum dos dois é nem primo nem composto: a definição começa declarando
$p$ como um natural tal que $p \geq 2$.
Logo, não é aplicável nem para o 0 nem para o 1.

\endexercise

\exercise.
\label{2_is_the_only_even_prime}
2 é o único primo par.

\endexercise

\exercise.
Usando uma fórmula de lógica, defina diretamente o que significa que
um $n\in\nats\setminus\set 1$ é composto.

\solution
Seja $n\in\nats$.
$$
\namedpred{Composite}(n) \defiff
\lexists {a,b\in\nats\setminus\set{0,1}} { n = ab }.
$$

\endexercise

\note.
{\input knuthprimes
Os primeiros 31 primos são os \primes{31}.}

\exercise.
\label{in_primes_divides_means_equals}
Sejam $p$, $q$ primos, com $p\divides q$.
Mostre que $p=q$.

\endexercise

\exercise.
\label{every_composite_number_is_divisible_by_a_prime}
Seja $b$ composto.  Prove que $b$ tem um divisor primo $d\leq \sqrt b$.

\endexercise

\codeit factor.
\label{program_factor}
Use o~\ref{every_composite_number_is_divisible_by_a_prime}
para melhorar teu programa do~\ref{program_factor_naive}.
\endcodeit

\endsection
%%}}}

%%{{{ The division algorithm 
\section O algoritmo da divisão.

\lemma Divisão de Euclides.
\label{division_of_euclid}%
\Euclid[lema da divisão]%
\iisee{divisão}{Euclides}%
Dados inteiros $a$ e $b$ com $b>0$, existem inteiros $q$ e $r$ tais que:
$$
a = bq + r,
\qquad
0\leq r < b.
\eqdef{division}
$$
Alem disso, os $q$ e $r$ são \emph{determinados unicamente}.
\sketch.
\endgraf
\proofstyle{Existência:}
Considera a seqüência infinita:
$$
\ldots,~
-3b + r,~
-2b + r,~
-b + r,~
r,~
b + r,~
2b + r,~
3b + r,~
\ldots
$$
Observe que ela tem elementos não-negativos e, aplicando a PBO, considera o menor deles.
\endgraf
\proofstyle{Unicidade:}
    Suponha que $a=bq+r=bq'+r'$
    para alguns $q,r,q',r'\in\ints$ tais que satisfazem as restrições
    $0\leq r < b$ e $0\leq r' < b$.
    Mostre que $r=r'$ e $q=q'$.
\qes

Por causa dessa existência e unicidade, podemos definir:

\definition Devisão.
\tdefined{divisão}
\tdefined{quociente}[divisão]
\sidx[see]{quociente}{divisão} 
Dados $a,b\in\ints$ com $b>0$, chamamos os inteiros $q$ e $r$ que satisfazem
a~\eqref{division}
Chamamos o $q$ o \dterm{quociente} e o $r$ o
\dterm{resto}\tdefined{resto}[divisão] da divisão de $a$ por $b$.

\exercise.
\label{n_divides_exactly_one_of_n_consecutive_integers}
Seja $n\in\nats$ positivo.  Se $a_0,a_1,\dotsc,a_{n-1}$ são $n$ inteiros consecutivos,
então $n\divides a_i$ para um único $i\in\set{0,\dots,n-1}$.

\hint
Seja $a=a_0$.  Assim $a_i = a + i$.

\hint
Divida o $a$ por $n$, e olhando para o resto $r$,
ache o certo $i$ tal que $n\divides a_i$.

\hint
Para a unicidade, ache o resto da divisão de $n$ por o aleatorio $a_j$.

\endexercise

\exercise.
Prove que para todo $n\in\ints$, se $3\ndivides n$
então $3 \divides n^2 - 1$.

\hint
Ou fatorize o $n^2-1$ e use o~\ref{n_divides_exactly_one_of_n_consecutive_integers},
ou considere os dois casos possíveis dependendo dos restos da divisão de $n$ por $3$.

\endexercise

\definition Conjunto fechado sobre $+$.
    Seja $A$ conjunto de números que satisfaz a propriedade:
    $$
    a,b \in A \implies a+b \in A.
    $$
    Digamos que $A$ é \dterm{fechado} sobre $+$.

\exercise.
O $\emptyset$ e o $\set{0}$ são fechados sobre $+$.

\endexercise

\exercise.
Generaliza a noção em cima para definir a noção
``conjunto fechado sobre $f$'',
onde $f$ é uma operação no $A$ de aridade qualquer.

\endexercise

\exercise.
Quais dos conjuntos em baixo são fechados sobre $+$, quais sobre $-$, e quais sobre $\cdot$?
$$
\aligned
    U &= \set{0}\\
    W &= \set{0,1}\\
    P &= \set{1,2,4,8,16,\dotsc}\\
    I &= \set{1,1/2,1/4,1/8,1/16,\dotsc}
\endaligned
\quad
\aligned
    A &= \set{0,4,6,10,12,16,18,22,24,\dotsc}\\
    B &= \set{0,2,4,6,8,10,12,\dotsc}\\
    C &= \set{\dotsc,-9,-6,-3,0,3,6,9,\dotsc}\\
    D &= \set{\dotsc,-8,-5,-2,1,4,7,10,\dotsc}.
\endaligned
$$

\endexercise

\exercise.
Defina os conjuntos infinitos do exercísio anterior sem usar ``$\ldots$\!''.

\endexercise

\exercise.
O $\rats$ é fechado sobre quais das quatro operações binárias: $+$, $-$, $\cdot$, $\div$?
E o $\rats\setminus\set0$?

\endexercise

\exercise.
Prove que se um conjunto é fechado sobre $-$, ele tem que ser fechado sobre $+$ também, mas não o converso!

\endexercise

Um conjunto de inteiros fechado sobre $-$ (e $+$), não tem muita liberdade na ``forma'' dele.
O teorema seguinte mostra a forma geral de todos eles.

\theorem.
\label{form_of_closed_under_minus}
Seja $S\subseteq\ints$, com $S\neq\emptyset$, $S$ fechado sobre $-$ (e logo, sobre $+$ também).
Prove que $S=\set 0$ ou $S$ possui um mínimo elemento positivo $m$ e $S = \set{ km \st k \in\ints}$.

\exercise.
Sem usar disjunção, escreva uma frase equivalente com a conclusão do
\ref{form_of_closed_under_minus}, e explique porque ela é equivalente.

\hint Existe $n\in\nats$ tal que $S = \set{ kn \st k\in\ints}$.

\endexercise

\endsection
%%}}}

%%{{{ The greatest common divisor 
\section O máximo divisor comum.

\definition.
\label{a_gcd}%
Sejam $a,b\in\ints$.
O inteiro $d$ é \dterm{um máximo divisor comum (m.d.c.)}~dos $a$~e~$b$,
sse $d$~é~um divisor comum e um multiplo de todos os divisores comuns.
Em símbolos:
\endgraf\vskip 1ex\noindent
\line{\hfill
$
d = \dsym{\gcd a b}
\defiff
\underbrace{
d \divides a
\;\land\;
d \divides b
}_{\text{divisor comun}}
\;\land\;
\underbrace{
\lforall c {c\divides a \;\land\; c\divides b \implies c\divides d}
}_{\text{``máximo''}}.
$
\hfil\mistake}

\exercise.
A~\ref{a_gcd} tem um erro: o símbolo $\gcd a b$ não foi bem definido!
O que precisamos provar para definir realmente o símbolo $\gcd a b$?

\solution
Duas coisas:
\endgraf
\proofstyle{Existência:}
\emph{para todos inteiros $a$, $b$, existe inteiro $d$ que satisfaz as relações em cima.}
\endgraf
\proofstyle{Unicidade:}
\emph{se $d$, $d'$, são inteiros que satisfazem essas relações, então $d=d'$.}

\endexercise

\proposition.
Sejam $a,b\in\ints$.  Se $d,d'\in\ints$ são máximos divisóres comum
dos $a$ e $b$, então $d=\pm d'$.
\sketch.
Aplicamos a definição de m.d.c.~para cada um dos $d$ e $d'$,
para chegar em $d\divides d'$ e $d'\divides d$.
\qes
\proof.
Suponha que $d,d'$ são m.d.c.'s de $a$ e $b$.
Como $d$ é um m.d.c., todos os divisores em comum dos $a$ e $b$ o dividem.
Mas, como $d'$ é um divisor em comum, então $d'\divides d$.
Simetricamente concluimos que $d\divides d'$.
Logo $d = \pm d'$ (por~\ref{divides_is_almost_antisymmetric}).
\qed

\corollary.
Sejam $a,b\in\ints$.
Existe único $d\in\nats$ tal que $d$ é um m.d.c.~de $a$ e~$b$.

Agora podemos definir o símbolo $\gcd a b$:

\definition O máximo divisor comum.
\label{gcd}
\sidx[see]{máximo divisor comum}{mdc}
\tdefined{mdc}
Sejam $a,b\in\ints$.
$$
d = \dsym{\gcd a b}
\defiff
\underbrace{
d \divides a
\;\land\;
d \divides b
}_{\text{divisor comun}}
\;\land\;
\underbrace{
d\in\nats
\;\land\;
\lforall c {c\divides a \;\land\; c\divides b \implies c\divides d}
}_{\text{o máximo}}
\sdefined{\gcd {\holed a} {\holed b}}{o máximo divisor comum de \holed a e \holed b}
$$

\theorem.
\label{gcd_as_linear_combination}
\label{gcd_divides_any_linear_combination}
Sejam $a,b\in\ints$.
Então existe $d\in\nats$ que satisfaz a definição de $\gcd a b$,
ele pode ser escrito como \dterm{combinação linear}%
\tdefined{combinação linear}
dos $a$ e $b$, com coeficientes inteiros; ou seja,
$$
d = sa + tb,
\qquad
\text{para alguns $s,t\in\ints$}.
$$
Alem disso, o $\gcd a b$ divide qualque combinação linear dos $a$ e $b$.
\sketch.
Considere o conjunto $L$ de todas as combinações lineares.
Prove que existe $n_0\in\nats$ tal que $L = \set{ kn_0 \st k\in\ints }$.
Verifique que $\gcd a b = n_0$.
\qes

\exercise.
Verifique se a forma do $\gcd a b$ como combinação linear dos $a$ e $b$
é unicamente determinada.

\hint
Não é.  Mostre um contraexemplo.

\solution
Toma $3$ e $4$.  Temos $\gcd 4 3 = 1$, mas:
$$
\aligned
1 &= (-2)\ntimes 4 + 3\ntimes 3\\
1 &= \phantom{(-}4\phantom{)}\ntimes 4 - 5\ntimes 3.
\endaligned
$$

\endexercise

\proposition.
\label{gcd_of_comparable}
$a\divides b \implies \gcd a b = a$.
Especificamente, $\gcd a 0 = a$.
\sketch.
Precisamos apenas verificar as condições da definição de m.d.c., que seguem por
as propriedades de $\divides$ que já provamos.
\qes

\exercise.
\label{gcd_signs}
$
\gcd a b
=
\gcd a {-b}
=
\gcd {-a} {b}
=
\gcd b a
$.

\endexercise

\exercise.
\label{gcd_of_two_is_gcd_of_one_plus_sum}
Sejam $a,b\in\ints$.
Prove que
$$
\gcd a b = \gcd a {a+b}.
$$

\hint
Lembre a definição de m.d.c.\,.

\hint
Talvez as propriedades seguintes são úteis:
\beginul
\li para todos $x,y\in\nats$, $x\divides y \mland y\divides x \implies x = y$;
\li para todos $a,x,y\in\ints$, $a\divides x \mland a\divides y \implies a \divides {x+y}$.
\endul

\solution
\proofstyle{Idéia 1:}
Sejam $d = \gcd a b$ e $d' = \gcd a {a + b}$.
Pela definição, $d$ é divisor comum dos $a$ e $b$,
então $d\divides a $ e $d\divides b$, e logo $d \divides a + b$.
Temos então que $d$ é um divisor comum dos $a$ e $a + b$, e, pela definição de mdc,
como $d' = \gcd a {b+c}$, temos $d'\divides d$.
Similarmente, $d\divides d'$.
Então $|d| = |d'|$ e como ambós são naturais (parte da definição de $\gcd x y$), temos:
$$
\gcd a b = d = d' = \gcd a {a + b}.
$$
\endgraf
\proofstyle{Idéia 2:}
Seja $d = \gcd a b$.  Vamos mostrar que $d = \gcd a {a + b}$.
Pela definição, $d\geq0$ e é divisor comum dos $a$ e $b$,
então $d\divides a$ e $d\divides b$, e logo $d \divides a + b$.
Temos então que $d\geq0$ e é um divisor comum dos $a$ e $a + b$, e, pela definição de mdc,
falta so provar que cada divisor comum deles divide o $d$.
Seja $c\in\ints$ tal que $c\divides a$ e $c \divides {a+b}$.
Logo, $c\divides a - (a+b)=-b$.  Concluimos que $c\divides b$, então
$c$ é um divisor comum dos $a$ e $b$, então $c\divides d$ pela definição do $d$
como m.d.c.~dos $a$ e $b$.

\endexercise

\lemma Lema de Euclides.
\label{euclid_lemma}
\Euclid[lema]
Sejam $a,b\in\ints$ e $p$ primo.
Se $p \divides ab$, então $p\divides a$ ou $p\divides b$.
\sketch.
Suponha que $p\ndivides a$.  Logo o $\gcd a p = 1$ pode ser escrito como combinação linear de $a$ e $p$:
$$
1 = as + pt,    \qquad\text{para uns $s,t\in\ints$}.
$$
Multiplica os dois lados por $b$, e explica por que necessariamente $p\divides b$.
\qes
\proof.
Suponha que $p\ndivides a$.  Logo o $\gcd a p = 1$ pode ser escrito como combinação linear de $a$ e $p$,
ou seja, existem $s,t\in\ints$ tais que:
$$
\align
1 &= as + pt.
\intertext{Multiplicando os dois lados por $b$, temos:}
b &= asb + ptb.
\endalign
$$
Observe que como $p\divides ab$, segue que $p\divides asb$ (por~\ref{divides_properties}).
Obviamente $p\divides ptb$ também.
Logo, $p\divides asb + ptb = b$.
\qed

\theorem.
\label{coprime_with_a_part_of_a_product_must_divide_the_other_part_to_divide_the_product}
Se $\gcd d a = 1$ e $d \divides ab$, então $d \divides b$.
\sketch.
A prova é praticamente a mesma com aquela do~\ref{euclid_lemma}:
lá nos precisamos a primalidade do $p$ apenas para
concluir que $\gcd a p = 1$.
Aqui temos diretamente a hipótese $\gcd a d = 1$.
\qes
\proof.
Seja $a,b,d\in\ints$, tais que
$\gcd d a = 1$ e $d \divides ab$.
Como $\gcd a d = 1$, podemos o escrever como combinação linear dos $a$ e $d$:
$$
1 = sa + td,\qquad\text{para alguns $s,t\in\ints$}.
$$
Multiplicando por $b$, ganhamos
$$
b = sab + tdb,
$$
e argumentando como na prova do~\ref{euclid_lemma}
concluimos que $d \divides b$.
\qed

\corollary.
\label{product_of_coprimes_divides_common_multiple}
Se $a\divides m$, $b\divides m$, e $\gcd a b = 1$, então $ab\divides m$.
\proof.
Como $a\divides m$, temos $m = au$ para algum $u\in\ints$.
Mas $b\divides m=au$, e como $\gcd b a = 1$, temos $b\divides u$
(por~\ref{coprime_with_a_part_of_a_product_must_divide_the_other_part_to_divide_the_product}).
Então $bv = u$ para algum $v\in\ints$.
Substituindo, $m = au = a(bv) = (ab)v$, ou seja, $ab \divides m$.
\qed

\theorem Euclid.
\label{primes_is_infinite}
\Euclid[teorema]
Existe uma infinidade de primos.
\sketch.
Para qualquer conjunto finito de primos
$P = \set{p_1,\dotsc,p_n}$, considere o número
$p_1\dotsb p_n + 1$ e use-lo para achar um primo fora do $P$.
\qes
\proof.
Para qualquer conjunto finito de primos
$P = \set{p_1,\dotsc,p_n}$,
observe que o número $p=p_1\dotsb p_n + 1$ não é divisivel por nenhum dos $p_i$'s
(porque $p_i\divides p$ e $p_i\divides p_1\dotsb p_n$ implicam
$p\divides 1$, absurdo).
Então, como $p\geq 2$, ou o $p$ é primo e $p\not\in P$,
ou $p$ é divisivel por algum primo $q \not\in P$
(por~\ref{every_composite_number_is_divisible_by_a_prime}).
Nos dois casos, existe pelo menos um primo fora do $P$.
\qed

\endsection
%%}}}

%%{{{ The Euclidean algorithm 
\section O algoritmo de Euclides.
\label{sec:euclidean_algorithm}

\note Idéia.
Sejam $a,b$ inteiros positívos.
Como achamos o $\gcd a b$?
Nos vamos aplicar o lemma da divisão~(\refn{division_of_euclid}) repetetivamente,
até chegar em resto $0$:
$$
\matrix
\format
\r\;    &\;\c\;  & \; \c \;                   & \l      & \;\c\; & \c      & \qquad\qquad\l          \\
a       &   =    & b                          & q_0     &  +     & r_0,    & 0\leq r_0 < b           \\
b       &   =    & r_0                        & q_1     &  +     & r_1,    & 0\leq r_1 < r_0         \\
r_0     &   =    & r_1                        & q_2     &  +     & r_2,    & 0\leq r_2 < r_1         \\
r_1     &   =    & r_2                        & q_3     &  +     & r_3,    & 0\leq r_3 < r_2         \\
        & \vdots &                            &         &        &         & \hfil\vdots\hfil        \\
r_{n-3} &   =    & r_{n-2}                    & q_{n-1} &  +     & r_{n-1},& 0\leq r_{n-1} < r_{n-2} \\
r_{n-2} &   =    & \boxed{\mathstrut r_{n-1}} & q_n     &  +     & \underbrace{r_n}_0,      & 0 = r_n < r_{n-1}.      
\endmatrix
$$
O $\gcd a b$ estará na posição marcada em cima.
Vamos agora descrever o algoritmo formalmente, e provar
(informalmente e formalmente) sua corretude!

\algorithm Euclides.
\Euclid[algoritmo]
\tdefined{algoritmo}[de Euclides]
\label{euclidean_algorithm}
\endgraf
\noindent%
{\def\Euclid{\algorithmstyle{Euclid}}%
\centerline{$\Euclid(a,b)$}
{\hrule width \hsize height 1pt\relax}
\vskip4pt
\algospec
 INPUT: $a,b\in\nats$
OUTPUT: $\gcd a b$
\endspec
\beginol
\li Se $b=0$, retorna $a$.
\li Retorna $\Euclid(b,r)$, onde $r = a \bmod b$.
\endol
{\hrule width \hsize height 1pt\relax}
}

\example.
\label{euclidean_algorithm_example}
Ache o $\gcd {101} {73}$ com o algoritmo de Euclides.

\solution
Sabendo que os dois números são primos, fica imediato que eles são coprimos entre si também:
a reposta é 1.

Aplicando o algoritmo de Euclides, para achar o $\gcd {101} {73}$, dividimos o $101$ por $73$:
$$
\alignat 2
101 &= 73 \ntimes \underbrace{\phantom 1}_{\text{quociente}} + \underbrace{\phantom{28}}_{\text{resto}},      &\qquad&0 \leq \underbrace{\phantom{28}}_{\text{resto}} < 73
\intertext{e sabemos que assim reduziremos o problema para o alvo de achar o $\gcd {73} {\text{resto}}$.  Pensando, achamos os valores:}
101 &= 73 \ntimes \underbrace{1}_{\text{quociente}} + \underbrace{28}_{\text{resto}},      &\quad&0 \leq \underbrace{28}_{\text{resto}} < 73 
\intertext{ou seja, $\gcd {101} {73} = \gcd {73} {28}$.  Então, repetimos:}
73 &= 28 \ntimes \underbrace{{2}}_{\text{quociente}} + \underbrace{{17}}_{\text{resto}},      &&0 \leq \underbrace{17}_{\text{resto}} < 28
\intertext{ou seja, $\gcd {73} {28} = \gcd {28} {17}$.  Repetimos:}
28 &= 17 \ntimes \underbrace{1}_{\text{quociente}} + \underbrace{11}_{\text{resto}},      &&0 \leq \underbrace{11}_{\text{resto}} < 17
\intertext{ou seja, $\gcd {28} {17} = \gcd {17} {11}$.  Repetimos:}
17 &= 11 \ntimes \underbrace{1}_{\text{quociente}} + \underbrace{6}_{\text{resto}},      &&0 \leq \underbrace{6}_{\text{resto}} < 11
\intertext{ou seja, $\gcd {17} {11} = \gcd {11} 6$.  Repetimos:}
11 &= 6 \ntimes \underbrace{1}_{\text{quociente}} + \underbrace{5}_{\text{resto}},      &&0 \leq \underbrace{5}_{\text{resto}} < 6
\intertext{ou seja, $\gcd {11} 6 = \gcd 6 5$.  Repetimos:}
6 &= 5 \ntimes \underbrace{1}_{\text{quociente}} + \underbrace{1}_{\text{resto}},      &&0 \leq \underbrace{1}_{\text{resto}} < 5
\intertext{ou seja, $\gcd 6 5 = \gcd 5 1$.  Como $\gcd 5 1 = 1$, nem precisamos repetir, mas vamos mesmo assim:}
5 &= \boxed 1 \ntimes \underbrace{5}_{\text{quociente}} + \underbrace{0}_{\text{resto}}.      &&
\endalignat
$$

Mais compactamente, os passos são:
$$
\matrix
\format
\r  & \c    & \c       & \l        & \l & \c    & \l  & \c     & \c & \c       & \c & \c    & \c & \c     & \r            & \c    & \l          \\
101 & {}={} & 73       & {}\ntimes{} & 1  & {}+{} & 28, & \qquad & 0  & {}\leq{} & 28 & {}<{} & 73 & \qquad & \gcd{101}{73} & {}={} & \gcd{73}{28}\\
73  & {}={} & 28       & {}\ntimes{} & 2  & {}+{} & 17, &        & 0  & {}\leq{} & 17 & {}<{} & 28 &        & \gcd{73 }{28} & {}={} & \gcd{28}{17}\\
28  & {}={} & 17       & {}\ntimes{} & 1  & {}+{} & 11, &        & 0  & {}\leq{} & 11 & {}<{} & 17 &        & \gcd{28 }{17} & {}={} & \gcd{17}{11}\\
17  & {}={} & 11       & {}\ntimes{} & 1  & {}+{} & 6,  &        & 0  & {}\leq{} & 6  & {}<{} & 11 &        & \gcd{17 }{11} & {}={} & \gcd{11}{6 }\\
11  & {}={} & 6        & {}\ntimes{} & 1  & {}+{} & 5,  &        & 0  & {}\leq{} & 5  & {}<{} & 6  &        & \gcd{11 }{6 } & {}={} & \gcd{6 }{5 }\\
6   & {}={} & 5        & {}\ntimes{} & 1  & {}+{} & 1,  &        & 0  & {}\leq{} & 1  & {}<{} & 5  &        & \gcd{6  }{5 } & {}={} & \gcd{5 }{1 }\\
5   & {}={} & \boxed 1 & {}\ntimes{} & 5  & {}+{} & 0   &        &    &          &    &       &    &        & \gcd{5  }{1 } & {}={} & \gcd{1 }{0 } = \boxed 1.
\endmatrix
$$
\moveqedup
\endexample

\remark.
\def\Euclid{\algorithmstyle{Euclid}}%
Podemos utilizar o algoritmo de Euclides para achar o $\gcd a b$
onde $a,b\in\ints$ também,
graças o~\ref{gcd_signs}:
$(a,b) = (\abs a, \abs b) = \Euclid(\abs a, \abs b)$.

\exercise.
Usando o algoritmo de Euclides, ache os:
(i) $\gcd {108} {174}$; 
(ii) $\gcd {2016} {305}$.

\solution
(i) Para o $\gcd {108} {174} = \gcd {174} {108}$ calculamos:
$$
\matrix
\format
\r  & \c    & \c       & \l        & \l & \c    & \l    & \c     & \c & \c       & \c & \c    & \c & \c     & \r             & \c    & \l            \\
174 & {}={} & 108      & {}\ntimes{} & 1  & {}+{} &{66},  & \qquad & 0  & {}\leq{} & 66 & {}<{} & 108& \qquad & \gcd{174}{108} & {}={} & \gcd{108}{66 }\\
108 & {}={} & 66       & {}\ntimes{} & 1  & {}+{} &{42},  &        & 0  & {}\leq{} & 42 & {}<{} & 66 &        &                & {}={} & \gcd{66 }{42 }\\
66  & {}={} & 42       & {}\ntimes{} & 1  & {}+{} &{24},  &        & 0  & {}\leq{} & 24 & {}<{} & 42 &        &                & {}={} & \gcd{42 }{24 }\\
42  & {}={} & 24       & {}\ntimes{} & 1  & {}+{} &{18},  &        & 0  & {}\leq{} & 18 & {}<{} & 24 &        &                & {}={} & \gcd{24 }{18 }\\
24  & {}={} & 18       & {}\ntimes{} & 1  & {}+{} &{6 },  &        & 0  & {}\leq{} & 6  & {}<{} & 18 &        &                & {}={} & \gcd{18 }{6  }\\
18  & {}={} & \boxed 6 & {}\ntimes{} & 3  & {}+{} &{0 }   &        &    &          &    &       &    &        &                & {}={} & \gcd{6  }{0  } = \boxed 6.
\endmatrix
$$
\endgraf
\noindent
(ii) Calculamos:
$$
\matrix
\format
\r  & \c    & \c       & \l        & \l & \c    & \l     & \c     & \c & \c       & \c & \c    & \c & \c     & \r              & \c    & \l            \\
2016& {}={} & 305      & {}\ntimes{} & 6  & {}+{} &{186},  & \qquad & 0  & {}\leq{} &186 & {}<{} &305 & \qquad & \gcd{2016}{305} & {}={} & \gcd{305}{186}\\
305 & {}={} & 186      & {}\ntimes{} & 1  & {}+{} &{119},  &        & 0  & {}\leq{} &119 & {}<{} &186 &        &                 & {}={} & \gcd{186}{119}\\
186 & {}={} & 119      & {}\ntimes{} & 1  & {}+{} &{67 },  &        & 0  & {}\leq{} &67  & {}<{} &119 &        &                 & {}={} & \gcd{119}{67 }\\
119 & {}={} & 67       & {}\ntimes{} & 1  & {}+{} &{52 },  &        & 0  & {}\leq{} &52  & {}<{} &67  &        &                 & {}={} & \gcd{67 }{52 }\\
67  & {}={} & 52       & {}\ntimes{} & 1  & {}+{} &{15 },  &        & 0  & {}\leq{} &15  & {}<{} &52  &        &                 & {}={} & \gcd{52 }{15 }\\
52  & {}={} & 15       & {}\ntimes{} & 3  & {}+{} &{7  },  &        & 0  & {}\leq{} &7   & {}<{} &15  &        &                 & {}={} & \gcd{15 }{7  }\\
15  & {}={} & 7        & {}\ntimes{} & 2  & {}+{} &{1  },  &        & 0  & {}\leq{} &1   & {}<{} &7   &        &                 & {}={} & \gcd{7  }{1  }\\
7   & {}={} & \boxed 1 & {}\ntimes{} & 7  & {}+{} &{0  }   &        &    &          &    &       &    &        &                 & {}={} & \gcd{1  }{0  } = \boxed 1.
\endmatrix
$$
%$$
%\matrix
%\format
%\r  & \c    & \c       & \l        & \l & \c    & \l     & \c     & \c & \c       & \c & \c    & \c & \c     & \r              & \c    & \l            \\
%    & {}={} &          & {}\ntimes{} &    & {}+{} &{   },  & \qquad & 0  & {}\leq{} &    & {}<{} &    & \qquad & \gcd{    }{   } & {}={} & \gcd{   }{   }\\
%    & {}={} &          & {}\ntimes{} &    & {}+{} &{   },  &        & 0  & {}\leq{} &    & {}<{} &    &        &                 & {}={} & \gcd{   }{   }\\
%    & {}={} & \boxed 1 & {}\ntimes{} &    & {}+{} &{   }   &        &    &          &    &       &    &        &                 & {}={} & \gcd{   }{   } = .
%\endmatrix
%$$

\endexercise

\codeit.
\label{implement_euclidean_algorithm}
Implemente o algoritmo de Euclides e verifique tuas soluções nos exercísios anteriores.
\endcodeit

\codeit.
\label{implement_verbose_euclidean_algorithm}
Implemente um modo ``verbose'' no teu programa
do~\ref{implement_euclidean_algorithm},
onde ele mostra todas as equações e desigualdades, e não apenas o resultado final.
\endcodeit

\lemma Euclides.
\label{euclid_gcd_lemma}
Se $a,b\in\ints$ com $b > 0$, então $\gcd a b = \gcd b r$,
onde $r$ o resto da divisão de $a$ por $b$.
\wrongproof.
Dividindo o $a$ por $b$, temos $a = bq + r$.
Vamos mostrar que qualquer inteiro $d$ satisfaz a equivalência:
$$
\align
d \divides a
\mland
d \divides b
&\iff
d \divides b
\mland
d \divides r.\\
\intertext{Realmente, usando as propriedades~\refn{divides_properties}, temos:}
d \divides a
\mland
d \divides b
&\implies
d\divides \overbrace{a - bq}^{\dsize r}\\
d\divides \underbrace{bq + r}_{\dsize a}
&\impliedby
d \divides b
\mland
d \divides r.
\endalign
$$
Isso mostra que os divisores em comum dos $a$ e $b$, e dos $b$ e $r$ são os mesmos,
ou, formalmente:
$$
\set{c\in\ints\st c\divides a \mland c\divides b}
=
\set{c\in\ints\st c\divides b \mland c\divides r}.
$$
Logo,
$$
\alignat 2
\gcd a b
&= \max\set{c\in\ints\st c\divides a \mland c\divides b}    \qqby{def.~$\gcd a b$}\\
&= \max\set{c\in\ints\st c\divides b \mland c\divides r}    \qqby{provado em cima}\\
&= \gcd b r                                                 \qqby{def.~$\gcd b r$}
\endalignat
$$
que mostra a corretude do algoritmo.
\mistaqed

\exercise.
Qual é o problema com a prova do~\ref{euclid_gcd_lemma}?

\solution
A definição do maior divisor comum $(a,b)$ não foi ``o maior divisor comum dos $a$ e $b$''.
Lembre-se~\ref{gcd}.  Veja também o~\ref{gcd_alternative_definition}.

\endexercise

\theorem Algorítmo de Euclides.
\label{euclidean_algorithm_correctness}
O~\ref{euclidean_algorithm} é correto.
\proof.
Precisamos provar duas coisas: \emph{terminação\/}\/ e \emph{corretude}.
\endgraf
\proofstyle{Corretude.}
Se o algoritmo precisou $n$ passos, temos que verificar:
Temos
$$
\gcd a b
= \gcd b {r_0}
= \gcd {r_0} {r_1}
= \gcd {r_1} {r_2}
= \dotsb
= \gcd {r_{n-1}} {r_n}
= \gcd {r_n} 0
= r_n.
$$
Todas as igualdades exceto a última seguem por causa do~\ref{euclid_gcd_lemma};
a última por causa da~\ref{gcd_of_comparable}.
\endgraf
\proofstyle{Terminação.}
Note que a seqüência de restos $r_0, r_1, \ldots$ é estritamente
decrescente, e todos os seus termos são não negativos:
$$
0\leq \dotsb < r_2 < r_1 < r_0 < b.
$$
Logo, essa seqüência não pode ser infinita.
Realmente, o tamanho dela não pode ser maior que $b$,
então depois de no máximo $b$ passos, o algorítmo terminará.
\qed

\exercise.
\label{euclidean_algorithm_proof_why_informal}
Nenhuma das duas partes da prova do~\ref{euclidean_algorithm_correctness}
é completamente formal.  Explique porque.
(Veja também os~\refs{euclidean_algorithm_correctness_formal_proof_by_induction}--\refn{euclidean_algorithm_correctness_formal_proof_by_wop}.)

\hint ${}\dotsb{}$

\hint ${}\dotsb{}$

\solution
São os ``${}\dotsb{}$'' mesmo!

\endexercise

\note Passos do algoritmo de Euclides.
Como o exercísio seguinte mostra, o algoritmo de Euclides
é bem mais eficiênte do que nos mostramos em cima:
depois dois passos, as duas entradas, nos piores dos casos,
são reduzidas para metade.

\exercise.
Se $a \geq b$, então $r < a/2$, onde $r$ o resto da divisão de $a$ por $b$.

\hint Separe os casos: ou $b > a/2$ ou $b \leq a/2$.

\hint Qual seria o resto em cado caso?

\hint Num caso, dá para achar exatamente o resto.
No outro, use a restrição que o resto satisfaz.

\solution
\casestyle{Caso $b > a/2$:}
Então $r = a-b < a/2$.
\casestyle{Caso $b < a/2$:}
Então $r < b < a/2$.

\endexercise

\endsection
%%}}}

%%{{{ The extended Euclidean algorithm 
\section O algoritmo extendido de Euclides.

\note.
Nos já provamos que o m.d.c.~$\gcd a b$ de dois inteiros $a$ e $b$
pode ser escrito como uma combinação linear deles, mas como podemos
realmente \emph{achar}\/ inteiros $s,t\in\ints$ que satisfazem a
$$
\gcd a b = as + bt,     \qquad s,t\in\ints?
$$
Supresamente a resposta já está ``escondida'' no mesmo algoritmo de Euclides!

\algorithm Algoritmo extendido de Euclides.
\label{extended_euclidean_algorithm}
\Euclid[algoritmo extendido]
\tdefined{algoritmo}[extendido de Euclides]
\algospec
 INPUT: $a,b\in\ints$, $b>0$
OUTPUT: $s,t\in\ints$ tais que $\gcd a b = as + bt$.
\endspec

\example.
Escreva o $\gcd {101} {73}$ como combinação linear dos $101$ e $73$.

\solution
Primeiramente, precisamos aplicar o algoritmo de Euclides para achar o m.d.c.,
como no~\ref{euclidean_algorithm_example},
mas vamos também resolver cada equação por o seu resto:
$$
\matrix
\format
\r  & \c    & \c       & \l          & \l & \c    & \l & \c           & \r & \c    & \c & \c    &\c & \c         & \c  \\
101 & {}={} & 73       & {}\ntimes{} & 1  & {}+{} & 28 & \qquad\qquad &28  & {}={} &101 & {}-{} &   &{}       {} & 73 \\
73  & {}={} & 28       & {}\ntimes{} & 2  & {}+{} & 17 &              &17  & {}={} &73  & {}-{} & 2 &{}\ntimes{} & 28 \\
28  & {}={} & 17       & {}\ntimes{} & 1  & {}+{} & 11 &              &11  & {}={} &28  & {}-{} &   &{}       {} & 17 \\
17  & {}={} & 11       & {}\ntimes{} & 1  & {}+{} & 6  &              &6   & {}={} &17  & {}-{} &   &{}       {} & 11 \\
11  & {}={} & 6        & {}\ntimes{} & 1  & {}+{} & 5  &              &5   & {}={} &11  & {}-{} &   &{}       {} & 6  \\
6   & {}={} & 5        & {}\ntimes{} & 1  & {}+{} & 1  &              &1   & {}={} &6   & {}-{} &   &{}       {} & 5  \\
5   & {}={} & \boxed 1 & {}\ntimes{} & 5  & {}+{} & 0. &              &    &       &    &       &    &          &     \\
\endmatrix
$$
Utilizando as equações no lado direto, de baixo para cima, calculamos:
$$
\def\hl#1{\underline{#1}}
\alignat 2
1 &= \hl6 - \hl5                                           &\quad&\text{(6 e 5)   }\\
  &= \hl6 - (\hl{11} - \hl6)
   = \hl6 - \hl{11} + \hl6
   = -\hl{11} + 2\ntimes \hl6                                   &&\text{(11 e 6)  }\\
  &= -\hl{11} + 2\ntimes (\hl{17} - \hl{11})
   = -\hl{11} + 2\ntimes \hl{17} - 2\ntimes \hl{11}
   = 2\ntimes \hl{17} - 3\ntimes \hl{11}                        &&\text{(17 e 11) }\\
  &= 2\ntimes \hl{17} - 3\ntimes (\hl{28} - \hl{17})
   = 2\ntimes \hl{17} - 3\ntimes \hl{28} + 3\ntimes 17
   = -3\ntimes \hl{28} + 5\ntimes \hl{17}                       &&\text{(28 e 17) }\\
  &= -3\ntimes \hl{28} + 5\ntimes (\hl{73} - 2\ntimes \hl{28})
   = -3\ntimes \hl{28} + 5\ntimes \hl{73} - 10\ntimes \hl{28}
   = 5\ntimes \hl{73} -13\ntimes \hl{28}                        &&\text{(73 e 28) }\\
  &= 5\ntimes \hl{73} -13\ntimes (\hl{101} - \hl{73})
   = 5\ntimes \hl{73} -13\ntimes \hl{101} + 13\ntimes \hl{73}
   = -13\ntimes \hl{101} + 18\ntimes \hl{73}                    &&\text{(101 e 73)}
\endalignat
$$
No lado direto mostramos nosso progresso, no sentido de ter conseguido
escrever o m.d.c.~como combinação linear de quais dois números.
Sublinhamos os inteiros que nos interessam para não perder nosso foco.
Em cada nova linha, escolhemos o menor dos dois números sublinhados,
e o substituimos por a combinação linear que temos graças o algoritmo de Euclides.
Obviamente, essa notação e metodologia não tem nenhum sentido matematicamente
falando.  Serve apenas para ajudar nossos olhos humanos.
\endgraf
Achamos então $s,t\in\ints$ que satisfazem a equação $1 = sa + tb$:
são os $s = -13$ e $t = 18$.
\endexample

\exercise.
Usando o algoritmo extendido de Euclides, escreve:
(i) o $\gcd {108} {174}$ como combinação linear dos 108 e 174; 
(ii) o $\gcd {2016} {305}$ como combinação linear dos 2016 e 305.

\endexercise

\endsection
%%}}}

%%{{{ The sieve of Eratosthenes 
\section O crivo de Eratostenes.
\label{sec:sieve_of_eratosthenes}

\question.
Como podemos achar todos os primos até um dado limitante $b\in\nats$?

\Eratosthenes[crivo]%
\noindent
Eratostenes (276--194 a.C.)~conseguiu responder com sua metodo conhecida como
o ``crivo de Eratostenes''.
Antes de descrever o seu algoritmo formalmente, vamos aplicar sua idéia
para achar todos os primos menores ou iguais que $b=128$.

{%
\def\co#1{\phantom{#1}}%
\def\ci#1{\underline{#1}}%
Primeiramente liste todos os numeros de $2$ até $b=128$:
$$
\matrix
\format
~\r  &~\r  &~\r   &~\r   &~\r   &~\r   &~\r   &~\r   &~\r   &~\r   &~\r   &~\r   &~\r   &~\r   &~\r   &~\r   \\
   {   }&   {  2}&   {   3}&   {   4}&   {   5}&   {   6}&   {   7}&   {   8}&   {   9}&   {  10}&   {  11}&   {  12}&   {  13}&   {  14}&   {  15}&   {  16}\\
   { 17}&   { 18}&   {  19}&   {  20}&   {  21}&   {  22}&   {  23}&   {  24}&   {  25}&   {  26}&   {  27}&   {  28}&   {  29}&   {  30}&   {  31}&   {  32}\\
   { 33}&   { 34}&   {  35}&   {  36}&   {  37}&   {  38}&   {  39}&   {  40}&   {  41}&   {  42}&   {  43}&   {  44}&   {  45}&   {  46}&   {  47}&   {  48}\\
   { 49}&   { 50}&   {  51}&   {  52}&   {  53}&   {  54}&   {  55}&   {  56}&   {  57}&   {  58}&   {  59}&   {  60}&   {  61}&   {  62}&   {  63}&   {  64}\\
   { 65}&   { 66}&   {  67}&   {  68}&   {  69}&   {  70}&   {  71}&   {  72}&   {  73}&   {  74}&   {  75}&   {  76}&   {  77}&   {  78}&   {  79}&   {  80}\\
   { 81}&   { 82}&   {  83}&   {  84}&   {  85}&   {  86}&   {  87}&   {  88}&   {  89}&   {  90}&   {  91}&   {  92}&   {  93}&   {  94}&   {  95}&   {  96}\\
   { 97}&   { 98}&   {  99}&   { 100}&   { 101}&   { 102}&   { 103}&   { 104}&   { 105}&   { 106}&   { 107}&   { 108}&   { 109}&   { 110}&   { 111}&   { 112}\\
   {113}&   {114}&   { 115}&   { 116}&   { 117}&   { 118}&   { 119}&   { 120}&   { 121}&   { 122}&   { 123}&   { 124}&   { 125}&   { 126}&   { 127}&   { 128.}
\endmatrix
$$
Agora começa com o primeiro número na lista, o $2$, e apaga todos os maiores múltiplos dele:
$$
\matrix
\format
~\r &~\r &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r   \\
   {   }&   {  2}&   {   3}&\co{   4}&   {   5}&\co{   6}&   {   7}&\co{   8}&   {   9}&\co{  10}&   {  11}&\co{  12}&   {  13}&\co{  14}&   {  15}&\co{  16}\\
   { 17}&\co{ 18}&   {  19}&\co{  20}&   {  21}&\co{  22}&   {  23}&\co{  24}&   {  25}&\co{  26}&   {  27}&\co{  28}&   {  29}&\co{  30}&   {  31}&\co{  32}\\
   { 33}&\co{ 34}&   {  35}&\co{  36}&   {  37}&\co{  38}&   {  39}&\co{  40}&   {  41}&\co{  42}&   {  43}&\co{  44}&   {  45}&\co{  46}&   {  47}&\co{  48}\\
   { 49}&\co{ 50}&   {  51}&\co{  52}&   {  53}&\co{  54}&   {  55}&\co{  56}&   {  57}&\co{  58}&   {  59}&\co{  60}&   {  61}&\co{  62}&   {  63}&\co{  64}\\
   { 65}&\co{ 66}&   {  67}&\co{  68}&   {  69}&\co{  70}&   {  71}&\co{  72}&   {  73}&\co{  74}&   {  75}&\co{  76}&   {  77}&\co{  78}&   {  79}&\co{  80}\\
   { 81}&\co{ 82}&   {  83}&\co{  84}&   {  85}&\co{  86}&   {  87}&\co{  88}&   {  89}&\co{  90}&   {  91}&\co{  92}&   {  93}&\co{  94}&   {  95}&\co{  96}\\
   { 97}&\co{ 98}&   {  99}&\co{ 100}&   { 101}&\co{ 102}&   { 103}&\co{ 104}&   { 105}&\co{ 106}&   { 107}&\co{ 108}&   { 109}&\co{ 110}&   { 111}&\co{ 112}\\
   {113}&\co{114}&   { 115}&\co{ 116}&   { 117}&\co{ 118}&   { 119}&\co{ 120}&   { 121}&\co{ 122}&   { 123}&\co{ 124}&   { 125}&\co{ 126}&   { 127}&\co{ 128}
\endmatrix
$$
Toma o próximo número que está ainda na lista, o $3$, e faça a mesma coisa:
$$
\matrix
\format
~\r &~\r &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r   \\
   {   }&   {  2}&   {   3}&\co{   4}&   {   5}&\co{   6}&   {   7}&\co{   8}&\co{   9}&\co{  10}&   {  11}&\co{  12}&   {  13}&\co{  14}&\co{  15}&\co{  16}\\
   { 17}&\co{ 18}&   {  19}&\co{  20}&\co{  21}&\co{  22}&   {  23}&\co{  24}&   {  25}&\co{  26}&\co{  27}&\co{  28}&   {  29}&\co{  30}&   {  31}&\co{  32}\\
\co{ 33}&\co{ 34}&   {  35}&\co{  36}&   {  37}&\co{  38}&\co{  39}&\co{  40}&   {  41}&\co{  42}&   {  43}&\co{  44}&\co{  45}&\co{  46}&   {  47}&\co{  48}\\
   { 49}&\co{ 50}&\co{  51}&\co{  52}&   {  53}&\co{  54}&   {  55}&\co{  56}&\co{  57}&\co{  58}&   {  59}&\co{  60}&   {  61}&\co{  62}&\co{  63}&\co{  64}\\
   { 65}&\co{ 66}&   {  67}&\co{  68}&\co{  69}&\co{  70}&   {  71}&\co{  72}&   {  73}&\co{  74}&\co{  75}&\co{  76}&   {  77}&\co{  78}&   {  79}&\co{  80}\\
\co{ 81}&\co{ 82}&   {  83}&\co{  84}&   {  85}&\co{  86}&\co{  87}&\co{  88}&   {  89}&\co{  90}&   {  91}&\co{  92}&\co{  93}&\co{  94}&   {  95}&\co{  96}\\
   { 97}&\co{ 98}&\co{  99}&\co{ 100}&   { 101}&\co{ 102}&   { 103}&\co{ 104}&\co{ 105}&\co{ 106}&   { 107}&\co{ 108}&   { 109}&\co{ 110}&\co{ 111}&\co{ 112}\\
   {113}&\co{114}&   { 115}&\co{ 116}&\co{ 117}&\co{ 118}&   { 119}&\co{ 120}&   { 121}&\co{ 122}&\co{ 123}&\co{ 124}&   { 125}&\co{ 126}&   { 127}&\co{ 128}
\endmatrix
$$
Repeta o processo (o próximo agora seria o $5$) até não tem mais números para tomar.
Os números que ficarão são todos os primos até o $128$:
$$
\matrix
\format
~\r &~\r &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r   \\
   {   }&   {  2}&   {   3}&\co{   4}&   {   5}&\co{   6}&   {   7}&\co{   8}&\co{   9}&\co{  10}&   {  11}&\co{  12}&   {  13}&\co{  14}&\co{  15}&\co{  16}\\
   { 17}&\co{ 18}&   {  19}&\co{  20}&\co{  21}&\co{  22}&   {  23}&\co{  24}&\co{  25}&\co{  26}&\co{  27}&\co{  28}&   {  29}&\co{  30}&   {  31}&\co{  32}\\
\co{ 33}&\co{ 34}&\co{  35}&\co{  36}&   {  37}&\co{  38}&\co{  39}&\co{  40}&   {  41}&\co{  42}&   {  43}&\co{  44}&\co{  45}&\co{  46}&   {  47}&\co{  48}\\
   { 49}&\co{ 50}&\co{  51}&\co{  52}&   {  53}&\co{  54}&\co{  55}&\co{  56}&\co{  57}&\co{  58}&   {  59}&\co{  60}&   {  61}&\co{  62}&\co{  63}&\co{  64}\\
\co{ 65}&\co{ 66}&   {  67}&\co{  68}&\co{  69}&\co{  70}&   {  71}&\co{  72}&   {  73}&\co{  74}&\co{  75}&\co{  76}&   {  77}&\co{  78}&   {  79}&\co{  80}\\
\co{ 81}&\co{ 82}&   {  83}&\co{  84}&\co{  85}&\co{  86}&\co{  87}&\co{  88}&   {  89}&\co{  90}&   {  91}&\co{  92}&\co{  93}&\co{  94}&\co{  95}&\co{  96}\\
   { 97}&\co{ 98}&\co{  99}&\co{ 100}&   { 101}&\co{ 102}&   { 103}&\co{ 104}&\co{ 105}&\co{ 106}&   { 107}&\co{ 108}&   { 109}&\co{ 110}&\co{ 111}&\co{ 112}\\
   {113}&\co{114}&\co{ 115}&\co{ 116}&\co{ 117}&\co{ 118}&   { 119}&\co{ 120}&   { 121}&\co{ 122}&\co{ 123}&\co{ 124}&\co{ 125}&\co{ 126}&   { 127}&\co{ 128}
\endmatrix
$$
Tomando o $7$:
$$
\matrix
\format
~\r &~\r &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r   \\
   {   }&   {  2}&   {   3}&\co{   4}&   {   5}&\co{   6}&   {   7}&\co{   8}&\co{   9}&\co{  10}&   {  11}&\co{  12}&   {  13}&\co{  14}&\co{  15}&\co{  16}\\
   { 17}&\co{ 18}&   {  19}&\co{  20}&\co{  21}&\co{  22}&   {  23}&\co{  24}&\co{  25}&\co{  26}&\co{  27}&\co{  28}&   {  29}&\co{  30}&   {  31}&\co{  32}\\
\co{ 33}&\co{ 34}&\co{  35}&\co{  36}&   {  37}&\co{  38}&\co{  39}&\co{  40}&   {  41}&\co{  42}&   {  43}&\co{  44}&\co{  45}&\co{  46}&   {  47}&\co{  48}\\
\co{ 49}&\co{ 50}&\co{  51}&\co{  52}&   {  53}&\co{  54}&\co{  55}&\co{  56}&\co{  57}&\co{  58}&   {  59}&\co{  60}&   {  61}&\co{  62}&\co{  63}&\co{  64}\\
\co{ 65}&\co{ 66}&   {  67}&\co{  68}&\co{  69}&\co{  70}&   {  71}&\co{  72}&   {  73}&\co{  74}&\co{  75}&\co{  76}&\co{  77}&\co{  78}&   {  79}&\co{  80}\\
\co{ 81}&\co{ 82}&   {  83}&\co{  84}&\co{  85}&\co{  86}&\co{  87}&\co{  88}&   {  89}&\co{  90}&\co{  91}&\co{  92}&\co{  93}&\co{  94}&\co{  95}&\co{  96}\\
   { 97}&\co{ 98}&\co{  99}&\co{ 100}&   { 101}&\co{ 102}&   { 103}&\co{ 104}&\co{ 105}&\co{ 106}&   { 107}&\co{ 108}&   { 109}&\co{ 110}&\co{ 111}&\co{ 112}\\
   {113}&\co{114}&\co{ 115}&\co{ 116}&\co{ 117}&\co{ 118}&\co{ 119}&\co{ 120}&   { 121}&\co{ 122}&\co{ 123}&\co{ 124}&\co{ 125}&\co{ 126}&   { 127}&\co{ 128}
\endmatrix
$$
Tomando o $11$:
$$
\matrix
\format
~\r &~\r &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r  &~\r   \\
   {   }&   {  2}&   {   3}&\co{   4}&   {   5}&\co{   6}&   {   7}&\co{   8}&\co{   9}&\co{  10}&   {  11}&\co{  12}&   {  13}&\co{  14}&\co{  15}&\co{  16}\\
   { 17}&\co{ 18}&   {  19}&\co{  20}&\co{  21}&\co{  22}&   {  23}&\co{  24}&\co{  25}&\co{  26}&\co{  27}&\co{  28}&   {  29}&\co{  30}&   {  31}&\co{  32}\\
\co{ 33}&\co{ 34}&\co{  35}&\co{  36}&   {  37}&\co{  38}&\co{  39}&\co{  40}&   {  41}&\co{  42}&   {  43}&\co{  44}&\co{  45}&\co{  46}&   {  47}&\co{  48}\\
\co{ 49}&\co{ 50}&\co{  51}&\co{  52}&   {  53}&\co{  54}&\co{  55}&\co{  56}&\co{  57}&\co{  58}&   {  59}&\co{  60}&   {  61}&\co{  62}&\co{  63}&\co{  64}\\
\co{ 65}&\co{ 66}&   {  67}&\co{  68}&\co{  69}&\co{  70}&   {  71}&\co{  72}&   {  73}&\co{  74}&\co{  75}&\co{  76}&\co{  77}&\co{  78}&   {  79}&\co{  80}\\
\co{ 81}&\co{ 82}&   {  83}&\co{  84}&\co{  85}&\co{  86}&\co{  87}&\co{  88}&   {  89}&\co{  90}&\co{  91}&\co{  92}&\co{  93}&\co{  94}&\co{  95}&\co{  96}\\
   { 97}&\co{ 98}&\co{  99}&\co{ 100}&   { 101}&\co{ 102}&   { 103}&\co{ 104}&\co{ 105}&\co{ 106}&   { 107}&\co{ 108}&   { 109}&\co{ 110}&\co{ 111}&\co{ 112}\\
   {113}&\co{114}&\co{ 115}&\co{ 116}&\co{ 117}&\co{ 118}&\co{ 119}&\co{ 120}&\co{ 121}&\co{ 122}&\co{ 123}&\co{ 124}&\co{ 125}&\co{ 126}&   { 127}&\co{ 128}
\endmatrix
$$
E podemos já parar aqui, certos que os números que ainda ficam na lista, são todos os primos desejados.
}

\exercise.
Por que?

\endexercise

\exercise.
\label{eratosthenian_algorithm}
Escreva formalmente o algoritmo do Eratostenes.

\endexercise

\codeit.
\label{implement_eratosthenian_algorithm}
Implemente o algoritmo de Eratostenes e use-lo para achar todos os primos até o $1024$.
\endcodeit

\endsection
%%}}}

%%{{{ The fundamental theorem of arithmetic 
\section O teorema fundamental da aritmética.

\theorem fundamental da aritmética (Euclides, Gauss).
\ii{teorema}[fundamental da aritmética]
\Gauss
\Euclid
\label{fundamental_theorem_of_arithmetic}
Todo $n\in\nats$ com $n > 1$, pode ser escrito como um produtório de primos.
Essa expressão é única se desconsiderar a ordem dos fatores do produtório.
\proof.
Seja $n\in\nats$ com $n > 1$.
\endgraf
\proofstyle{Existência:}
\ii{indução}[forte]
Usamos indução forte (veja~\refn{sec:strong_induction}).
Caso que $n$ seja primo, trivialmente ele mesmo é o produtório de primos (produtório de tamanho 1).
Caso contrário, $n = ab$, para uns $a,b\in\nats$ com $1<a<n$ e $1<b<n$,
logo podemos assumir (hipoteses indutivas) que cada um deles pode ser
escrito na forma desejada:
$$
\alignat 2
a &= p_1p_2\dotsb p_{k_a},          &\quad& \text{para alguns $p_i$'s primos;}\\
b &= q_1q_2\dotsb q_{k_b},          &\quad& \text{para alguns $q_j$'s primos.}
\endalignat
$$
Então temos
$$
n = ab = (p_1p_2\dotsb p_{k_a})(q_1q_2\dotsb )
       = p_1p_2\dotsb p_{k_a}q_1q_2\dotsb q_{k_b}
$$
que realmente é um produtório de primos.
\endgraf
\proofstyle{Unicidade:}
Suponha que para alguns primos $p_i$'s e $q_j$'s, e uns $s,t\in\nats$, temos:
$$
\align
n &= p_1 p_2 \dotsc p_s,\\
n &= q_1 q_2 \dotsc q_t.
\endalign
$$
Vamos mostrar que $s = t$ e que para todo $i\in\set{1,\dotsc,s}$,  $p_i = q_j$.
Temos
$$
p_1 p_2 \dotsc p_s = q_1 q_2 \dotsc q_t,
$$
e $p_1$ é primo que divide o lado esquerdo, então divide também o lado direito:
$$
p_1 \divides q_1 q_2 \dotsc q_t.
$$
Pelo Lema de Euclides\Euclid~\ref{euclid_lemma}, $p_1\divides q_{j_1}$ para algum $j_1$.
Mas o $q_{j_1}$, sendo um dos $q_j$'s, também é primo.
Logo $p_1 = q_{j_1}$ (veja~\ref{in_primes_divides_means_equals}).
Cancelando o $p_1$, temos:
$$
p_2 \dotsc p_s = q_1 q_2 \dotsc q_{j_1 - 1} q_{j_1 + 1} q_t,
$$
Agora repetimos até um dos dois lados não ter mais fatores primos.
Necessariamente, isso vai acontecer ``simultaneamente'' nos dois lados
(caso contrario teriamos um produtório
de primos igual com 1, impossível), ou seja: $s = t$.
Note que as equações $p_i = q_{j_i}$ mostram a unicidade desejada.
\qed

Graças o teorema fundamental da aritmética podemos definir a:

\definition Representação canónica de inteiros.
\label{canonical_representation_of_ints}
\tdefined{representação canónica}[de inteiros]
Seja $0\neq n\in\ints$.
Sua \dterm{representação canónica} é o produtório
$$
n =
(\pm 1)
\prod_{i=1}^k
p_i^{a_i}
=
(\pm 1)
p_1^{a_1}
p_2^{a_2}
\dotsb
p_k^{a_k},
$$
onde os $p_1 < p_2 < \cdots < p_k$'s são primos, e $a_i\in\nats_{>0}$ para $i=1,\dotsc,k$.
\endgraf
\label{canonical_complete_representation}%
Observe que se relaxar a restrição nos exponentes tal que $a_i\in\nats$,
cada $n\in\ints$ ($n\neq 0$) pode ser representado (também únicamente) como o produtório
$$
n =
(\pm 1)
\prod_{i=0}^k
p_i^{a_i}
=
(\pm 1)
p_0^{a_0}
p_1^{a_1}
\dotsb
p_k^{a_k},
$$
onde agora os $p_0 < p_1 < \cdots < p_k$ são \emph{todos os $k+1$ primeiros primos},
sendo então $p_0 = 2$, e $p_k$ o maior primo divisor do $n$.
Chamamos essa forma a \dterm{representação canónica completa} do $n$.
(Veja também o~\ref{encoding_of_finite_sequences}.)

\exercise.
\label{canonical_representation_with_int_exponents}
O que acontece se relaxar a restrição nos exponentes ainda mais?: $a_i\in\ints$.

\endexercise

\endsection
%%}}}

%%{{{ Problems 
\problems.

\problem.
(Generalização do~\ref{implications_with_divisibility_of_linear_combinations}.)
Para quais $u,v\in\ints$, a afirmação 
$$
a \divides b + c \mland a \divides ub + vc \implies a \divides xb + yc \text{para todos $x,y\in\ints$}
$$
é válida?

\endproblem

\problem.
Prove que para todo $n\in\nats$, $\gcd {F_n} {F_{n+1}} = 1$,
onde $F_n$ é o $n$-ésimo termo da seqüência Fibonacci\Fibonacci[seqüência]{}~(\ref{fibonacci}).

\hint
Tu já resolveu o~\ref{gcd_of_two_is_gcd_of_one_plus_sum}, certo?

\solution
Vamos provar o pedido por indução.
Para $n=0$ temos
$$
    \gcd {F_0} {F_1} = \gcd 0 1 = 1.
$$
Seja $k\in\nats$ tal que $\gcd {F_k} {F_{k+1}} = 1$.
Precisamos mostrar que $\gcd {F_{k+1}} {F_{k+2}} = 1$.
Calculando,
$$
\alignat 2
\gcd {F_{k+1}} {F_{k+2}}
    &= \gcd {F_{k+1}} {F_{k+1} + F_k}   \qqby{pela definição da $F_n$}\\
    &= \gcd {F_{k+1}} {F_k}             \qqby{pelo~\ref{gcd_of_two_is_gcd_of_one_plus_sum}, com $a\asseq F_{k+1},\ b\asseq F_k$}\\
    &= \gcd {F_k} {F_{k+1}}             \qqby{propriedade de mdc}\\
    &= 1                                \qqby{pela hipótese indutiva}.
\endalignat
$$

\endproblem

\problem.
Seja $n\in\nats$, $n>1$.
Entre $n$ e $n!$ existe primo.

\hint
Olha para o $n!-1$.

\hint
Se $n!-1$ não é primo, toma um dos seus primos divisores, $p$.

\hint
Necessariamente $p > n$.

\endproblem

\problem.
Seja $n\in\nats$.
Ache $n$ consecutivos números compostos.

\hint
$!$

\hint
$m!+2$.

\hint
$m!+3$\dots

\hint
$m!+m$.

\endproblem

\problem.
Existe uma infinidade de primos ``da forma $4n+3$'', ou seja, o conjunto
$$
\set{4n+3 \st n\in\nats,\ \text{$4n+3$ primo}}
$$
é infinito.

\hint
Esquecendo o $2$, todos os primos são da forma $4n+1$ ou $4n+3$.
Suponha que $p_1, p_2,\dotsc, p_k$ ($k\in\nats$)
são todos os primos da segunda forma.

\hint
O que Euclides faria?

\hint
Tente achar (criar) um número da mesma forma tal que nenhum dos $p_i$ o divide.

\hint
$N = 4p_1p_2\dotsb p_k - 1$.

\hint
$N$ não pode ter apenas divisores da forma $4n+1$.

\endproblem

\problem.
$\text{PBO} \iff \text{PIF}$.

\hint
Para provar a \rldir, considere o predicado
``todos os conjuntos $A$ com $k\in A$ para algum natural $k\leq n$ têm mínimo'',
ou o ``todos os conjuntos $A$ com $n\in A$ têm mínimo''.

\hint
Prove que todos os naturais satisfazem o predicado que tu consideraste.
(Para um dos dois, tu precisará indução \emph{forte}.)

\solution
Nos já provamos a direção \lrdir.

\endproblem

\problem {Definição alternativa de m.d.c.}.
\label{gcd_alternative_definition}
Uma definição alternativa do m.d.c.~é a seguinte:
{\it Sejam $a,b\in\ints$.
O m.d.c.~dos $a$ e $b$ é o maior dos divisores em comum de $a$ e $b$.}
Ache um problema com essa definição, corrige-o, e depois compare
com a~\ref{gcd}.

\hint
O que acontece se $a=b=0$?
O que acontece se pelo menos um dos $a$ e $b$ não é o $0$?

\solution
Se $a=b=0$, o símbolo $\gcd a b$ não é definido,
porque todo $n\in\nats$ é um divisor em comum,
mas como o $\nats$ não tem um elemento máximo,
não existe o maior deles.
\endgraf
Precisamos restringir a definição para ser aplicável
apenas nos casos onde pelo menos um dos $a$ e $b$
não é o $0$ (escrevemos isso curtamente: $ab\neq 0$).
Assim, quando a nova definição é aplicável, ela realmente
defina o mesmo número, fato que segue pelas propriedades:
$$
\align
\gcd x 0 = 0 &\implies x = 0\\
x \divides y \mland y \neq 0 &\implies \abs x \leq \abs y.
\endalign
$$

\endproblem

\problem Contando os passos.
O que muda no~\ref{partitioning_restricted_best_strategy}
se em cada passo podemos quebrar todos os termos que aparecem?
Qual é a melhor estratégia, e quantos passos são necessários?

\hint
Tente quebrar o $10$ usando várias estratégias.
O que tu percebes?

\hint
Qual é o maior termo e como ele muda depois cada passo?

\solution
Agora a estratégia ótima seria quebrar cada termo ``no meio''.
Assim, para o $10$ temos:
$$
\align
10 &= 5 + 5\\
   &= (2 + 3) + (2 + 3)\\
   &= [(1 + 1) + (1 + 2)] + [(1 + 1) + (1 + 2)]\\
   &= 1 + 1 + 1 + 1 + 1 + 1 + 1 + 1 + 1 + 1
\endalign
$$
em apenas $4$ pássos.
Depois cada passo, se o maior termo fosse o $m$, agora é o $\ceil {\frac m 2}$.
Precisamos tantos passos quantas vezes que podemos dividir o $n$ por $2$ até
chegar na unidade $1$: precisamos $\ceil {\log_2(n)}$ passos.

\endproblem

\problem.
\def\Euclid{\algorithmstyle{Euclid}}%
\label{euclidean_algorithm_correctness_formal_proof_by_induction}
Como tu percebeu resolvendo o~\ref{euclidean_algorithm_proof_why_informal},
nenhuma das duas partes da prova do~\ref{euclidean_algorithm_correctness}
foi formal.
Prove completamente formalmente as duas partes usando indução.

\hint Precisa expressar o alvo na forma $\lforall n {P(n)}$ para um certo predicado $P$.

\hint
\def\Euclid{\algorithmstyle{Euclid}}%
``\emph{Para todo $x\in\ints$, o $\Euclid(x,n)$ termina com o resultado certo}.''

\hint O que significaria $P(0)$?  $P(b)$?

\hint Ser forte é coisa boa.

\solution
\def\Euclid{\algorithmstyle{Euclid}}%
Seja o predicado
$$
P(n) \defiff \lforall {x\in\ints} {\text{$\Euclid(x,n)$ termina com $\gcd x n$}}
$$
Vamos provar que $\lforall {n\in\nats} {P(n)}$ por indução forte.
Seja $k\in\nats$ tal que $P(i)$ é válido para todo $i<k$ (hipótese indutiva).
Precisamos provar o $P(k)$, ou seja, que
\emph{para todo $x\in\ints$, $\Euclid(x,k)$ termina e $\Euclid(x,k) = \gcd x k$}.
Seja $x\in\ints$, e aplica o $\Euclid(x,k)$ para um passo.
Se $k=0$, a computação termina imediatamente com o resultado $x$, que é correto
(\refn{gcd_of_comparable}).
Se $k>0$, o algoritmo manda reduzir sua computação para a computação do $\Euclid(k,r)$,
onde $r = x \bmod k < k$.  Seguindo o~\ref{euclid_gcd_lemma} $\gcd x k = \gcd k r$, então
falta verificar que o $\Euclid(k,r)$ termina mesmo com $\gcd k r$,
que é verdade pela hipótese indutiva porque $r < k$ e logo $P(r)$ é válido.

\endproblem

\problem.
\label{euclidean_algorithm_correctness_formal_proof_by_wop}
Prove completamente formalmente as duas partes
do~\ref{euclidean_algorithm_correctness} usando o princípio da boa ordem.

\hint
Considera as duas partes separamente:
qual conjunto é o não vazio em cada parte?

\hint
Vai pelo absurdo.

\hint
O que seria um contraxemplo para cada parte?
\emph{O que acontece se existem contraexemplos?}

\hint 
\def\Euclid{\algorithmstyle{Euclid}}%
Sobre sua terminação:
Considere o menor $m$ tal que o $\Euclid(x,m)$ não termina
para algum $x\in\ints$.

\hint
\def\Euclid{\algorithmstyle{Euclid}}%
Sobre sua corretude:
Considere o menor $m$ tal que o $\Euclid(x,m)$
termina com resultado errado par algum $x\in\ints$.
Mas mostre primeiro a terminação.

\solution
\def\Euclid{\algorithmstyle{Euclid}}%
Provamos cada parte separamente:
\endgraf
\smallskip
\proofstyle{Terminação.}
Para chegar num absurdo, suponha que existem contraexemplos:
\emph{inteiros $c\geq0$, tais que o $\Euclid(a,c)$
não termina para algum $x\in\ints$.}
Seja $m$ o menor deles (PBO):
$$
m = \min\set{c \in\nats \st \lexists {x\in\ints} {\text{\Euclid(x,c) não termina}}}.
$$
Logo, para algum certo $a\in\ints$, temos que $\Euclid(a,m)$ não termina.
Com certeza $m\neq 0$, porque nesse caso o algoritmo termina imediatamente.
Logo $m > 0$ e aplicando o $\Euclid(a,m)$ para apenas um passo
a sua computação é reduzida no computação do $\Euclid(m,r)$,
onde $r = a \bmod m < m$, \emph{e agora precisamos mostrar que o
$\Euclid(m,r)$ termina para chegar num absurdo}.
Pela escolha do $m$ como \emph{mínimo} dos contraexemplos,
o $r$ não pode ser contraexemplo também.
Em outras palavras, o $\Euclid(x,r)$ realmente termina para qualquer $x$,
então para $x=m$ também, que foi o que queriamos provar.
\endgraf
\smallskip
\proofstyle{Corretude.}
Para chegar num absurdo, suponha que existem contraexemplos:
\emph{inteiros $c\geq0$, tais que o $\Euclid(x,c)$
acha resultado errado para algum $x\in\ints$.}
Seja $m$ o menor desses contraexemplos (PBO):
$$
m = \min\set{c \in\nats \st \lexists {x\in\ints} {\Euclid(x,c) \neq \gcd x c}}.
$$
Logo, para algum certo $a\in\ints$, temos $\Euclid(a,m) \neq \gcd a m$.
Esse $m$ não pode ser $0$, porque nesse caso o algoritmo retorna sua primeira entrada $a$;
resultado correto por causa do~\ref{gcd_of_comparable}.
Então $m>0$.
Aplicamos para um passo o $\Euclid(a,m)$.
Como $m\neq 0$, o algoritmo manda realizar o segundo passo:
retornar o que $\Euclid(m,r)$, onde $r = a \bmod m < m$.
(E sabemos que o $\Euclid(m,r)$ vai retornar algo, porque
já provamos a terminação do algoritmo para todas as suas possíveis entradas!)
Para concluir, observe:
$$
\alignat 2
\Euclid(m,r) 
&= \Euclid(a,m)     \qqby{pelas instruções do algoritmo}\\
&\neq \gcd a m      \qqby{escolha dos $m$ e $a$}\\
&= \gcd m r.        \qqby{pelo~\ref{euclid_gcd_lemma}}
\endalignat
$$
Então $\Euclid(m,r) \neq \gcd m r$ e achamos um contraexemplo (o $r$)
menor que o mínimo (o $m$)---absurdo!

\endproblem

\problem Codificação de seqüências finitas.
\label{encoding_of_finite_sequences}
Seja $S$ o conjunto de seqüências finitas de números naturais.
Descreva uma método para ``codificar'' os elementos de $S$
com os elementos de $\nats\setminus\set0$.
Tua metodo deve ser uma \emph{revertível}, no sentido que
cada seqüência finita
$$
s = \seq{s_0,s_1,\dotsc,s_{k_s}}\in S
$$
deve corresponder em exatamente um número natural $n_s\in\nats\setminus\set0$,
e, dado esse número $n_s\in\nats_{>0}$, deveria ser possível ``extrair''
a seqüência $s$ cuja codificação é o $n_s$.
Não se preocupe se existem naturais que não sejam codificações de nenhuma
seqüência.

\hint Use o teorema fundamental da aritmética~(\refn{fundamental_theorem_of_arithmetic}).

\hint
Seja $p_i$ o $i$-esimo primo ($p_0 = 2$, $p_1 = 3$, $p_2 = 5$, \dots).
Como podemos escrever o aleatorio $n\in\nats$?

\hint
Olha nos exponentes na forma
$
n =
p_0^{a_0}
p_1^{a_1}
p_2^{a_2}
\cdots
p_{k_n}^{a_{k_n}}
$.

\hint
Teste tua codificação nas seqüências $\seq{1,3}$ e $\seq{1,3,0}$.
Como essas seqüências são diferentes, suas codificações devem ser diferentes também.
E a seqüência vazia $\seq{}\in S$?  

\solution
Seja
$$
p_0 < p_1 < p_2 < p_3 < \dotsb
$$
a seqüência infinita dos primos.  (Assim, $p_0 = 2$, $p_1 = 3$, $p_2 = 5$, etc.)
Seja
$$
\seq{s_0, s_1, \dotsc, s_{n-1}} \in S
$$
uma seqüência de naturais de tamanho $n$.
Vamos a codificar com o inteiro
$$
c_s
= \prod_{i=0}^{n-1} p_i^{s_i + 1}
= p_0^{s_0 + 1} p_1^{s_1 + 1} p_2^{s_2 + 1} \cdots p_{n-1}^{s_{n-1} + 1}.
$$
(Note que a seqüência vazia ($n=0$) correponde no número $1\in\nats_{>0}$.)
\endgraf
Conversamente, dado um número $c\in\nats_{>0}$ que codifica uma seqüência,
como podemos ``decodificar'' a seqüência que corresponda com ele?
Graças o teorema fundamental da aritmética~(\refn{fundamental_theorem_of_arithmetic}),
temos
$$
c = p_0^{a_0} p_1^{a_1} \cdots p_{m-1}^{a_{m-1}}.
$$
Se existe exponente $a_j = 0$, o $c$ não codifica nenhuma seqüência.
Caso contrario, todos os exponentes são positivos, e o $c$ codifica
a seqüência
$$
\seq{a_0-1, a_1-1, \dotsc, a_m-1} \in S.
$$

\endproblem

\problem Representação canónica de racionais.
\label{canonical_representation_of_rats}
Generalize a representação canónico de inteiros para racionais.

\hint
Qual foi tua resposta no~\ref{canonical_representation_with_int_exponents}?

\endproblem

\endproblems
%%}}}

%%{{{ Further reading 
\further.

Veja o~\cite[\S\S1.6--1.8]{babybm}.

\cite{elements},
\cite{disquisitiones}.

\cite{andrewsnumber}.

\cite{nivennumbers},
\cite{hardywright}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Congruences 
\chapter Congruências.

%%{{{ The idea behind congruence relation 
\section A idéia da relação de congruência.

\note.
Vamos fixar um inteiro positivo $m\in\nats$.
Graças a divisão do Euclides~(\ref{division_of_euclid}),
qualquer inteiro $a\in\ints$ pode ser escrito na forma
$$
a = mk + r,
\qquad
0 \leq r < m,
$$
num jeito único.
\endgraf
Enquanto investigando a (ir)racionalidade dos $\sqrt 2$, $\sqrt 3$, $\sqrt {\vphantom3 m}$,
etc., nos percebemos que foi útil separar os inteiros em classes,
``grupando'' aqueles que compartilham o mesmo resto quando divididos por $m$.
Trabalhando com essa idéia nos encontramos nosso primeiro contato com
\emph{aritmética modular}.%
\footnote{Mentira.  Não foi o primeiro não: nos somos todos acostumados com
aritmética modular mesmo sem perceber.  Um desses contatos é por causa de ter
que contar com horas e relógios, cuja aritmética não parece muito com aquela
dos inteiros.  Por exemplo: 21 + 5 = 26, mas se agora são 21h00, que horas
serão depois de 5 horas?  Nossos relógios não vou mostrar 26h00, mas 02h00.}

\endsection
%%}}}

%%{{{ Two equivalent definitions 
\section Duas definições equivalentes.

Precisamos definir formalmente a noção de ``\emph{dois inteiros $a$ e $b$ pertencem na
mesma classe, quando separamos eles em grupos usando o inteiro $m$}''.
A primeira coisa que precisamos perceber é que essa frase é uma afirmação sobre 3 objetos.
Queremos então uma definição e uma notação que captura essa relação \emph{de aridade 3}.

\note Congruência intuitivamente (1).
Chamamos dois inteiros \dterm{congruentes} modulo um terceiro inteiro,
sse eles têm o mesmo resto, quando divididos por ele.

\note Crítica.
Primeiramente, o texto da definição é bem informal e ambíguo.
Para tirar essas ambiguidades, precisamos introduzir variáveis para
referir sobre os ``mesmos restos'':

\note Congruência intuitivamente (2).
\label{congruence_intuitive_definition}
Sejam $a,b,m\in\ints$ com $m>0$, e sejam $q_a$, $r_a$, $q_b$, e $r_b$
os inteiros determinados por as divisões:
$$
\alignat 2
a &= mq_a + r_a     &\qquad& 0 \leq r_a < m\\
b &= mq_b + r_b     &      & 0 \leq r_b < m
\endalignat
$$
Digamos que os $a$ e $b$ são \dterm{congruentes} modulo $m$,
sse $r_a = r_b$.

\remark.
\label{from_same_remainders_to_divides_the_diference}
Olhando para dois números $a$ e $b$, congruêntes modulo $m$,
o que podemos dizer sobre a diferença deles?
Observe:
$$
\left.
\aligned
a - b
&= (mq_a + r_a) - (mq_b + r_b)\\
&= mq_a - mq_b + r_a - r_b\\
&= m(q_a - q_b) + (r_a - r_b)\\
&= m(q_a - q_b) + 0\\
&= m(q_a - q_b)
\endaligned
\right\}
\qquad
\aligned
\text{ou seja, $m\divides a - b$.}
\endaligned
$$
Essa observação nos mostra um caminho mais curto e elegante para definir o mesmo
conceito.  É o seguinte:

\definition Congruência (Gauss).
\label{congruence}
\tdefined{congruência}
\tdefined{módulo}
\Gauss[definição de congruência]
\sdefined{\holed a \cong {\holed b} \pmod {\holed m}}{\holed a é congruente com \holed b módulo \holed m}
Sejam $a,b,m\in\ints$ com $m>0$.
Digamos que os $a$ e $b$ são \dterm{congruentes} \dterm{modulo} $m$,
sse $m \divides a - b$.
Em símbolos, escrevemos
$$
a \cong b \pmod m
\defiff m \divides a - b
$$
e lemos: \emph{o $a$ é congruente com $b$ módulo $m$}.

\note Cuidado.
A notação de congruência as vezes iluda de ser enterpredada como se fosse
uma relação entre o lado esquerdo $L$ e o lado direito $R$, assim:
$$
\underbrace{a}_{L} \cong \underbrace{b \pmod m}_{R}.
$$
\emph{Não!}
Principalmente, o lado direito, $b \pmod m$, nem é definido, então não tem significado,
e nem faz sentido afirmar algo sobre ele.
Prestando mais atenção, percebemos que o $\hole \cong \hole$ também não foi definido!
O que nos definimos foi o:
$$
\holed u \cong \holed v \pmod {\holed w}
$$
dados $u,v,w\in\ints$ com $w>1$.

\note Intuição.
Se precisamos para algum motivo pessoal---porque sim---separar mentalmente a
notação de congruência em dois lados, o único jeito que faz algum sentido
seria o:
$$
\underbrace{\mathstrut a \cong b}_L\quad\underbrace{\!\!\pmod m}_{R}.
$$
Assim, entendemos que ``algo acontece'' (lado $L$), ``dentro algo'' (lado $R$),
onde ``algo acontece'' seria ``o $a$ \emph{parece} com $b$'',
e ``dentro algo'' seria ``modulo $m$''.
Mas, claramente tudo isso é apenas uma guia (caso que queremos)
e nada mais que isso.  Para argumentar sobre a relação de congruência,
usamos \emph{apenas sua definição formal!}

Para ganhar o direito de usar qualquer uma das duas definições, precisamos
mostrar que são equivalentes:

\theorem Equivalência das duas definições.
Sejam $a,b,m\in\ints$ com $m>0$, e sejam $q_a, r_a, q_b, r_b\in\ints$
os números determinados por as divisões:
$$
\alignat 2
a &= mq_a + r_a     &\qquad& 0 \leq r_a < m\\
b &= mq_b + r_b     && 0 \leq r_b < m
\endalignat
$$
Temos a equivalência:
$$
a \cong b \pmod m
\iff
r_a = r_b.
$$
\sketch.
Precisamos mostrar as duas direções do \bidir.
A direção \rldir, é praticamente
a~\ref{from_same_remainders_to_divides_the_diference}.
Para a direção \lrdir, vamos mostrar que $r_a - r_b = 0$.
Usamos a hipótese e propriedades de~$\divides$
para mostrar que $m\divides r_a - r_b$,
e depois as duas disegualdades para confirmar que, com suas restrições,
o único inteiro múltiplo de $m$ que as satisfaça, é o $0$.
\qes
\proof.
Precisamos mostrar as duas direções do \bidir:
\endgraf
\lrdir:
Suponha que
$a \cong b \pmod m$, ou seja,
$m\divides a - b$.
Resolvendo as duas equações das divisões por os restos $r_a$ e $r_b$,
temos:
$$
\left.
\aligned
r_a &= a - mq_a \\
r_b &= b - mq_b 
\endaligned
\right\}
\implies
\aligned
r_a - r_b
&= (a - mq_a) - (b - mq_b)\\
&= (a - b) - (mq_a - mq_b)\\
&= (a - b) - m(q_a - q_b).
\endaligned
$$
Observe que $m\divides a-b$ e $m\divides m(q_a - q_b)$.
Então $m$ tem que dividir a diferença deles também:
$$
m\divides \underbrace{(a - b) - m(q_a - q_b)}_{\dsize r_a - r_b}
$$
Usando as duas disegualdades: $0 \leq \abs{r_a - r_b} < m$.
Como $\abs{r_a-r_b}$ é um múltiplo de $m$, concluimos que necessariamente
$0 = \abs{r_a - r_b}$, ou seja: $r_a = r_b$.
\endgraf
\rldir:
Suponha que $r_a = r_b$.
Temos:
$$
\alignat 2
a - b
&= (mq_a + r_a) - (mq_b + r_b)                 \\
&= (mq_a - mq_b) - (r_a - r_b)                 \\
&= (mq_a - mq_b) - 0            \qqby{hipótese}\\
&= m(q_a - q_b),
\endalignat
$$
e como $q_a - q_b\in\ints$,
concluimos que
$m\divides a - b$, ou seja:
$a \cong b \pmod m$.
\qed

\note A operação binária ``mod''.
Em linguagens de programação é comum encontrar o operador \emph{binário}
``mod'', frequentemente denotado com o símbolo ``\thinspace{\tt \%}\thinspace''.
Em matemática, essa função \emph{binária} (aridade 2) é mais
encontrada como $\bmod$ mesmo.
Cuidado não confudir a \emph{função}
$\bmod : \ints\times\nats_{>0} \to \nats$
com a \emph{relação} $a \cong b \pmod m$.
Faz sentido escrever:
$$
69 \bmod 5 = 4.
$$
Isso significa apenas que o resto da divisão de 69 por 5, é 4.
No outro lado, nenhuma das expressões em baixo tem significado!:
$$
69 \pmod 5 = 4
\qquad\qquad
4 = 69 \pmod 5
$$

\exercise.
Explique o tipo da função $\bmod : \ints\times\nats_{>0} \to \nats$.

\hint Qual seria o valor de $4 \bmod 0$?

\solution
Por~\ref{division_of_euclid},
precisamos $a\in\ints$ e $b\in\nats_{>0}$ para definir a divisão
de $a$ por $b$.

\endexercise

\exercise mod vs mod.
\label{mod-vs-mod}
Para cada uma das expressões em baixo uma das 3 opções é valida:
(a) ela denota um termo;
(b) ela denota uma afirmação; ou
(c) ela não tem significado.
Para cada expressão, decida qual é a opção certa e:
se for a (a), ache o seu valor (objeto);
se for a (b), ache o seu valor (de verdade).
\doublecolumns
\beginol
\li $69 \pmod 5 = 4$
\li $12 = 3 \pmod 8 $
\li $12 \cong 20 \pmod 4 $
\li $8 \pmod 3 \cong 12$
\li $108 \cong 208 \pmod {(43 \bmod 30)}$
\li $x \bmod 4 = 2 \limplies x \cong 0 \pmod 2$
\li $5^{192 \bmod 3}$
\li $13\pmod 8 \cong 23 \pmod {18}$
\endol
\singlecolumn

\solution
Vamo lá:
\beginol
\li $69 \pmod 5 = 4$ não significa nada.
\li $12 = 3 \pmod 8$ não significa nada.%
\footnote{Se o $=$ fosse $\cong$, então significaria que $8 \divides 12 - 3 = 9$ (que é falso).}
\li $12 \cong 20 \pmod 4$ significa que $4 \divides 12 - 20 = -8$, que é verdade.
\li $8 \pmod 3 \cong 12$ não significa nada.
\li $108 \cong 208 \pmod {(43 \bmod 30)}$ significa que $43\bmod 30 \divides 108 - 208$, e para achar se é verdade ou não, calculamos $43\bmod 30 = 13$, e $108 - 208 = -100$ e substituimos: $13 \divides -100$, que é falso.
\li $\lforall {x\in\ints} {x \bmod 4 = 2 \limplies x \cong 0 \pmod 2}$ denota a afirmação que para todo $x\in\ints$, se $x \bmod 4 = 2$ então $x \cong 0 \pmod 2$, que é verdade:
seja $x\in\ints$ tal que $x \bmod 4 = 2$.  Logo $x = 4k + 2 = 2(2k + 1)$ para algum $k\in\ints$, ou seja, $2 \divides x = x - 0$.
\li $5^{192 \bmod 3}$ é o número 5 elevado ao resto da divisão de 192 por 3.  Como $3 \divides 192$ (por que?  1 + 9 + 2 = 12; 1 + 2 = 3; veja~\ref{divisibility_criterion_3}), temos $192 \bmod 3 = 0$, então o valor da expressão é o número $5^0 = 1$.
\li $13\pmod 8 \cong 23 \pmod {18}$ não significa nada.
\endol

\endexercise

\note Notação.
Talvez ficaria mais intuitivo (e menos confúso), usar uma notação como a
$$
a \cong_m b \defiff m \divides a - b
$$
que aparece mais fiel na sua semántica.
Mas a notação que é usada internacionalmente, é aquela que nos definimos
e nos vamos ficar consistentemente fieis nela!

\endsection
%%}}}

%%{{{ The relation congruence modulo $m$ 
\section A relação de congruência modulo $m$.

\note Fixando um $m$.
Se fixar um inteiro $m>0$, então a expressão
$$
\holed a \cong \holed b \pmod m
$$
tem duas variáveis livres: a $a$ e a $b$.
Assim, a ``congruência modulo $m$'' é uma relação binária,
cujas propriedades investigamos agora.

\theorem.
\ii{relação}[de equivalência]
\label{congruence_is_an_equivalence_relation}
Fixe um inteiro $m > 0$.
Para todos os $a,b\in\ints$,
temos:
$$
\xxalignat 2
(1)\quad&a \cong a \pmod m                             &&\text{\rm(reflexividade)}\\
(2)\quad&a \cong b \pmod m \mland b \cong c \pmod m
\implies
a \cong c \pmod m                                      &&\text{\rm(transitividade)}\\
(3)\quad&a \cong b \pmod m \implies b \cong a \pmod  m &&\text{\rm(simetria)}.
\endxxalignat
$$
\sketch.
Todas são facilmente provadas aplicando diretamente
a definição de congruência modulo $m$ (\refn{congruence})
e as propriedades básicas da $\divides$.
\qes
\proof.
(1) Obvio por que $m\divides a - a = 0$.
(2) Pela hipótese temos $m\divides a-b$ e $m\divides b-c$.
Então pelo~\ref{divides_properties} $m\divides (a-b) + (b-c) = a-c$.
(3) Pela hipótese temos $m\divides a - b$\thinspace; logo (\refn{divides_properties} de novo) $m\divides -(a - b) = b - a$.
\qed

\endsection
%%}}}

%%{{{ Modular arithmetic 
\section Aritmética modular.

\property.
\label{modular_arithmetic_properties}
Se $a \cong b \pmod m$, então para todo $x\in\ints$ temos:
$$
(1)\quad a + x \cong b + x   \pmod m;
\quad\enspace
(2)\quad ax \cong bx         \pmod m;
\quad\enspace
(3)\quad -a \cong -b         \pmod m.
$$
\sketch.
Todas seguem facilmente pela definição (\refn{congruence}) de congruência modulo $m$.
\qes

\note Cuidado.
\label{wrong_cancellation_law_modulo_m}
O lei de cancelamento, mesmo valido nas igualdades,
não é valido nas congruências em geral.
Por exemplo,
$3\ntimes 2 \cong 3\ntimes 8 \pmod {18}$,
mas não podemos cancelar os $3$ nos dois lados:
$2 \ncong 8 \pmod {18}$.

Felizmente, o teorema seguinte mostra quando realmente podemos cancelar:

\theorem Lei de cancelamento modulo $m$.
\label{cancellation_law_modulo_m}
Seja $c\in\ints$ tal que $\gcd c m = 1$.
$$
ca\cong cb\pmod m
\implies
a \cong b \pmod m.
$$
\sketch.
Multiplicamos tudo por $c^{-1}$, cuja existência (modulo $m$) é garantida
pela hipótese (aplicando o~\ref{find_inverse_modulo_m}).
\qes
\proof.
Como $\gcd c m = 1$, existe $c^{-1}$ (módulo $m$) então:
$$
\align
ca\cong cb\pmod m
&\implies          c^{-1}c a\cong          c^{-1}c b\pmod m\\
&\implies \phantom{c^{-1}c}a\cong \phantom{c^{-1}c}b\pmod m.
\endalign
$$
\moveqedup
\qed

\exercise.
Aplicando as definições e propriedades de congruência e $\divides$,
ache uma outra prova do~\refn{cancellation_law_modulo_m}.

\solution
Pela hipótese $m\divides ca - cb = c(a - b)$.
Mas $\gcd m c = 1$, então
(pelo~\ref{coprime_with_a_part_of_a_product_must_divide_the_other_part_to_divide_the_product})
$m\divides a - b$, ou seja, $a \cong b \pmod m$.

\endexercise

\exercise.
\label{from_mod_m_to_mod_am}
Suponha que $x \cong t \pmod m$, e seja $a$ um inteiro positívo.
O que podemos concluir sobre o $x$ módulo $ma$?

\hint
Use as definições de congruência (\refn{congruence}) e de $\divides$ (\refn{divides})
para escrever o $x$ na forma $x = mk + t$ para algum $k\in\ints$.

\hint
Agora divida o $k$ por $a$.

\solution
Pela definição de congruência (\refn{congruence}) e de $\divides$ (\refn{divides}) temos que:
$$
\align
x &= mk + t, \quad\text{para algum $k\in\ints$}.
\intertext{Dividindo o $k$ por $a$,
temos $k = aq + i$, onde $q,i\in\ints$ e $0\leq i < a$.  Substituindo:}
x &= m(aq + i) + t\\
  &= maq + (mi + t).
\intertext{Logo, chegamos nas $a$ congruências}
x &\cong mi + t \pmod{ma}, \quad\text{para $i=0,\dotsc,a-1$},
\endalign
$$
e $x$ tem que satisfazer (exatamente) uma delas.

\endexercise

\exercise De igualdades para congruências.
\label{from_equality_to_congruence}
Seja $a,b\in\ints$.  Se $a = b$, então $a\cong b\pmod m$ para qualquer inteiro $m\in\nats$.

\endexercise

\endsection
%%}}}

%%{{{ Divisibility criteria 
\section Critéria de divisibilidade.
\ii{divisibilidade}[critéria]
\label{divisibility_criteria}

\criterion Divisibilidade por 10$^k$.
\label{divisibility_criterion_powers_of_10}
Um inteiro $c\neq 0$ é divisível por $10^k$
sse
o $c$ escrito em base decimal
termina com $k$ dígitos 0.

\criterion Divisibilidade por $2$ ou $5$.
\label{divisibility_criterion_2}
\label{divisibility_criterion_5}
Seja $m\in\set{2, 5}$.
Um inteiro $c$ é divisível por $m$
sse
o valor do último dígitos do $c$ (em base decimal) é $m$.

\criterion Divisibilidade por 3 ou 9.
\label{divisibility_criterion_3}
\label{divisibility_criterion_9}
Seja $m\in\set{3, 9}$.
Um inteiro $c$ é divisível por $m$
sse
o somatório dos valores dos dígitos do $c$ (em base decimal) é
divisível por $m$.

\criterion Divisibilidade por 4, 20, 25, 50.
\label{divisibility_criterion_4}
\label{divisibility_criterion_20}
\label{divisibility_criterion_25}
\label{divisibility_criterion_50}
Seja $m\in\set{4, 20, 25, 50}$.
Um inteiro $c$ é divisível por $m$
sse
o número formado por os \oldstyle{2} últimos dígitos do $c$ (em base decimal)
é divisível por $m$.

\criterion Divisibilidade por 11.
\label{divisibility_criterion_11}
Um inteiro $c$ é divisível por $11$
sse
o somatório dos valores dos dígitos do $c$ (em base decimal) em posição par
menos o somatório dos valores dos seus dígitos em posição impar
é divisível por $11$.

\exercise Divisibilidade por 6.
\label{divisibility_criterion_6}
Ache um critério (para o sistema decimal) para divisibilidade por 6.

\hint $6 = 2\ntimes 3$

\solution
Observe que por causa do~\ref{product_of_coprimes_divides_common_multiple}, temos:
$$
6\divides c
\iff
2 \divides c
\mland
3 \divides c.
$$
Logo, aplicamos os critéria de divisibilidade por $2$ e por $3$.

\endexercise

\criterion Divisibilidade por 8.
\label{divisibility_criterion_8_wrong}
Um número $c$ é divisível por 8 sse ele satisfaz
os critéria de divisibilidade por $2$ e $4$.
\wrongproof.
Observe que por causa do~\ref{product_of_coprimes_divides_common_multiple}, temos:
$$
8 \divides c
\iff
2 \divides c
\mland
4 \divides c.
$$
Logo, aplicamos os critéria de divisibilidade por $2$ e por $4$.
\mistaqed

\exercise.
Ache o erro no~\ref{divisibility_criterion_8_wrong},
e compare com a solução do~\ref{divisibility_criterion_6}.

\hint Veja o~\ref{product_of_coprimes_divides_common_multiple}.

\solution
Como $\gcd 4 2 = 4 \neq 1$, não podemos aplicar
o~\ref{product_of_coprimes_divides_common_multiple}.
Um contraexemplo:
$2 \divides 12$ e $4 \divides 12$, mas $2\ntimes 4 = 8 \ndivides 12$.

\endexercise

\exercise.
Ache um critério (no sistema decimal) para divisibilidade por 8,
e generaliza para divisibilidade por $2^k$

\hint $8 = 2^3$, e $2 \divides 10$.

\hint $2 \divides 10 \implies 2^3 \divides 10^3$.

\endexercise

\exercise.
Ache um critério (no sistema decimal) para divisibilidade por $2^x5^y$, onde $x,y\in\nats$.

\hint Os $2$ e $5$ são divisores de $10$.

\endexercise

\endsection
%%}}}

%%{{{ Inverses modulo $m$ 
\section Inversos modulo $m$.

\definition Inverso módulo $m$.
\tdefined{inverso}[multiplicativo módulo $m$]
\sdefined{{\holed a}^{-1}}{o inverso (multiplicativo) do $\holed a$ (modulo $m$)}
\label{inverse_modulo_m}
Seja $a,a',m\in\ints$.
Chamamos $a'$ \dterm{um inverso (multiplicativo) de $a$ módulo $m$},
sse
$$
aa' \cong 1 \pmod m.
$$
Se existe inverso do $a$, o denotamos com $a^{-1}$ (dado um modulo $m$).\mistake

\exercise.
Qual o problema com a definição do $a^{-1}$?

\solution
Para o símbolo $a^{-1}$ ser bem-definido, precisamos mostrar que, caso que
existe um inverso, ele é único, que nos realmente mostramos
no~\ref{inverse_modulo_m_uniqueness}.

\endexercise

Podemos falar sobre \emph{o} inverso (ao invés de \emph{um} inverso) graças o teorema seguinte:

\theorem Unicidade do inverso.
\label{inverse_modulo_m_uniqueness}
Sejam $a,m\in\ints$.
Se $b,b'\in\ints$ satisfazem a $ax \cong 1 \pmod m$, então $b \cong b' \pmod m$.
\proof.
Como
$$
ab  \cong 1 \pmod m \qquad\mland\qquad ab' \cong 1 \pmod m,
$$
pela transitividade e reflexividade da congruência modulo $m$, temos:
$$
ab \cong ab' \pmod m.
$$
Pela~\ref{modular_arithmetic_properties}, podemos multiplicar os dois lados por $b$:%
\footnote{Nada especial sobre $b$ contra o $b'$.  Poderiamos multiplicar por qualquer inverso do $a$ aqui.}
$$
bab \cong bab' \pmod m.
$$
Daí,
$(ba)b \cong (ba)b' \pmod m$,
ou seja $b \cong b' \pmod m$.
\qed

\example.
O inverso de $2$ modulo $9$ é o $5$, porque $2\ntimes 5 = 10 \cong 1 \pmod 9$.
\endexample

Como o exemplo seguinte mostra, os inversos não existem sempre:

\example.
O $4$ não tem inverso modulo $6$.

\solution
Podemos verificar com força bruta:
$$
\align
4 \ntimes 1 = \phantom04    &\cong 4 \pmod 6\\
4 \ntimes 2 = \phantom08    &\cong 2 \pmod 6\\
4 \ntimes 3 = 12            &\cong 0 \pmod 6\\
4 \ntimes 4 = 16            &\cong 4 \pmod 6\\
4 \ntimes 5 = 20            &\cong 2 \pmod 6
\endalign
$$
\moveqedup
\endexample

O teorema seguinte esclariza a situação:

\theorem Inverso módulo $m$.
\label{find_inverse_modulo_m}
Sejam $a,m\in\ints$.
$$
\text{$a$ tem inverso modulo $m$}
\iff
\gcd a m = 1.
$$
\proof.
Precisamos mostrar as duas direções do \bidir.
\endgraf
\lrdir:
Escrevemos o $\gcd a m = 1$ como combinação\ii{combinação linear} linear dos $a$ e $m$
(sabemos que é possivel por \ref{gcd_as_linear_combination}, e, até melhor construtível graças o algoritmo extendido de Euclides,~\ref{extended_euclidean_algorithm}):
$$
\alignat 2
1 &= sa + tm, &&\qquad\text{para alguns $s,t\in\ints$.}
\intertext{Então temos:}
1 &\cong sa + tm    &&\pmod m\\
  &\cong sa + 0     &&\pmod m\\
  &\cong sa         &&\pmod m.
\endalignat
$$
Acabamos de achar um inverso de $a$ modulo $m$: o $s$.
\endgraf
\rldir:
Seja $b$ um inverso de $a$ modulo $m$; em outras palavras:
$$
ab \cong 1 \pmod m,
$$
ou seja, $m \divides ab - 1$, e $mu = ab - 1$ para algum $u\in\ints$.
Conseguimos escrever
$$
1 = um - ba,
$$
a combinação linear dos $a$ e $m$.
Pelo~\ref{gcd_divides_any_linear_combination}, $\gcd a m \divides 1$,
logo $\gcd a m = 1$.
\qed

\endsection
%%}}}

%%{{{ The Chinese remainder theorem 
\section O teorema chinês do resto.

\theorem Teorema chinês do resto.
\ii{teorema}[chinês do resto]
\iisee{chinês}[teorema do resto]{teorema chinês}
\ii{sistema}[de congruências]
\ii{congruência}[sistema]
\label{chinese_remainder_theorem}
Sejam $a_1,\dotsc,a_k,m_1,\dotsc,m_k\in\ints$,
com os $m_i$'s coprimos dois a dois:
$$
\lforall {i,j\in\set{1,\dotsc,k}} {i\neq j \limplies \gcd {m_i} {m_j} = 1}.
$$
Então existe $x\in\ints$ que satisfaz o sistema de congruências
$$
\align
x &\cong    a_1    \pmod {m_1}\\
x &\cong    a_2    \pmod {m_2}\\
  &\eqvdots                   \\
x &\cong    a_k    \pmod {m_k}.
\endalign
$$
Alem disso, a solução do sistema é única modulo $m_1\dotsb m_k$.
\sketch.
\proofstyle{Existência:}
Seja
$$
\align
M   &\asseq \prod_{i=1}^k m_i = m_1m_2\dotsb m_k
\intertext{e, para todo $i\in\set{1,\dotsc,k}$, defina o}
M_i &\asseq \prod_{\Sb j=1\\j\neq i\endSb}^k m_j
     = m_1\dotsb m_{i-1}m_{i+1}\dotsb m_k
     = \frac M {m_i}.
\endalign
$$
Observe que $M_i$ é invertível modulo $m_i$,
então seja $B_i$ o seu inverso.
Verificamos que o inteiro
$$
x =
\sum_{i=1}^k
a_i M_i B_i
$$
satisfaz todas as $k$ congruências,
e é então uma solução do sistema.
\endgraf
\proofstyle{Unicidade:}
Suponha que $x'\in\ints$ é uma solução do sistema.
Usando a definição de congruência e propriedades
de $\divides$, mostramos que $x' \cong x \pmod M$.
\qes

\example.
Ache todos os inteiros $x\in\ints$ que satisfazem o sistema de congruências:
$$
\align
x &\cong 2 \pmod 9\\
x &\cong 1 \pmod 5\\
x &\cong 2 \pmod 4.
\endalign
$$

\solution
Observamos primeiramente que os módulos $9$, $5$, e $4$ realmente são coprimos
dois a dois.  Então, pelo teorema chinês do resto,
o sistema realmente tem solução.
Seguindo sua método---e usando os mesmos nomes para as variáveis como
no~\ref{chinese_remainder_theorem} mesmo---calculamos os:
$$
\xalignat2
M_{\phantom0}   &= 9\ntimes5\ntimes4 = 180  &      &               \\
M_1 &= \phantom{9\ntimes{}}5\ntimes4 = 20   &  B_1 &\cong 5 \pmod 9\\
M_2 &= 9\phantom{{}\ntimes5}\ntimes4 = 36   &  B_2 &\cong 1 \pmod 5\\
M_3 &= 9\ntimes5\phantom{{}\ntimes4} = 45   &  B_3 &\cong 1 \pmod 4, 
\endxalignat
$$
onde os invérsos $B_i$'s podemos calcular usando o algoritmo extendido de
Euclides~(\refn{extended_euclidean_algorithm}) como na prova
do~\ref{find_inverse_modulo_m}), mas nesse caso, sendo os módulos tão pequenos
fez mas sentido os achar testando, com ``força bruta''.
Então, graças o teorema chinês, as soluções são exatamente os inteiros $x$ que satisfazem
$$
\alignat2
x &\cong a_1M_1B_1 + a_2M_2B_2 + a_3M_3B_3                                      &&\pmod M\\
  &\cong 2 \ntimes 20\ntimes 5 + 1 \ntimes 36\ntimes 1 + 2 \ntimes 45\ntimes 1  &&\pmod {180}\\
  &\cong 200 + 36 + 90                                                          &&\pmod {180}\\
  &\cong 146                                                                    &&\pmod {180}.
\endalignat
$$
Para resumir, as soluções do sistema são todos os elementos do
$\set{ 180k + 146 \st k\in\ints }$.
\endexample

\example.
Ache todos os inteiros $x\in\ints$ com $\abs x < 64$ que satisfazem o sistema de congruências:
$$
\align
x  &\cong 1 \pmod 3\\
3x &\cong 1 \pmod 4\\
4x &\cong 2 \pmod 5.
\endalign
$$

\solution
Para aplicar o teorema chinês do resto precisamos os $3$, $4$, e $5$ coprimos dois a dois,
que realmente são.
Mas observe que o sistema não está na forma do teorema;
aí, não podemos o aplicar diretamente.
Nosso primeiro alvo então seria transformar a segunda e a terceira congruência para
equivalentes, na forma necessária para aplicar o teorema.
Na segunda vamos nos livrar do fator $3$, e na terceira do fator $4$.
Como $\gcd 3 4 = 1$,%
\footnote{Qual ``4'' foi esse?}
o $3$ é invertível modulo $4$.
Como o $3\cong -1 \pmod 4$, temos diretamente que $3^{-1} \cong -1 \pmod 4$.
Similarmente achamos o inverso $4^{-1} \cong -1 \pmod 4$.
Então temos:
$$
\left.
\aligned
x  &\cong 1 \pmod 3\\
3x &\cong 1 \pmod 4\\
4x &\cong 2 \pmod 5
\endaligned
\right\}
\iff
\left\{
\aligned
x  &\cong \phantom{1^{-1}}1 \pmod 3\\
3^{-1}3x &\cong 3^{-1}1 \pmod 4\\
4^{-1}x &\cong 4^{-1}2 \pmod 5
\endaligned
\right\}
\iff
\left\{
\aligned
x &\cong \phantom{-}1 \pmod 3\\
x &\cong -1 \pmod 4\\
x &\cong -2 \pmod 5.
\endaligned
\right.
$$
Agora sim, podemos aplicar o teorema chinês.
Usando os mesmos nomes para as variáveis
como no~\ref{chinese_remainder_theorem}, calculamos:
$$
\xalignat2
M_{\phantom0}   &= 3\ntimes4\ntimes5              = 60 &     &               \\
M_1             &= \phantom{3\ntimes{}}4\ntimes5  = 20 & B_1 &\cong 2 \pmod 3\\
M_2             &= 3\phantom{{}\ntimes4}\ntimes5  = 15 & B_2 &\cong 3 \pmod 4\\
M_3             &= 3\ntimes4\phantom{{}\ntimes5}  = 12 & B_3 &\cong 3 \pmod 5, 
\endxalignat
$$
onde os invérsos $B_1$ e $B_2$ calculamos percebendo que
$20\cong-1 \pmod 3$ e $15\cong-1 \pmod 4$, e o $B_3$ com força bruta mesmo.
Pronto: as soluções do sistema são exatamente os inteiros $x$ que satisfazem:
$$
\alignat 3
x &\cong a_1M_1B_1 + a_2M_2B_2 + a_3M_3B_3                            &&\pmod M\\
  &\cong 2\ntimes20\ntimes1 + 3\ntimes15\ntimes3 + 3\ntimes12\ntimes3 &&\pmod {60}\\
  &\cong 40 + 135 + 108                                               &&\pmod {60}\\
  &\cong 40 + 15 + 108                                                &&\pmod {60}\qqby{$135\cong15\pmod{60}$}\\
  &\cong 55 + 48                                                      &&\pmod {60}\qqby{$108\cong48\pmod{60}$}\\
  &\cong -5 + 48                                                      &&\pmod {60}\qqby{$\phantom055\cong-5\pmod{60}$}\\
  &\cong 43                                                           &&\pmod {60}.
\endalignat
$$
Logo, o conjunto de todas as soluções do sistema é o $\set{ 60k + 43 \st k\in\ints }$.
Facilmente verificamos que os únicos dos seus elementos que satisfazem nossa
restrição $\abs x < 64$ são os inteiros obtenidos pelos valores de $k = 0$ e $-1$:
$x_1 = 43$, $x_2 = -17$.
\endexample

\exercise ``entre si'' vs ``dois a dois''.
\label{coprime_vs_pairwise_coprime}
Considere as frases:
\beginol
\li Os inteiros $a_1, a_2, \dotsc, a_n$ são coprimos entre si.
\li Os inteiros $a_1, a_2, \dotsc, a_n$ são coprimos dois a dois.
\endol
\noindent São equivalentes?
Se sim, prove as duas direções da equivalência; se não, ache um contraexemplo.

\hint
Não são equivalentes.

\hint
Procure um contraexemplo com três inteiros.

\solution
Os $2$, $4$, $5$ são coprimos entre si (têm m.d.c.~1) mas mesmo assim não são coprimos dois a dois:
$\gcd 2 4 = 2$.

\endexercise

\exercise.
Acha as soluções dos seguinte sistemas de congruências:
$$
\xalignat2
\text{(1)}\quad&
\left\{
\aligned
x  &\cong 3\phantom0 \pmod 4\\
5x &\cong 1\phantom0 \pmod 7\\
x  &\cong 2\phantom0 \pmod 9
\endaligned
\right.
&
\text{(2)}\quad&
\left\{
\aligned
x  &\cong 3\phantom0 \pmod 3\\
3x &\cong 3\phantom0 \pmod 4\\
4x &\cong 2\phantom0 \pmod 5\\
5x &\cong 1\phantom0 \pmod 7.
\endaligned
\right.
\endxalignat
$$

\endexercise

O exercísio seguinte te convida descobrir que o teorema chinês pode ser aplicado
em casos mais gerais do que aparece inicialmente!

\exercise.
Resolva os sistemas de congruências:
$$
\xalignat2
\text{(1)}\quad&
\left\{
\aligned
5x &\cong 2\phantom0  \pmod 6\\
x  &\cong 13 \pmod {15}\\
x  &\cong 2\phantom0  \pmod 7
\endaligned
\right.
&
\text{(2)}\quad&
\left\{
\aligned
x  &\cong 2\phantom0  \pmod 6\\
x  &\cong 13 \pmod {15}\\
x  &\cong 2\phantom0  \pmod 7.
\endaligned
\right.
\endxalignat
$$

\hint Observe que não podes aplicar o teorema chinês diretamente: $\gcd 6 {15} > 1$.

\hint Tente substituir a congruência $5x \cong 2  \pmod 6$ com um sistema equivalente, de \emph{duas} congruências.

\hint Mostre que para qualquer $a\in\ints$,
$$
\left.
a \cong 2 \pmod 6
\right\}
\iff
\left\{
\aligned
a &\cong 0 \pmod 2\\
a &\cong 2 \pmod 3.
\endaligned
\right.
$$

\hint
Não todos os sistemas de congruências tem soluções.
(Acontéce quando temos restrições contraditórias.)
Nesse exercísio um dos dois sistemas não tem solução.

\endexercise

\endsection
%%}}}

%%{{{ Euler's totient function 
\section A função totiente de Euler.

\definition Função totiente de Euler.
\iisee{totiente}{função totiente}
\iisee{Euler}[função]{função totiente}
\Euler[função totiente]
\tdefined{função}[totiente de Euler]
\sdefined{\totsym} {a função totiente de Euler}
\label{euler_phi_function}
Seja inteiro $n>0$.
Definimos
$$
\tot n \defeq \sizeof {\set { i \in \set{1,\dotsc,n} \st \gcd i n = 1 } }.
$$
Em palavras, $\tot n$ é o número dos inteiros entre $1$ e $n$ que são coprimos com $n$.

\exercise.
Calcule os valores da $\tot n$ para $n=1,2,3,4,8,11,12,16.$

\endexercise

\property.
\label{tot_of_prime}
$\text{$p$ primo} \implies \tot p = p-1.$
\proof.
Como $p$ é primo, ele é coprimo com todos os $1,\dotsc,p-1$.
E como $\gcd p p = p \neq 1$, pela definição da $\totsym$ temos
$\tot p = p-1$.
\qed

\exercise.
\label{number_of_multiples_of_a_until_ai}
Quantos multiplos de $a$ existem no $\set{1,2,\dotsc,a^i}$?

\endexercise

\exercise.
\label{tot_of_power_of_prime}
$
\text{$p$ primo} \implies
\tot {p^a} = p^a - p^{a-1} = p^{a-1} (p-1)
$.

\hint Use a definição de $\totsym$ e o~\ref{number_of_multiples_of_a_until_ai}.

\solution
Seguindo a definição de $\totsym$, vamos contar todos os números
no $\set{1,2,\dotsc,p^i}$ que são coprimos com $p^i$.
Quantos não são?
Observe que como $p$ é primo,
os únicos que não são coprimos com ele,
são os múltiplos de $p$.
Pelo~\ref{number_of_multiples_of_a_until_ai} temos a resposta.

\endexercise

\exercise.
\label{sum_of_tots_of_powers_of_prime}
Sejam $p$ primo e $k\in\ints$.  Calcule o valor do somatório
$\sum_{i=0}^k \tot {p^i}$.

\hint Calcule o valor de cada termo aplicando o~\ref{tot_of_power_of_prime}.

\endexercise

\exercise.
\label{tot_of_product_of_primes}
$\text{$p,q$ primos, $p\neq q$} \implies \tot {pq} = (p-1)(q-1)$.

\endexercise

\theorem.
\iisee{multiplicativa}{função multiplicativa}
\tdefined{função}[multiplicativa]
\label{tot_is_multiplicative}
A função $\totsym$ é \dterm{multiplicativa}:
$$
\gcd m n = 1 \implies \tot {mn} = \tot m \tot n.
$$

\corollary.
Se $n\geq 2$, então
$$
\tot n
= n \!\!\prod_{\Sb\text{$p$ primo}\\p \divides n\endSb}\!\!\left(1-\frac 1 p\right)
= n
\left(1-\frac 1 {p_1}\right)
\left(1-\frac 1 {p_2}\right)
\dotsb
\left(1-\frac 1 {p_k}\right),
$$
onde os $p_i$'s são todos os primos divisores de $n$.
\sketch.
Escrevemos o $n$ na sua representação canónica pelo teorema fundamental da aritmética~(\refn{fundamental_theorem_of_arithmetic}), e aplicamos repetetivamente o~\ref{tot_is_multiplicative}.
\qes
\proof.
Pelo teorema fundamental da aritmética~(\refn{fundamental_theorem_of_arithmetic}),
seja $n \eqass p_0^{a_0} p_1^{a_1} \dotsb p_k^{a_k}$ a representação canónica
\ii{representação canónica} do $n$.  Calculamos:
$$
\alignat2
\tot n
&= \tot {p_0^{a_0} p_1^{a_1} \dotsb p_k^{a_k}}              \\
&= \tot {p_0^{a_0}} \tot{p_1^{a_1}} \dotsb \tot{p_k^{a_k}}  \qqby{\ref{tot_is_multiplicative}}\\
&=
p_0^{a_0}\paren{1 - \frac 1 {p_0}}
p_1^{a_1}\paren{1 - \frac 1 {p_1}}
\dotsb
p_k^{a_k}\paren{1 - \frac 1 {p_k}}                          \qqby{\ref{tot_of_power_of_prime}}\\
&=
p_0^{a_0}p_1^{a_1}\dotsb p_k^{a_k}
\paren{1 - \frac 1 {p_0}}\paren{1 - \frac 1 {p_1}}\dotsb\paren{1 - \frac 1 {p_k}}\\
&=
n
\paren{1 - \frac 1 {p_0}}\paren{1 - \frac 1 {p_1}}\dotsb\paren{1 - \frac 1 {p_k}}.
\endalignat
$$
\moveqedup
\qed

\exercise.
$a\divides b \implies \tot a \divides \tot b$.

\endexercise

\exercise.
$
\tot {2n} =
\knuthcases{
2\tot n,& $n$ é par \cr
\tot n, & $n$ é impar.
}
$

\endexercise

\exercise.
\label{tot_is_par_for_n_greater_than_2}
$\tot n$ é par para todo $n\geq 3$.

\hint Os inverso aparecem ``em pares''.  Mas uns são emparelhados com eles
mesmo, sendo seus próprios inversos (por exemplo, o inverso de 1, é o 1, módulo
qualquer $m$).

\hint Escreva o $n$ na sua representação canónica pelo teorema fundamental da aritmética~(\refn{fundamental_theorem_of_arithmetic}).

\hint
Aplica o~\ref{tot_is_multiplicative} e o~\ref{tot_of_power_of_prime}.

\hint
Ou o $2$ aparece nos fatores primos do $n$, ou não.

\endexercise

\endsection
%%}}}

%%{{{ Theorems of Euler and Fermat 
\section Teoremas de Euler e de Fermat.

\theorem Euler.
\label{euler_congruence_theorem}
\Euler[teorema]
Sejam $a,m\in\ints$ com $\gcd a m = 1$.
Então
$$
a^{\tot m} \cong 1 \pmod m.
$$
\sketch.
Considere o conjunto
$$
\align
 R &=\set{r_1, r_2, \dotsc, r_{\tot m}}
\intertext{de todos os inteiros $r$ com $1 \leq r \leq m$, e $\gcd r m = 1$, e o conjunto}
aR &= \set{ar \st r \in R}\\
   &= \set{ar_1, ar_2, \dotsc, ar_{\tot m}}.
\endalign
$$
Observamos agora que (módulo $m$) os $ar_1,ar_2,\dotsc,ar_{\tot m}$
são apenas uma permutação dos $r_1,r_2,\dotsc,r_{\tot m}$.
Logo os seus produtórios são congruentes:
$$
(ar_1)(ar_2)\dotsb (ar_{\tot m})
\cong
r_1r_2\dotsb r_{\tot m}
\pmod m.
$$
Trabalhando na última congruência chegamos na congruência desejada.
\qes

\corollary Fermat.
\label{fermat_little_theorem_1}
\Fermat[teorema]
Sejam $p$ primo e $a\in\ints$ com $\gcd a p = 1$.
Então
$$
a^{p-1} \cong 1 \pmod p.
$$
\sketch.
O resultado é imediato usando o teorema de Euler
(\refn{euler_congruence_theorem}) e a~\ref{tot_of_prime}.
\qes
\proof.
Como $p$ é primo, sabemos que $\tot p = p-1$, então temos:
$$
\alignedat 2
a^{p-1}
&= a^{\tot m}       \qqby{\ref{tot_of_prime}} \\
&\cong 1 \pmod m.   \qqby{\ref{euler_congruence_theorem}}
\endalignedat
$$
\qed

\corollary Fermat.
\label{fermat_little_theorem_2}
\Fermat[teorema]
Sejam $p$ primo e $a\in\ints$.
Então
$$
a^p \cong a \pmod p.
$$
\sketch.
Considere dois casos: $\gcd a p = 1$ ou $\gcd a p > 1$.
No primeiro usamos o~\ref{fermat_little_theorem_1}.
No segundo, necessariamente temos $0\cong a^p\cong a \pmod p$.
\qes
\proof.
Temos dois casos:
\endgraf
\casestyle{Caso $\gcd a p$ = 1}:
Pelo~\ref{fermat_little_theorem_1} temos:
$$
\align
a^{p-1} &\cong 1 \pmod p
\intertext{e multiplicando por $a$,}
a^p     &\cong a \pmod p.
\endalign
$$
\endgraf
\casestyle{Caso $\gcd a p$ > 1}:
Nesse caso, como $p$ é primo, necessariamente $p\divides a$,
ou seja, $a \cong 0 \pmod p$,
logo $a^p \cong 0 \pmod p$.
Agora pela transitividade e
simetria da $congruência$ modulo $m$, finalmente temos:
$a^p \cong a \pmod p$
\qed

\note Resumindo os três teoremas.
Esquematicamente:
$$
\alignat 4
\text{$\gcd a m = 1$}
&\implies{}
&a^{\tot m} &&{}\cong 1 & \pmod m
&\qqqquad&\text{Euler, (\refn{euler_congruence_theorem})}
\\
\text{$p$ primo}
&\implies{}
&a^{p-1} &&{}\cong 1& \pmod p
&\qqqquad&\text{Fermat, (\refn{fermat_little_theorem_1})}
\\
\left.
\aligned
\text{$p$ primo}\\
\gcd a p = 1
\endaligned
\right\}
&\implies{}
&a^p &&{}\cong a &\pmod p
&\qqqquad&\text{Fermat, (\refn{euler_congruence_theorem})}.
\endalignat
$$

\example.
\label{last_digit_of_big_number_example}
Ache o último dígito do $2^{800}$.

\solution
Procuramos um $y$ tal que $2^{800}\cong y \pmod {10}$
(por que?).
Usando o teorema de Fermat~(\ref{fermat_little_theorem_1}) temos:
$$
\align
2^4 &\cong 1 \pmod 5,
\intertext{logo}
2^{800} = (2^4)^{200} &\cong 1 \pmod 5.
\endalign
$$
Então módulo $10$ temos duas possibilidades (por que?):
$$
2^{800} \cong
\knuthcases{
1 \pmod {10}\cr
6 \pmod {10}.\cr
}
$$
Podemos já eliminar a primeira porque $2^{800}$ é par.
Finalmente, o último dígito de $2^{800}$ é o \digit6.
\endexample

\exercise.
Responda no primeiro ``por que?'' do~\ref{last_digit_of_big_number_example}.

\hint Escreva o inteiro como somatório baseado na sua forma decimal.

\hint Divide ele por 10.

\solution
Para o número $n$ escrito em base decimal como $\delta_k\delta_{k-1}\dotsb \delta_1\delta_0$,
temos:
$$
\align
n
&= d_0 + 10d_1 + 100d_2 + \dotsb 10^{k-1}d_{k-1} + 10^kd_k\\
&= \underbrace{d_0}_{\text{resto}} + 10\underbrace{(d_1 + 10d_2 + \dotsb 10^{k-2}d_{k-1} + 10^{k-1}d_k)}_{\text{quociente}},
\endalign
$$
onde $d_i$ é o correspondente valor do dígito $\delta_i$.
(Evitamos aqui confudir o ``dígito'' com seu valor usando notação diferente
para cada um, para enfatisar a diferença entre os dois conceitos.)

\endexercise

\exercise.
Responda no segundo também, e ache um outro caminho para chegar no resultando, usando
o teorema chinês do resto (\ref{chinese_remainder_theorem}).

\hint Qual a solução do sistema
$$
\align
x &\cong 1 \pmod 5\\
x &\cong 0 \pmod 2?
\endalign
$$

\solution
Podemos ou aplicar o teorema chinês (\ref{chinese_remainder_theorem}) no sistema de congruências
$$
\align
x &\cong 1 \pmod 5\\
x &\cong 0 \pmod 2,
\endalign
$$
ou, como $5\divides 10$, usar diretamente o~\ref{from_mod_m_to_mod_am},
para concluir que $x = 10k + 5i + 1$, onde $i=0,1$.

\endexercise

\exercise.
Ache o resto da divisão de $41^{75}$ por $3$.

\hint Procure $y$ tal que $41^{75} \cong y \pmod 3$.

\hint $\gcd {41} 3 = 1$.

\hint $41^{75} = 41^{74}\ntimes 41$.

\hint Fermat.

\solution
Como $\gcd {41} 3 = 1$, pelo teorema de Fermat (\ref{fermat_little_theorem_1})
temos
$$
41^{\tot 3} = 41^2 \cong 1 \pmod 3,
$$
e agora dividindo o $75$ por $2$, temos $75 = 2\ntimes 37 + 1$, então:
$$
\alignat 3
41^2 \cong 1 \pmod 3 &\implies (41^2)^{37}  &&\cong \phantom01  &&\pmod 3    \\
                     &\implies 41^{74}      &&\cong \phantom01  &&\pmod 3    \\
                     &\implies 41^{74}41    &&\cong 41 &&\pmod 3    \\
                     &\implies 41^{75}      &&\cong 41 &&\pmod 3    \\
                     &\implies 41^{75}      &&\cong \phantom02  &&\pmod 3.
\endalignat
$$
Outro jeito para escrever exatamente a mesma idéia,
mas trabalhando ``de fora pra dentro'', seria o seguinte:
$$
\alignat 2
41^{75} &= 41^{2\ntimes 37 + 1}\\
        &= 41^{2 \ntimes 37} 41\\
        &= (41^2)^{37} 41\\
        &\cong  1^{37} 41       &&\pmod 3\\
        &\cong  41              &&\pmod 3\\
        &\cong  2               &&\pmod 3.
\endalignat
$$
Então $41^{75} \bmod 3 = 2$.

\endexercise

\endsection
%%}}}

%%{{{ Exponentiation 
\section Exponenciação.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\problem.
Prove numa linha o~\ref{odd_to_any_power_is_odd}:
$$
\text{\sl para todo $n\in\nats$ e todo impar $k\in\ints$, $k^n$ é impar}.
$$

\endproblem

\problem.
(Generalização do~\ref{odd_to_any_power_is_odd}.)
Seja $a\in\ints$ e $m\in\nats$.
Prove numa linha que para todo $n\in\nats$, existe $b\in\ints$ tal que $(am + 1)^n = bm + 1$.

\endproblem

\problem.
Prove que para todo $m\in\nats$, o produto de $m$ consecutivos inteiros é divisível por $m!$.

\endproblem

\ignore{

\problem.
Prove que
$$
\tot {mn}
=
{\tot m \tot n}
\frac
d
{\tot d}
,\qquad\text{onde $d={\gcd m n}$}.
$$
Note quantas e quais das propriedades que já provamos são casos especiais dessa!

\endproblem

\problem.
Sejam $p,q$ primos com $p\neq q$.  Prove que
$$
p^{q-1} + q^{p-1} \cong 1 \pmod {pq}.
$$

\hint
O que seria o $p^{q-1} + q^{p-1}$ módulo $p$?  E módulo $q$?

\hint
China.

\endproblem

\problem.
Ache uma generalização do problema anterior,
aplicável para inteiros $a,b$ com $\gcd a b = 1$:

\hint Nesse caso \emph{não} temos
$$
a^{b-1} + b^{a-1} \cong 1 \pmod {ab}.
$$

\hint $p-1 = \tot p$ para qualquer primo $p$.

\hint
Prove que:
$$
a^{\tot b} + b^{\tot a} \cong 1 \pmod {ab}.
$$

\endproblem

}% ignore

\endproblems
%%}}}

%%{{{ Further reading 
\further.

Veja o~\cite[\S1.9]{babybm}.

\cite{disquisitiones}.

\cite{nivennumbers},
\cite{hardywright}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Cryptography 
\chapter Criptografía.

%%{{{ The idea of cryptography 
\section A idéia da criptografia.

\endsection
%%}}}

%%{{{ Public-key cryptography 
\section Criptografia ``public-key''.

\endsection
%%}}}

%%{{{ RSA encryption and decryption 
\section RSA criptografia e descriptografia.

\theorem.
Sejam $e, M\in\ints$ com $\gcd e {\tot M} = 1$,
e seja $d$ um inverso de $e$ modulo $\tot M$: $ed \cong 1 \pmod {\tot M}$.
Para cada $m$ com $\gcd m M = 1$,
$$
\paren{m^e}^d \cong m \pmod M.
$$
\proof.
Observe primeiramente que:
$$
\alignat 2
ed \cong 1 \pmod {\tot M}
&\iff \tot M \divides ed - 1                    \qqby{\ref{congruence}}\\
&\iff \lexists {k\in\ints} {k\tot M = ed - 1}.  \qqby{\ref{divides}}
\endalignat
$$
Seja $k\in\ints$ então um tal $k$, e agora resolvendo por $ed$:
$$
ed = k\tot M + 1.
\eqdef{rsa_ed_equality}
$$
Calculamos:
$$
\alignat 2
\paren{m^e}^d
&= m^{ed}                   \\
&= m^{k\tot M + 1}          \qqby{por~\eqref{rsa_ed_equality}}\\
&= m^{k\tot M} m            \qqby{def.~de exponenciação}\\
&= \paren{m^k}^{\tot M} m   \\
&\cong m  \pmod M,          \qqby{por teorema de Euler~\refn{euler_congruence_theorem}}
\endalignat
$$
onde no último pásso precisamos a hipótese que $m$ e $\tot M$ são coprimos
e logo, $m^k$ e $\tot M$ também são: $\gcd m {\tot M} = \gcd {m^k} {\tot M} = 1$.
\qed

\exercise.
O que acontece se $m$ e $\tot M$ não são coprimos?

\endexercise

\endsection
%%}}}

%%{{{ Digital signatures 
\section Assinaturas digitais.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Enumerative combinatorics 
\chapter Combinatória enumerativa.

%%{{{ Counting principles 
\section Princípios de contagem.

\note Informalmente.
Queremos contar todas as maneiras possíveis para algo acontecer,
certas configurações, certos objetos ser escolhidos, ou ordenados, etc.
Baseamos nossas idéia em dois princípios de contagem:
da \emph{adição} e da \emph{multiplicação}.
\endgraf
{O princípio da adição, informalmente:}
Se podemos grupar todos esses objetos em grupos \emph{distintos},
tais que cada objeto pertence em \emph{exatamente um} grupo,
o número total dos objetos é igual o somatório dos tamanhos dos grupos.
\endgraf
{O princípio da multiplicação, informalmente:}
Se cada configuração pode ser descrita completamente em $n$ passos,
onde para o primeiro passo temos $a_1$ opções,
para o segundo passo temos $a_2$ opções, etc., e
\emph{em cada passo a quantidade das opções disponíveis
não depende nas escolhas anteriores},
então existem em total $a_1a_2\dotsb a_n$ configurações possíveis.

\principle da adição, formalmente.
\tdefined{princípio}[da adição]
Seja $A$ conjunto finito, e $A_1,\dotsc,A_n$ subconjuntos dele tais que cada elemento $a\in A$, pertence em \emph{exatamente} um dos $A_i$.
Logo,
$$
|A| = \sum_{i=1}^n |A_i|.
$$

\principle da multiplicação.
\tdefined{princípio}[da multiplicação]
Sejam $A_1,\dotsc,A_n$ conjuntos finitos.
Logo
$$
|A_1\times\dotsb\times A_n| = |A_1|\dotsb|A_n|.
$$

\example.
De quantas maneiras podemos escrever um string de tamanho $3$\dots
\item{(i)} Usando o alfabeto
$$
\set{\txt A, \txt B, \txt C, \dotsc, \txt X, \txt Y, \txt Z}?
$$
\item{(ii)} Usando o mesmo alfabeto, mas proibindo o mesmo caractere se repitir no string?

\solution
Consideramos a formação de cada string em passos, caractere a caractere.
Temos 3 posições para colocar os caracteres:
$
\underline{\phantom{\txt Z}}
\;
\underline{\phantom{\txt Z}}
\;
\underline{\phantom{\txt Z}}
\;
$.
\endgraf
Para a questão (i), temos:
$26$ maneiras para escolher o primeiro caractere,
$26$ para o segundo, e
$26$ para o último:
$$
\underbrace{
\underline{\phantom{\txt Z}}
}_{26}
\;
\underbrace{
\underline{\phantom{\txt Z}}
}_{26}
\;
\underbrace{
\underline{\phantom{\txt Z}}
}_{26}
\;.
$$
A escolha em cada passo não é afeitada por as escolhas dos passos anteriores.
Logo, pelo princípio da multiplicação tem
$$
26\ntimes 26\ntimes 26 = 26^3
$$
strings possíveis.
\endgraf
Para a questão (ii), temos:
$26$ maneiras para escolher o primeiro caractere,
$25$ para o segundo (todos menos aquele que escolhemos no passo anterior), e
$24$ para o último (similarmente):
$$
\underbrace{
\underline{\phantom{\txt Z}}
}_{26}
\;
\underbrace{
\underline{\phantom{\txt Z}}
}_{25}
\;
\underbrace{
\underline{\phantom{\txt Z}}
}_{24}
\;.
$$
Agora a escolha em cada passo realmente \emph{é afeitada} por as escolhas
dos passos anteriores!
Por exemplo, se no primeiro passo escolher o caractere $\txt C$, para
o segundo passo as opções incluem o caractere $\txt A$; 
mas se no primeiro passo escolher o caractere $\txt A$, as opções para o segundo
mudam: não temos essa opção mais.
\emph{Mesmo assim, podemos usar o princípio da multiplicação!}
Por que?
As escolhas dos passos anteriores afeitam \emph{quais} são as escolhas do passo atual,
mas não afeitam \emph{quantas} elas são!
Por isso, chegamos no resultado aplicando mais uma vez o princípio da multiplicação:
temos
$$
26\ntimes 25\ntimes 24
$$
maneiras possíveis.

\endexample

\exercise.
Temos $4$ presentes e queremos dar para $3$ crianças tal que cada criança vai
receber apenas um presente.
\item{(i)} De quantas maneiras podemos disribuir os presentes para as crianças?
\item{(ii)} O que muda se as crianças são $4$?  Explique.

\endexercise

\exercise.
De quantas maneiras podemos escrever strings de tamanho $2$ usando o alfabeto
$$
\set{\txt A, \txt B, \txt C, \txt D},
$$
tais que as letras aparecem em ordem que concorda com a do alfabeto?
Por exemplo os string $\txt A \txt C$, $\txt B \txt B$, e $\txt C \txt D$ são aceitáveis,
mas os $\txt D \txt C$ e $\txt B \txt A$, não.

\hint
Cuidado: aqui a \emph{quantidade} das opções da segunda escolha, depende sim na escolha
anterior!

\hint
Separa os strings possíveis em colecções e conta os strings de cada colecção separadamente,
somando no final (princípio de adição) para achar o resultado.

\endexercise

\endsection
%%}}}

%%{{{ Permutations and combinations 
\section Permutações e combinações.
\label{permutations_and_combinations}%

\question. De quantas maneiras podemos escolher $r$ objetos de $n$?

Essa questão é bastante ambígua;
por exemplo:
Os $n$ objetos são todos distintos?
Podemos repitir o mesmo objeto na nossa escolha?

\definition.
\label{comb_perm_arrange}%
Usamos os símbolos:
$$
\align
\arrange n &:\quad\text{o número de permutações totais de $n$ objetos}\\
\perm n r  &:\quad\text{o número de $r$-permutações de $n$ objetos}\\
\comb n r  &:\quad\text{o número de $r$-combinações de $n$ objetos}
\endalign
$$
Onde entendemos que:
\beginol
\li os $n$ objetos são distíntos;
\li não podemos os repetir.
\endol

\proposition Permutações totais (arranjos).
\label{total_permutations}
\tdefined{permutação}[total]
\sdefined {\arrange {\holed n}} {permutações totais de \holed n objetos}
\iisee{arranjo}{permutação total}
$$
\arrange n = {n!}.
$$

\proposition Permutações.
\tdefined{permutação}
\sdefined {\perm {\holed n} {\holed r}} {permutações de tamanho \holed r, de \holed n objetos}
$$
\perm n r = \frac {n!} {(n-r)!}.
$$

\proposition Combinações.
\tdefined{combinação}
\sdefined {\comb {\holed n} {\holed r}} {combinações de tamanho \holed r, de \holed n objetos}
$$
\comb n r = \frac {n!} {(n-r)!\stimes r!}.
$$

\example.
10 amigos têm vontade viajar com um carro de 5 vagas.
De quantas maneiras diferentes 5 deles podem entrar no carro?
Considere que o que diferencia mesmo a configuração são apenas a posição
do motorista e do copiloto.

\solution
Vamos ver dois jeitos diferentes para contar essas configurações:
\endgraf
\proofstyle{\indent Jeito 1:}
Escrevendo
$$
\comb {10} 1
\ntimes
\comb 9 1
\ntimes
\comb 8 3
$$
já é meio auto-explicativo: formamos cada configuração em passos:
{(i)}      escolher o motorista;
{(ii)}     escolher o copiloto;
{(iii)}    escolher os passangeiros de trás.
\endgraf
\proofstyle{\indent Jeito 2:}
Outra método para formar cada configuração seria:
{(i)}      escolher os 5 que vão entrar no carro;
{(ii)}     escolher qual vai ser o motorista;
{(iii)}    escolher qual vai ser o copiloto.
pensando assim chegamos no cálculo
$$
\underbrace{\comb {10} 5}_{\text{(i)}}
\ntimes
\underbrace{\comb 5 1}_{\text{(ii)}}
\ntimes
\underbrace{\comb 4 1}_{\text{(iii)}}.
$$
\endgraf
Olhando para os dois cálculos
$$
\comb {10} 1 \ntimes \comb 9 1 \ntimes \comb 8 3
\askeq
\comb {10} 5 \ntimes \comb 5 1 \ntimes \comb 4 1
$$
não é óbvio que seus valores são iguais.  Calculamos
$$
\alignat2
\comb {10} 1 \ntimes \comb 9 1 \ntimes \comb 8 3
&= 10 \ntimes 9 \ntimes \frac {8!} {5!\stimes3!}
&&= \frac {10!} {5!\stimes3!}
\\
\comb {10} 5 \ntimes \comb 5 1 \ntimes \comb 4 1
&= \frac {10!} {5!\stimes 5!} \ntimes 5 \ntimes 4
&&= \frac {10!} {5!\stimes 3!}
\endalignat
$$
e respondemos (felizmente) que em total temos
$$
\frac {10!} {5!\stimes3!}
= \frac{10 \ntimes 9 \ntimes 8\ntimes7\ntimes6} { 3! }
= 10 \ntimes 9 \ntimes 8\ntimes7
= 5040
$$
configurações diferentes.
\endexample

\endsection
%%}}}

%%{{{ Permutations in a circle 
\section Permutações cíclicas.

\example.
\label{circle_dance_of_8}
$8$ pessoas querem dançar uma dança em qual
todos precisam formar um ciclo pegando as mãos
(e olhando para o interior do ciclo).
Em quantas configurações diferentes essa dança pode começar?

\solution
Vamos resolver esse problema seguindo duas idéias bem diferentes:
\endgraf
\proofstyle{\indent Idéia~1.}
Consideramos primeiro a questão:
``\emph{de quantas maneiras podemos permutar as $8$ pessoas numa ordem?}''
Respondemos $8!$, o número das permutações totais de $8$ objetos
(sabendo que hipercontamos para o problema original).
Mas podemos calcular que cada resposta do problema original,
corresponde em exatamente $8$ respostas do problema novo
(uma para cada ``circular shift'').
Então basta só dividir a ``hiperconta'' por $8$, e chegamos
no resultado final: $8! / 8$, ou seja, $7!$.
\endgraf
\proofstyle{\indent Idéia~2.}
\emph{Fixamos uma pessoa como ``determinante'' da configuração;}
a idéia sendo que para comparar duas configurações nos vamos
começar com o determinante, e depois comparar em ordem fixa
o resto da configuração
(por exemplo indo cada vez de uma pessoa
para quem tá no lado direito dela).
Assim, para cada permutação total das 7 outras pessoas,
temos uma permutação circular das 8 e vice-versa,
ou seja, a resposta final é $7!$.
\endexample

\midinsert
\hfil
\tikzpicture[scale=0.8]%%{{{
\draw (0,0) circle (2cm);
\foreach \t in {0,45,90,135,180,225,270,315}
    \node[circle,fill=white] (a\t) at (\t:2cm) {$\phantom{p_0}$};
\node[circle,fill=white] at (a0)   {$p_0$};
\node[circle,fill=white] at (a45)  {$p_1$};
\node[circle,fill=white] at (a90)  {$p_2$};
\node[circle,fill=white] at (a135) {$p_3$};
\node[circle,fill=white] at (a180) {$p_4$};
\node[circle,fill=white] at (a225) {$p_5$};
\node[circle,fill=white] at (a270) {$p_6$};
\node[circle,fill=white] at (a315) {$p_7$};
\endtikzpicture
%%}}}
\hfil
\tikzpicture[scale=0.8]%%{{{
\draw (0,0) circle (2cm);
\foreach \t in {0,45,90,135,180,225,270,315}
    \node[circle,fill=white] (a\t) at (\t:2cm) {$\phantom{a_0}$};
\node[circle,fill=white] at (a315)  {$p_0$};
\node[circle,fill=white] at (a0)    {$p_1$};
\node[circle,fill=white] at (a45)   {$p_2$};
\node[circle,fill=white] at (a90)   {$p_3$};
\node[circle,fill=white] at (a135)  {$p_4$};
\node[circle,fill=white] at (a180)  {$p_5$};
\node[circle,fill=white] at (a225)  {$p_6$};
\node[circle,fill=white] at (a270)  {$p_7$};
\endtikzpicture
%%}}}
\hfil
\endgraf\centerline{Uma configuração do~\refn{circle_dance_of_8} representada em dois jeitos diferentes no papel.}
\endinsert

Generalizando concluimos que:

\proposition.
As configurações circulares diferentes de $n$ objetos, $n>0$ são
$$
(n-1)!.
$$

\exercise.
O que mudará na contagem do~\ref{circle_dance_of_8},
se cada dançador pode olhar ou para o interior ou para o exterior do círculo?

\hint
Começando com a mesma resposta ($7!$) do~\ref{circle_dance_of_8},
claramente nos hipocontamos---mas quanto?

\hint
Considere uma configuração do~\ref{circle_dance_of_8}.
Com quantas configurações do problema atual ela corresponde?

\endexercise

\exercise.
O que mudará na contagem do~\ref{circle_dance_of_8},
se temos $4$ mulheres e $4$ homens e as regras da dança
mandam alternar os sexos na configuração?

\hint
Construa cada configuração em passos.

\hint
Primeiramente, esqueça os homens (ou as mulheres)
e coloca as $4$ mulheres (ou os $4$ homens)
num ciclo.
De quantas maneiras pode escolher o resto para
entrar no círculo?

\endexercise

\exercise.
Temos $8$
miçangas
diferentes, e queremos pôr todas
numa
corrente
para criar uma pulseira.
Quantas maneiras diferentes temos para o criar?

\hint
Se tu achar o problema igual com o~\ref{circle_dance_of_8},
tu hipercontarás\dots Quanto?

\hint
Veja a figura.
Pode explicar por que as três representações
correspondem na mesma configuração?
\topinsert
\centerline{
\tikzpicture[scale=0.8]%%{{{
\draw (0,0) circle (2cm);
\foreach \t in {0,45,90,135,180,225,270,315}
    \node[circle,fill=white] (a\t) at (\t:2cm) {$\phantom{a_0}$};
\node[circle,fill=red!33]       at (a0)   {$a_0$};
\node[circle,fill=green!33]     at (a45)  {$a_1$};
\node[circle,fill=blue!33]      at (a90)  {$a_2$};
\node[circle,fill=cyan!33]      at (a135) {$a_3$};
\node[circle,fill=magenta!33]   at (a180) {$a_4$};
\node[circle,fill=yellow!33]    at (a225) {$a_5$};
\node[circle,fill=orange!33]    at (a270) {$a_6$};
\node[circle,fill=brown!33]     at (a315) {$a_7$};
\endtikzpicture
%%}}}
\hfil
\tikzpicture[scale=0.8]%%{{{
\draw (0,0) circle (2cm);
\foreach \t in {0,45,90,135,180,225,270,315}
    \node[circle,fill=white] (a\t) at (\t:2cm) {$\phantom{a_0}$};
\node[circle,fill=red!33]       at (a315)  {$a_0$};
\node[circle,fill=green!33]     at (a0)    {$a_1$};
\node[circle,fill=blue!33]      at (a45)   {$a_2$};
\node[circle,fill=cyan!33]      at (a90)   {$a_3$};
\node[circle,fill=magenta!33]   at (a135)  {$a_4$};
\node[circle,fill=yellow!33]    at (a180)  {$a_5$};
\node[circle,fill=orange!33]    at (a225)  {$a_6$};
\node[circle,fill=brown!33]     at (a270)  {$a_7$};
\endtikzpicture
%%}}}
\hfil
\tikzpicture[scale=0.8]%%{{{
\draw (0,0) circle (2cm);
\foreach \t in {0,45,90,135,180,225,270,315}
    \node[circle,fill=white] (a\t) at (\t:2cm) {$\phantom{a_0}$};
\node[circle,fill=red!33]       at (a315)  {$a_0$};
\node[circle,fill=green!33]     at (a270)  {$a_1$};
\node[circle,fill=blue!33]      at (a225)  {$a_2$};
\node[circle,fill=cyan!33]      at (a180)  {$a_3$};
\node[circle,fill=magenta!33]   at (a135)  {$a_4$};
\node[circle,fill=yellow!33]    at (a90)   {$a_5$};
\node[circle,fill=orange!33]    at (a45)   {$a_6$};
\node[circle,fill=brown!33]     at (a0)    {$a_7$};
\endtikzpicture
%%}}}
}
\botcaption{}
\emph{Apenas uma} das configurações da pulseira, representada em três desenhos.
\endcaption
\endinsert

\endexercise

\endsection
%%}}}

%%{{{ Together or separated 
\section Juntos ou separados.

\example.
\label{dinner_of_8_with_couple}
Suponha que $8$ pessoas $A,B,C,D,E,F,G,H$ querem sentar num bar
mas $C$ e $D$ querem sentar juntos.
De quantas maneiras isso pode acontecer?

\solution
\emph{Vamos imaginar que $C$ e $D$ são uma pessoa, chamada $CD$.}
Nos perguntamos de quantas maneiras as 7 pessoas $A,B,CD,E,F,G,H$ podem sentar
numa mesa de bar com $7$ banquinhos.
A resposta é os permutações totais de tamanho 7, ou seja, $7!$.
Mas para cada configuração desse problema,
correspondem \emph{duas} configurações do problema original, porque os
$C$ e $D$ podem sentar em duas ordens diferentes juntos.
A resposta final:
$7! \ntimes 2$.
\endexample

\exercise.
Suponha que 8 pessoas $A,B,C,D,E,F,G,H$ querem jantar numa mesa de bar.
Em quantas configurações diferentes eles podem sentar se\dots:
\item{(1)} os $C$ e $D$ e $E$ querem sentar juntos;
\item{(2)} os $F$ e $G$ não podem sentar juntos;
\item{(3)} as duas restrições (1) e (2).

\hint
\item{(1)} Como no \ref{dinner_of_8_with_couple},
           considere o problema onde $C$, $D$, e $E$ são uma pessoa só.
\item{(2)} Conte o complementar e subtraia do total sem restrição;
\item{(3)} Conte as configurações em quais $C$, $D$, e $E$ sentam juntos e subtraia
           as configurações onde, alem disso, $F$ e $G$ também sentam juntos.

\solution
(1) Como no \ref{dinner_of_8_with_couple}, traduzimos o problema para um onde
$C$, $D$, e $E$, são uma pessoa---vamos a chamar de $CDE$---e as
$6$ pessoas $A,B,CDE,F,G,H$ querem jantar numa mesa de bar com 6 banquinhos.
Cada solução desse problema corresponde em tantas configurações quantas as $3$ pessoas
$C$, $D$, $E$ podem sentar numa ordem, ou seja $\arrange 3$ configurações.
A resposta final:
$$
\arrange 6 \ntimes \arrange 3 = 6!\stimes3! = 6!\stimes 6
$$
\endgraf
(2) Contamos o complementar:
todas as maneiras onde $F$ e $G$ sentam juntos ($7!\ntimes 2$),
e o tiramos de todas as maneiras sem restrição ($8!$):
$$
\arrange 8 - \arrange 7 \ntimes \arrange 2
= 8! - 7!\ntimes 2! = 7!(8 - 2)
= 7!\stimes 6
$$
(3) Já achamos quantas maneiras tem onde $C$, $D$, e $E$ sentam juntos: $6!\stimes6$.
Disso, precisamos subtrair as configurações onde $F$ e $G$ também sentam juntos:
para satisfazer as duas restrições, consideramos as $5$ ``pessoas''
$A,B,CDE,FG,H$, quais podem sentar numa mesa de bar de tamanho $5$ de
$$
\arrange 5 \stimes \arrange 3 \stimes \arrange 2
= 5! \stimes 3! \stimes 2!
= 5! \stimes 6 \stimes 2
= 6! \stimes 2
$$
maneiras.
A resposta final então é
$$
6!\stimes6 - 6!\stimes2 = 6!(6-2) = 6! \stimes 4.
$$

\endexercise

Generalizando:

\proposition.
O número das permutações totais de $m$ objetos distintos com a restrição que
certos $c$ deles tem que estar consecutivos é
$$
(m-c+1)! \stimes c!.
$$

\endsection
%%}}}

%%{{{ Permutations of things not all distinct 
\section Permutações de objetos não todos distintos.

\question.
De quantas maneiras podemos permutar $n$ objetos se
eles não são todos distíntos?

\example.
\label{pessimissimo}
Conte todas as palavras feitas por permutações das 12 letras da palavra
$$
\txt{PESSIMISSIMO}.
$$

\solution
Vamos contar em dois jeitos diferentes:
\endgraf
\proofstyle{Idéia 1:}
Construimos cada palavra possível ``em passos'',
usando o princípio da multplicação para achar o número total.
$$
\alignat 2
\text{Começamos com 12 espaços:}
\qquad&
\underline{\phantom {\txt M}} \ 
\underline{\phantom {\txt I}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt I}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt I}} \ 
\underline{\phantom {\txt P}} \ 
\underline{\phantom {\txt O}} \ 
\underline{\phantom {\txt E}} \ 
\underline{\phantom {\txt M}}
\\
\text{escolhemos onde colocar o ${\txt P}$:}
\qquad&
\underline{\phantom {\txt M}} \ 
\underline{\phantom {\txt I}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt I}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt I}} \ 
          {         {\txt P}} \ 
\underline{\phantom {\txt O}} \ 
\underline{\phantom {\txt E}} \ 
\underline{\phantom {\txt M}}
&\qquad&
\text{tivemos $\comb {12} 1$ opções;}
\\
\text{depois o ${\txt E}$:}
\qquad&
\underline{\phantom {\txt M}} \ 
\underline{\phantom {\txt I}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt I}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt S}} \ 
\underline{\phantom {\txt I}} \ 
          {         {\txt P}} \ 
\underline{\phantom {\txt O}} \ 
          {         {\txt E}} \ 
\underline{\phantom {\txt M}}
&\qquad&
\text{tivemos $\comb {11} 1$ opções;}
\\
\text{depois os 4 ${\txt S}$:}
\qquad&
\underline{\phantom {\txt M}} \ 
\underline{\phantom {\txt I}} \ 
          {         {\txt S}} \ 
          {         {\txt S}} \ 
\underline{\phantom {\txt I}} \ 
          {         {\txt S}} \ 
          {         {\txt S}} \ 
\underline{\phantom {\txt I}} \ 
          {         {\txt P}} \ 
\underline{\phantom {\txt O}} \ 
          {         {\txt E}} \ 
\underline{\phantom {\txt M}}
&\qquad&
\text{tivemos $\comb {10} 4$ opções;}
\\
\text{depois os 3 ${\txt I}$:}
\qquad&
\underline{\phantom {\txt M}} \ 
          {         {\txt I}} \ 
          {         {\txt S}} \ 
          {         {\txt S}} \ 
          {         {\txt I}} \ 
          {         {\txt S}} \ 
          {         {\txt S}} \ 
          {         {\txt I}} \ 
          {         {\txt P}} \ 
\underline{\phantom {\txt O}} \ 
          {         {\txt E}} \ 
\underline{\phantom {\txt M}}
&\qquad&
\text{tivemos $\comb 6 3$ opções;}
\\
\text{depois os 2 ${\txt M}$:}
\qquad&
          {         {\txt M}} \ 
          {         {\txt I}} \ 
          {         {\txt S}} \ 
          {         {\txt S}} \ 
          {         {\txt I}} \ 
          {         {\txt S}} \ 
          {         {\txt S}} \ 
          {         {\txt I}} \ 
          {         {\txt P}} \ 
\underline{\phantom {\txt O}} \ 
          {         {\txt E}} \ 
          {         {\txt M}}
&\qquad&
\text{tivemos $\comb 3 2$ opções;}
\\
\text{e finalmente o ${\txt O}$:}
\qquad&
          {         {\txt M}} \ 
          {         {\txt I}} \ 
          {         {\txt S}} \ 
          {         {\txt S}} \ 
          {         {\txt I}} \ 
          {         {\txt S}} \ 
          {         {\txt S}} \ 
          {         {\txt I}} \ 
          {         {\txt P}} \ 
          {         {\txt O}} \ 
          {         {\txt E}} \ 
          {         {\txt M}}
&\qquad&
\text{tivemos $\comb 1 1$ opção.}
\endalignat
$$
Pelo princípio da multiplicação, a resposta é o produto
$$
\align
\underbrace{\comb {12} 1}_{\dsize {\txt P}}
\underbrace{\comb {11} 1}_{\dsize {\txt E}}
\underbrace{\comb {10} 4}_{\dsize4{\txt S}}
\underbrace{\comb {6}  3}_{\dsize3{\txt I}}
\underbrace{\comb {3}  2}_{\dsize2{\txt M}}
\underbrace{\comb {1}  1}_{\dsize {\txt O}}
&=
\frac
{12!}
{\cancel{11!}\stimes 1!}
\frac
{\cancel{11!}}
{\cancel{10!}\stimes 1!}
\frac
{\cancel{10!}}
{\cancel{6!}\stimes 4!}
\frac
{\cancel{6!}}
{\cancel{3!}\stimes 3!}
\frac
{\cancel{3!}}
{\cancel{1!}\stimes 2!}
\frac
{\cancel{1!}}
{0!\stimes 1!}\\
&=
\frac
{12!}
{1!
\stimes 1!
\stimes 4!
\stimes 3!
\stimes 2!
\stimes 1!
}
=
\frac
{12!}
{
4!
\stimes 3!
\stimes 2!
}.
\endalign
$$
\endgraf
\proofstyle{Idéia 2:}
Contamos as maneiras se todas as letras fossem distintas,
por exemplo marcando cada letra com índices:
$$
{\txt P}_1\ 
{\txt E}_1\ 
{\txt S}_1\ 
{\txt S}_2\ 
{\txt I}_1\ 
{\txt M}_1\ 
{\txt I}_2\ 
{\txt S}_3\ 
{\txt S}_4\ 
{\txt I}_3\ 
{\txt M}_2\ 
{\txt O}_1\,.
$$
Sabemos que são $12!$ e que
assim temos \emph{hipercontado} para nosso problema.
Por exemplo, a palavra 
$
{\txt M}
{\txt I}
{\txt S}
{\txt S}
{\txt I}
{\txt S}
{\txt S}
{\txt I}
{\txt P}
{\txt O}
{\txt E}
{\txt M}
$
corresponde em várias palavras do problema novo;
escrevemos três delas aqui como exemplos:
$$
{\txt M}\ 
{\txt I}\ 
{\txt S}\ 
{\txt S}\ 
{\txt I}\ 
{\txt S}\ 
{\txt S}\ 
{\txt I}\ 
{\txt P}\ 
{\txt O}\ 
{\txt E}\ 
{\txt M}
\ 
\transto
\ 
\left\{
\gathered
{\txt M}_1\ 
{\txt I}_1\ 
{\txt S}_1\ 
{\txt S}_2\ 
{\txt I}_2\ 
{\txt S}_3\ 
{\txt S}_4\ 
{\txt I}_3\ 
{\txt P}_1\ 
{\txt O}_1\ 
{\txt E}_1\ 
{\txt M}_2
\\
{\txt M}_2\ 
{\txt I}_1\ 
{\txt S}_1\ 
{\txt S}_2\ 
{\txt I}_2\ 
{\txt S}_3\ 
{\txt S}_4\ 
{\txt I}_3\ 
{\txt P}_1\ 
{\txt O}_1\ 
{\txt E}_1\ 
{\txt M}_1
\\
{\txt M}_2\ 
{\txt I}_1\ 
{\txt S}_4\ 
{\txt S}_3\ 
{\txt I}_2\ 
{\txt S}_2\ 
{\txt S}_1\ 
{\txt I}_3\ 
{\txt P}_1\ 
{\txt O}_1\ 
{\txt E}_1\ 
{\txt M}_1
\\
\vdots
\endgathered
\quad\qquad
\right\}
\ \text{\dots quantas?}
$$
Mas é fácil calcular quanto hipercontamos:
\emph{cada} palavra do problema original corresponde em exatamente tantas palavras
quantas as maneiras de permutar cada grupo de letras ``subindicadas'' entre si,
ou seja:
$$
\underbrace{1!}_{{\txt P}} \ntimes
\underbrace{1!}_{{\txt E}} \ntimes
\underbrace{4!}_{{\txt S}} \ntimes
\underbrace{3!}_{{\txt I}} \ntimes
\underbrace{2!}_{{\txt M}} \ntimes
\underbrace{1!}_{{\txt O}}
$$
maneiras.
Para responder então, basta dividir o número da ``hipercontagem'' por esse:
$$
\frac
{12!}
{4!\stimes 3!\stimes 2!}.
$$
\moveqedup
\endexample

\exercise.
Escolhendo outra ordem de colocar as letras
na \proofstyle{Idéia 1} do~\ref{pessimissimo}
nossas opções em cada passo seriam diferentes.
Explique porque podemos usar o princípio da multiplicação mesmo assim.

\hint
Presta atenção na frase
``\emph{em cada passo a quantidade das opções disponíveis
não depende nas escolhas anteriores}''.

\solution
O imporante é que em cada passo, qual das nossas disponíveis opções
será escolhida, não vai afeitar a quantidade das nossas opções no passo seguinte.
Isso é realmente valido nesse caso.
Se escolher colocar as letras em outra ordem, por exemplo a
$
{\txt S},
{\txt E},
{\txt I},
{\txt P},
{\txt O},
{\txt M}
$, teriamos quantidades diferentes para cada passo sim,
\emph{mas}\/:
cada uma das nossas escolhas, não afeitaria a quantidade das escolhas próximas.
Com essa ordem, chegamos no mesmo resultado (com um cálculo que de longe aparece diferente):
$$
\align
\underbrace{\comb {12} 4}_{\dsize4{\txt S}}
\underbrace{\comb {8}  1}_{\dsize {\txt E}}
\underbrace{\comb {7}  3}_{\dsize3{\txt I}}
\underbrace{\comb {4}  1}_{\dsize {\txt P}}
\underbrace{\comb {3}  1}_{\dsize {\txt O}}
\underbrace{\comb {2}  2}_{\dsize2{\txt M}}
&=
\frac
{12!}
{\cancel{8!}\stimes 4!}
\frac
{\cancel{8!}}
{\cancel{7!}\stimes 1!}
\frac
{\cancel{7!}}
{\cancel{4!}\stimes 3!}
\frac
{\cancel{4!}}
{\cancel{3!}\stimes 1!}
\frac
{\cancel{3!}}
{\cancel{2!}\stimes 1!}
\frac
{\cancel{2!}}
{0!\stimes 2!}\\
\vphantom{
\underbrace{\comb {12} 4}_{\dsize4{\txt S}}
\underbrace{\comb {8}  1}_{\dsize {\txt E}}
\underbrace{\comb {7}  3}_{\dsize3{\txt I}}
\underbrace{\comb {4}  1}_{\dsize {\txt P}}
\underbrace{\comb {3}  1}_{\dsize {\txt O}}
\underbrace{\comb {2}  2}_{\dsize2{\txt M}}
}
&=
\frac
{12!}
{4!
\stimes 1!
\stimes 3!
\stimes 1!
\stimes 1!
\stimes 2!
}\\
&=
\frac
{12!}
{
4!
\stimes 3!
\stimes 2!
}.
\endalign
$$

\endexercise

\endsection
%%}}}

%%{{{ Binomial coefficients 
\section Binomial e seus coeficientes.

\theorem.
\tdefined{teorema}[binomial]
\iisee{binomial}[teorema]{teorema binomial}
\label{binomial_theorem}
Sejam $x,y\in\ints$ e $n\in\nats$.
$$
\align
(x+y)^n
&= \binom n 0 x^n + \binom n 1 x^{n-1}y + \dotsb + \binom n {n-1} xy^{n-1} + \binom n n y^n\\
&= \sum_{i=0}^n \binom n i x^{n-i}y^i.
\endalign
$$
\sketch.
Queremos achar quantas vezes o termo $x^{n-r}y^r$ aparece na expansão do binomial.
Escrevendo
$$
(x+y)^n = \underbrace{(x+y)(x+y)\dotsb(x+y)}_{\text{$n$ vezes}}
$$
observamos que para cada das $\comb n r$ maneiras de escolher $r$ dos termos em cima,
corresponde um termo $x^{n-r}y^r$:
``escolhe quais dos termos do produto vão oferecer seu $y$
(o resto dos termos oferecerá seus $x$'s)''.
Isso justifica os coeficientes $\binom n r$.
Por exemplo, para $n=7$ e $r=4$, a escolha
$$
(x+y)^7
=
(x+y)
\underbrace{(x+y)}_{\text{``$y$''}}\,
(x+y)
\underbrace{(x+y)}_{\text{``$y$''}}
\underbrace{(x+y)}_{\text{``$y$''}}\,
(x+y)
\underbrace{(x+y)}_{\text{``$y$''}}
$$
corresponde no produto
$xyxyyxy = x^3y^4$, e cada diferente escolha das $\binom 7 4$
correspondará com uma maneira diferente para formar o $x^3y^4$.
\qes

\endsection
%%}}}

%%{{{ Number of subsets 
\section Número de subconjuntos. 

\question.
Quantos subconjuntos dum conjunto finito existem?

\note Idéia 1.
\label{subset_count_using_strings}
Começamos com um exemplo de um conjunto $A$ de tamanho 6:
$$
A = \set{a, b, c, d, e, f}.
$$
Uns subconjuntos de $A$ são os:
$$
\set{a,d,e},
\qquad
\emptyset,
\qquad
\set{a},
\qquad
\set{b,c,e,f},
\qquad
A,
\qquad
\set{f},
\qquad
\dotsc
$$
Queremos contar todos os subconjuntos de $A$.
Vamos \emph{traduzir o problema} de contar os subconjuntos do $A$
para um problema que involve $n$-tuplas de dois símbolos ``0'' e ``1'', ``sim'' e ``não'', ``$\in$'' e ``$\notin$'', etc.
(Obviamente \emph{quais} são esses símbolos não afeita nada; o que importa é
que são dois símbolos distintos.)
Podemos associar agora cada dessas tuplas (ou strings) de tamanho $n$ para um
subconjunto de $A$, e vice-versa, chegando numa correspondência entre as duas
colecções de objetos.
Naturalmente associamos, por exemplo,
$$
\def\Y{1}
\def\N{0}
\underbrace{
\matrix
a  & b  & c  & d  & e  & f \\
\Y & \N & \N & \Y & \Y & \N\\
\N & \N & \N & \N & \N & \N\\
\Y & \N & \N & \N & \N & \N\\
\N & \Y & \Y & \N & \Y & \Y\\
\Y & \Y & \Y & \Y & \Y & \Y\\
\N & \N & \N & \N & \N & \Y\\
\vdots&
\vdots&
\vdots&
\vdots&
\vdots&
\vdots
\endmatrix
}_{\text{Strings de tamanho 6 do alfabeto $\set{\N,\Y}$}}
\quad\bitrans\quad
\underbrace{
\matrix
\format
\c\\
\\
\set{a,d,e}\\
\emptyset\\
\set{a}\\
\set{b,c,e,f}\\
A\\
\set{f}\\
\vdots
\endmatrix
}_{\text{Subconjuntos de $A$}}
$$
e verificamos que realmente cada configuração do problema original de subconjuntos
corresponde exatamente numa configuração do problema novo dos strings e vice-versa.
\endgraf
\emph{O que ganhamos?}
Sabemos como contar todos esses strings: são $2^6$.
Concluimos que os subconjuntos do $A$ são $2^6$ também.

Generalizando essa idéia chegamos no resultado:

\proposition.
\label{number_of_subsets_of_finite_set}
Seja $A$ conjunto finito.
$$
\card{\pset A} = 2^{\card A}.
$$

\note Idéia 2.
\label{subset_count_by_grouping}
Um outro jeito para contar todos os subconjuntos dum dado conjunto $A$, seria
os separar em grupos baseados no seu tamanho.
Assim, percebos que esses subconjuntos são naturalmente divididos em $n+1$ colecções:
subconjuntos com $0$ elementos, com $1$ elemento, \dots, com $n$ elementos.
\endgraf
\emph{O que ganhamos?}
Sabemos como contar os elementos de cada uma dessas colecções:
para formar um subconjunto de tamanho $r$, precisamos escolher $r$ dos $n$ elementos,
ou seja, existem $\comb n r$ subconjuntos de tamanho $r$.
Agora, pelo princípio da adição basta apenas somar:
são
$\sum_{i=0}^n \comb n i$.
\endgraf
\emph{Qual o problema?}
Comparando essa solução com a do item~\refn{subset_count_using_strings},
aqui temos a dificuldade de realmente calcular todos os $n$ números $\comb n i$
para os somar.
O~\ref{sum_of_all_binomial_coefficients} mostre que na verdade,
não é nada dificil calcular o somatório diretamente sem nem
calcular nenhum dos seus termos separadamente!

\proposition.
Seja $A$ conjunto finito.
$$
\card{\pset A} = \sum_{i=0}^n \comb n i,\qquad\text{onde $n = \card A$}.
$$


Combinando as duas proposições chegamos num resultado interessante:

\corollary.
Para todo $n\in\nats$,
$$
\sum_{i=0}^n \binom n i
= \binom n 0 + \binom n 1 + \dotsb + \binom n {n-1} + \binom n n
= 2^n
$$

\exercise.
\label{sum_of_all_binomial_coefficients}
Esqueça o corolário e prove que:
$$
\alignat 2
\sum_{i=0}^n \binom n i
&= \binom n 0 + \binom n 1 + \binom n 2 + \dotsb + \binom n n
&&= 2^n\\
\sum_{i=0}^n (-1)^i \binom n i
&=\binom n 0 - \binom n 1 + \binom n 2 - \dotsb + (-1)^n \binom n n
&&= 0
\endalignat
$$

\hint
Teorema binomial~\refn{binomial_theorem}.

\hint
Cada somatório é apenas um caso especial do teorema binomial.

\hint
Toma $x = y = 1$ no teorema para resolver o primeiro.

\hint
Toma $x = 1$ e $y = -1$ para resolver o segundo.

\endexercise

\endsection
%%}}}

%%{{{ Pascal's triangle 
\section O triângulo de Pascal.

\note As primeiras potências do binomial.
Calculamos:
$$
\align
(x+y)^0 &= 1\\
(x+y)^1 &= x   + y\\
(x+y)^2 &= x^2 + 2 xy    + y^2\\
(x+y)^3 &= x^3 + 3 x^2y  + 3 xy^2     + y^3\\
(x+y)^4 &= x^4 + 4 x^3y  + 6 x^2y^2   + 4xy^3      + y^4\\
(x+y)^5 &= x^5 + 5 x^4y  + 10 x^3y^2  + 10 x^2y^3  + 5 xy^4     + y^5\\
(x+y)^6 &= x^6 + 6 x^5y  + 15 x^4y^2  + 20 x^3y^3  + 15 x^2y^4  + 6 xy^5    + y^6\\
(x+y)^7 &= x^7 + 7 x^6y  + 21 x^5y^2  + 35 x^4y^3  + 35 x^3y^4  + 21 x^2y^5 + 7 xy^6    + y^7\\
(x+y)^8 &= x^8 + 8 x^7y  + 28 x^6y^2  + 56 x^5y^3  + 70 x^4y^4  + 56 x^3y^5 + 28 x^2y^6 + 8 xy^7 + y^8
\endalign
$$

\note O triângulo de Pascal.
\tdefined{triângulo}[de Pascal]
Tomando os coeficientes em cima criamos o triângulo seguinte,
conhecido como \emph{triângulo de \Pascal[triângulo]{}Pascal}:%
$$
\matrix
\format
\;\c\; &
\;\c\; &
\;\c\; &
\;\c\; &
\;\c\; &
\;\c\; &
\;\c\; &
\;\c\; &
\;\c\; &
\;\c\; &
\;\c\; \\
1\\
1&1\\
1&2&1\\
1&3&3&1\\
1&4&6&4&1\\
1&5&10&10&5&1\\
1&6&15&20&15&6&1\\
1&7&21&35&35&21&7&1\\
1&8&28&56&70&56&28&8&1\\
\;\vdots\;&
\phantom{00}&
\phantom{00}&
\phantom{00}&
\phantom{00}&
\phantom{00}&
\phantom{00}&
\phantom{00}&
\phantom{00}&
\ddots
\endmatrix
$$

Observando o triângulo, percebemos que com umas exceções---quais?---cada
número é igual à soma de dois números \emph{na linha em cima}:
aquele que fica na mesma posição, e aquele que fica na posição anterior.
(Consideramos os ``espaços'' no triangulo como se fossem $0$'s.)

\exercise.
Escreva essa relação formalmente.

\hint
O $\binom a b$ está na linha $a$, na posição $b$
(começando contar com 0).

\solution
Temos as equações:
$$
\left.
\aligned
\binom 0 0          &= 1\\
\binom 0 r          &= 0\\
\binom n r          &= \binom {n-1} r + \binom {n-1} {r-1}
\endaligned
\right\}
\quad
\text{equivalentemente}
\quad
\left\{
\aligned
\binom 0     0      &= 1\\
\binom 0     {r+1}  &= 0\\
\binom {n+1} {r+1}  &= \binom n {r+1} + \binom n r.
\endaligned
\right.
$$

\endexercise

\theorem.
\label{combinations_recursive_equation}
Para todos inteiros positivos $n$ e $r$ positivos temos:
$$
\comb n r           = \comb {n-1} r + \comb {n-1} {r-1}.
$$
\sketch.
Lembramos que $\comb n r$ é o número das maneiras que podemos
escolher $r$ de $n$ objetos.
Fixe um dos $n$ objetos e denota-lo por $s$,
para agir como ``separador'':
separamos as maneiras de escolher em dois grupos:
aquelas que escolhem (entre outros) o $s$ e aquelas que não o escolhem.
Contamos cada colecção separadamente e somamos (princípio da adição)
para achar o resultado:
$$
\comb n r
= \underbrace{\comb {n-1} r}_{\text{escolhas sem $s$}}
+ \underbrace{\comb {n-1} {r-1}}_{\text{escolhas com $s$}}.
$$
\qes

\exercise.
Prove o~\ref{combinations_recursive_equation} para todos os $n,r\in\nats$
com $0<r<n$, usando como definição do símbolo $\comb n r$ a
$$
\comb n r = \frac {n!} {(n-r)!\stimes r!}.
$$

\hint
Prove diretamente usando apenas a definição de fatorial.

\solution
Sejam $r,n\in\nats$ com $0<r<n$.
Calculamos:
$$
\alignat 4
\intertext{$\comb n r = \comb {n-1} r + \comb {n-1} {r-1}$}
&\iff\quad& \frac {n!} {(n-r)!\stimes r!} &= \frac {(n-1)!} {(n-1-r)!\stimes r!}              &\!\!{}+{}\ & \frac {(n-1)!} {(n-1-(r-1))!\stimes (r-1)!} &\qquad&\qquad\\
&\iff\quad& n! &= \frac {(n-1)!\stimes(n-r)!\stimes r!} {(n-r-1)!\stimes r!}                  &\!\!{}+{}\ & \frac {(n-1)!\stimes(n-r)!\stimes r!} {(n-r)!\stimes (r-1)!}\\
&\iff\quad& n! &= \frac {(n-1)!\stimes(n-r)!\stimes\cancel{r!}} {(n-r-1)!\stimes \cancel{r!}} &\!\!{}+{}\ & \frac {(n-1)!\stimes\cancel{(n-r)!}\stimes r!} {\cancel{(n-r)!}\stimes (r-1)!}\\
&\iff\quad& n! &= \frac {(n-1)!\stimes(n-r)\!\cancel{\stimes!\stimes}} {\cancel{(n-r-1)!}}    &\!\!{}+{}\ & \frac {(n-1)!\stimes r\cancel{\stimes!\stimes}} {\cancel{(r-1)!}}\\
&\iff\quad& n! &= {(n-1)!\stimes(n-r)} &\!\!{}+{}\ & {(n-1)!\stimes r} \\
&\iff\quad& n! &= {(n-1)!\stimes((n-r) + r)}\\
&\iff\quad& n! &= {(n-1)!\stimes n}\\
&\iff\quad& n! &= n!
\endalignat
$$

\endexercise

\exercise.
\emph{Redefina} o símbolo $\comb n r$ para todo $n,r\in\nats$
recursivamente com
$$
\align
\comb 0 0          &= 1\\
\comb 0 r          &= 0\\
\comb n r          &= \comb {n-1} r + \comb {n-1} {r-1},
\endalign
$$
e prove que para todo $n,r\in\nats$,
$\comb n r = \dfrac {n!} {(n-r)!\stimes r!}$\,.

\hint
Indução.

\endexercise

\endsection
%%}}}

%%{{{ Counting recursively 
\section Contando recursivamente.

\exercise.
\label{sequences_of_twos_and_threes}
Defina uma função $f\from \nats\to\nats$ que conta as seqüências feitas por os números 2 e 3 com soma sua entrada.
Quantas seqüências de $2$'s e $3$'s existem cujos termos somam em $17$?

\hint
Recursão.

\hint
Separe as seqüências em dois grupos: aquelas que começam com 2, e aquelas que começam com 3.

\hint
Cuidado com a ``base'' $f(0)$.  Quantas seqüências de 2 e 3, somam em $0$?

\hint
Para calcular o valor de $f(17)$, \emph{não} use a definição recursiva ``top-down'', mas ``bottom-up'': calcule os valores em seqüência linear
$f(0), f(1), f(2), \dotsc$ até o valor desejado.

\endexercise

\exercise.
\label{sequences_of_twos_and_threes_restricted}
Defina uma função $g\from \nats\to\nats$ que conta as seqüências feitas por os números 2 e 3 com soma sua entrada, em quais aparecem os dois números (2 e 3).
Quantas seqüências de $2$'s e $3$'s existem cujos termos somam em $18$?

\hint
Use a $f$ do~\ref{sequences_of_twos_and_threes}.

\hint
Quando $g(n) \neq f(n)$?

\hint
Considere os casos:
(1) $n$ não pode ser escrito nem como $n = 2 + 2 + \dotsb + 2$, nem como $n = 3 + 3 + \dotsb + 3$;
(2) $n$ pode ser escrito como $n = 2 + 2 + \dotsb + 2$, e como $n = 3 + 3 + \dotsb + 3$ também;
(3) nenhum dos casos (1)--(2).

\hint
$
g(n) =
\knuthcases{
\cdots\vphantom{f(n)}\cr
\cdots\vphantom{f(n)}\cr
\cdots\vphantom{f(n)}
}
$

\endexercise

\exercise Dirigindo na cidade infinita (sem destino).
\label{infinite_city_1}
No ``meio'' duma ``cidade infinita'', tem um motorista no seu carro.
Seu carro tá parado numa intersecção onde tem 3 opções:
virar esquerda; dirigir reto; virar direita.
No seu depósito tem $a$ unidades de combustível,
e sempre gasta $1$ para dirigir até a próxima intersecção.
De quantas maneiras diferentes ele pode dirigir até seu combustível acabar?
(Veja na figura, dois caminhos possíveis com $a=12$.)
\noindent
\midinsert
\noindent
\centerline{
\hfill
\tikzpicture[scale=0.666]%%{{{
%
\foreach \i in {-4,-3,-2,-1,0,1,2,3,4}
  \draw [-] (\i,-2.5) -- (\i,4.5);
\foreach \j in {-2,-1,0,1,2,3,4}
  \draw [-] (-4.5,\j) -- (4.5,\j);
\draw[rounded corners,line width=2mm,color=blue!40] (0,0) -- (0,1) -- (0,2) -- (-1,2) -- (-1,1) -- (-1,0) -- (-1,-1) -- (-2,-1) -- (-3,-1) -- (-3,0) -- (-3,1) -- (-2,1) -- (-2,2);
\draw[rounded corners,line width=2mm,color=green!40] (0,0) -- (1,0) -- (2,0) -- (3,0) -- (3,1) -- (3,2) -- (3,3) -- (3,4) -- (4,4) -- (4,3) -- (4,2) -- (3,2) -- (2,2);
\node[circle,fill=gray!20] (CR)  at (0,0) {$C$};
%
\endtikzpicture
%%}}}
\hfill
\tikzpicture[scale=0.666]%%{{{
%
\foreach \i in {-4,-3,-2,-1,0,1,2,3,4}
  \draw [-] (\i,-2.5) -- (\i,4.5);
\foreach \j in {-2,-1,0,1,2,3,4}
  \draw [-] (-4.5,\j) -- (4.5,\j);
\draw[rounded corners,line width=2mm,color=blue!40] (0,0) -- (-1.8,0) -- (-1.8,2);
\draw[rounded corners,line width=2mm,color=cyan!60] (0,0) -- (4,0) -- (4,2) -- (-3, 2) -- (-3,3) -- (-2,3) -- (-2,2);
\draw[rounded corners,line width=2mm,color=green!40] (0,0) -- (0,-1) -- (-2.1,-1) -- (-2.1,2);
\node[circle,fill=gray!20] (CR)  at (0,0) {$C$};
\node[circle,fill=gray!20] (DN)  at (-2,2) {$D$};
%
\endtikzpicture
%%}}}
\hfill
}
%\caption{Fig.~1}
\endgraf\centerline{Caminhos possíveis para os exercísios~\refn{infinite_city_1} e~\refn{infinite_city_2} respeitivamente.}
%\endcaption
\endinsert

\hint
Sem recursão!

\hint
Em cada intersecção tem $3$ opções: $\mathtt L$, $\mathtt F$, $\mathtt R$.

\solution
Em cada das $a$ intersecções que ele encontra ele tem $3$ opções.
Logo, ele pode seguir $3^a$ caminhos diferentes dirigindo até seu combustível acabar.

\endexercise

\exercise Dirigindo na montanha infinita.
\label{infinite_mountain}
No ``meio'' duma montanha de altura infinita, tem um motorista no seu carro.
Seu carro tá parado numa intersecção onde tem 4 opções:
dirigir subindo (gasta $4$ unidades de combutível);
dirigir descendo (gasta $1$);
dirigir na mesma altura clockwise (gasta $2$);
dirigir na mesma altura counter-clockwise (gasta $2$).
No seu depósito tem $a$ unidades de combistível.
De quantas maneiras diferentes ele pode dirigir até seu combustível acabar?
\ignore{
\midinsert
\tikzpicture[scale=2]
\axis[
hide axis,
domain=0:1,
y domain=0:-2*pi,
xmin=-1.5, xmax=1.5,
ymin=-1.5, ymax=1.5, zmin=-1.2, zmax=-1.2,
samples=10,
samples y=40,
z buffer=sort,
]
\addplot3[mesh,gray]
({1.1*x*cos(deg(y))},{1.1*x*sin(deg(y))},{-x});
\endaxis
\endtikzpicture
\endinsert
}

\hint
Recursão.

\hint
Seja $f(a)$ o número de caminhos diferentes que o motorista pode seguir com $a$ unidades de combustível.

\hint
Separa todos os caminhos possíveis em 3 grupos, dependendo na primeira escolha do motorista.
Conta o número de caminhos em cada grupo separadamente (recursivamente!),
e e use o princípio da adição para contar quantos são todos.

\endexercise

\exercise Dirigindo na cidade infinita (com destino).
\label{infinite_city_2}
No ``meio'' duma ``cidade infinita'', tem um motorista no seu carro.
Seu carro tá parado numa intersecção onde tem 4 opções:
dirigir na direção do norte; do leste; do sul; do oeste.
No seu depósito tem $c$ unidades de combustível
e sempre gasta $1$ para dirigir até a próxima intersecção.
De quantas maneiras diferentes ele pode dirigir até chegar no teu destino,
que fica numa distância $y$ unidades para norte e $x$ para leste?
Considere que números negatívos representam descolamento para a direção oposta.
(Veja na figura onde o carro $C$ tem destino $D$, ou seja, seu descolamento
desejado é de $x=-2$, $y=2$.)

\hint
Recursão.

\hint
Seja $f(a,x,y)$ o número de caminhos diferentes que acabam com descolamento total de $y$ unidades para norte e $x$ para leste, para um motorista que tem $a$ unidades de combustível no seu carro.

\hint
Separa todos os caminhos possíveis em 4 grupos, dependendo na primeira escolha do motorista.
Conta o número de caminhos em cada grupo separadamente (recursivamente!),
e e use o princípio da adição para contar quantos são todos.

\endexercise

\endsection
%%}}}

%%{{{ Solutions of equations in integers 
\section Soluções de equações em inteiros.

\endsection
%%}}}

%%{{{ Combinations with repetitions 
\section Combinações com repetições. 

\endsection
%%}}}

%%{{{ The inclusion--exclusion principle 
\section O princípio da inclusão--exclusão.

\exercise.
42 passangeiros estão viajando num avião.
\beginul
\li 11 deles não comem beef.
\li 10 deles não comem peixe.
\li 12 deles não comem frango.
\li Os passangeiros que não comem nem beef nem frango são 6.
\li O número de passangeiros que não comem nem beef nem peixe, é o mesmo com o número de passangeiros que não comem nem peixe nem frango.
\li Os passangeiros que não comem nada disso são 3.
\li Os passangeiros que comem tudo são 22.
\endul
\endgraf
\noindent
Quantos são os passangeiros que não comem nem beef nem peixe?

\endexercise

\endsection
%%}}}

%%{{{ Elementary probability 
\section Probabilidade elementar.

\endsection
%%}}}

%%{{{ Derrangements 
\section Desarranjos.

\endsection
%%}}}

%%{{{ The pigeonhole principle 
\section O princípio da casa dos pombos.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\problem.
Uma turma de 28 alunos tem 12 mulheres e 16 homens.
\beginol
\li De quantas maneiras podemos escolher 5 desses alunos, para formar um time de basquete?
(Considere que as posições de basquete não importam).
\li De quantas maneiras podemos escolher 6 desses alunos, para formar um time de volei, tal que o time tem pelo menos 4 homens?
(Considere que as posições de volei não importam).
\li De quantas maneiras podemos escolher 11 desses alunos, para formar um time de futebol, tal que o time tem exatamente 3 mulheres, e um homem para goleiro?
(Considere que a única posição de futebol que importa é do goleiro.)
\li De quantas maneiras podemos escolher 3 times, um para cada esporte, sem restrição de sexo?
\endol

\endproblem

\problem.
Uma noite, depois do treino 3 times (uma de basquete, uma de vólei, e uma de
futebol), foram beber num bar que foi reservado para eles.
Como os jogadores de cada time querem sentar juntos,
o dono arrumou duas mesas cíclicas, uma com 5 e outra com 6 cadeiras, e 11 cadeiras no bar.
\endgraf
De quantas maneiras diferentes eles podem sentar?
(Considere que nas mesas cíclicas o que importa é apenas quem tá no lado de quem, mas no bar o que importa é a posição da cadeira mesmo.)

\endproblem

\problem.
Considere os inteiros $1,2,\dotsc, 30$.
Quantas das suas $30!$ permutações totais têm a propriedade que
não aparecem múltiplos de $3$ consecutivamente?

\hint
Construa cada configuração em passos e use o princípio da multiplicação.

\hint
Coloque os não-múltiplos de 3 primeiramente numa ordem, deixando espaços entre-si
para os múltiplos de 3.

\hint
Escolhe 10 dos 21 lugares possíveis para colocar os múltiplos de 3.

\solution
Primeiramente vamos esqueçer os múltiplos de 3.
O resto dos (20) números pode ser permutado de
$20!$ maneiras.
Para qualquer dessa maneira, temos $\comb {21} {10}$
opções para escolher em quais $10$ das $20+1$ possíveis posições vamos colocar os múltiplos de 3,
e para cada escolha, correspondem $10!$ diferentes permutações dos múltiplos de 3 nessas $10$ posições.
Finalmente,
$$
\underbrace{\phantom(20!\phantom)}_{\text{ordena os não-múltiplos}}\ntimes \underbrace{\comb {21} {10}}_{\text{escolhe as posições dos múltiplos}}\ntimes \underbrace{\phantom(10!\phantom)}_{\text{escolhe a ordem dos múltiplos}}
$$
das $30!$ permutações têm a propriedade desejada.

\endproblem

\problem.
Numa turma de $28$ alunos
precisamos formar duas comissões de $5$ e $6$ membros.
Cada comição tem seu presidente, seu vice-presidente, e seus membros normais.
De quantas maneiras podemos formar essas comissões\dots
\beginol
\li\dots sem restrições (cada um aluno pode participar nas duas comissões simultaneamente)?
\li\dots se nenhum aluno pode participar simultaneamente nas duas comissões?
\li\dots se os dois (únicos) irmãos entre os alunos não podem participar na mesma comissão,
e cada aluno pode participar simultaneamente nas duas?
\endol

\endproblem

\problem.
\label{nikos}
Na figura em baixo temos um mapa (as linhas correspondem em ruas).
Nikos quer caminhar do ponto $A$ para o ponto $B$, \emph{o mais rápido possível}.
\beginol
\li De quantas maneiras ele pode chegar?
\li Se ele precisa passar pelo ponto $S$?
\li Se ele precisa passar pelo ponto $S$ mas quer evitar o ponto $N$?
\endol
\noindent
\midinsert
\noindent
\tikzpicture[scale=0.666]%%{{{
%
\foreach \i in {0,1,2,3,4,5,6,7,8,9}
  \foreach \j in {0,1,2,3,4,5,6,7,8}
    \node (a\i) at (\i,\j) {};
\foreach \i in {0,1,2,3,4,5,6,7,8,9}
  \draw [-] (\i,0) -- (\i,8);
\foreach \j in {0,1,2,3,4,5,6,7,8}
  \draw [-] (0,\j) -- (9,\j);
\draw [rounded corners,line width=2mm,color=green!50] (0,0) -- (0,2) -- (3,2) -- (3,4) -- (7,4) -- (7,5) -- (8,5) -- (8,7) -- (9,7) -- (9,8);
\node[circle,fill=gray!20]  (SW)    at (-0.3,-0.3) {$A$};
\node[circle,fill=gray!20]  (NE)    at (9.3,8.3)   {$B$};
\node[circle,             inner sep=2pt,fill=green!30] (nice)  at (3,2.5)     {{\niness S}};
\node[star,star points=17,inner sep=2pt,fill=red!30]   (boom)  at (6.5,5)     {{\niness N}};
%
\endtikzpicture
%%}}}
\tikzpicture[scale=0.666]%%{{{
%
\foreach \i in {0,1,2,3,4,5,6,7,8,9}
  \foreach \j in {0,1,2,3,4,5,6,7,8}
    \node (a\i) at (\i,\j) {};
\foreach \i in {0,1,2,3,4,5,6,7,8,9}
  \draw [-] (\i,0) -- (\i,8);
\foreach \j in {0,1,2,3,4,5,6,7,8}
  \draw [-] (0,\j) -- (9,\j);
\draw [rounded corners,line width=2mm,color=red!50] (0,0) -- (0,2) -- (3,2) -- (3,4) -- (5,4) -- (5,5) -- (7,5) -- (7,7) -- (8,7) -- (8,8) -- (9,8);
\node[circle,fill=gray!20] (SW)  at (-0.3,-0.3) {$A$};
\node[circle,fill=gray!20] (NE)  at (9.3,8.3) {$B$};
\node[circle,             inner sep=2pt,fill=green!30] (nice)  at (3,2.5)     {{\niness S}};
\node[star,star points=17,inner sep=2pt,fill=red!30]   (boom)  at (6.5,5)     {{\niness N}};
%
\endtikzpicture
%%}}}
%\caption{Fig.~1}
\endgraf\centerline{Um caminho aceitável e um inaceitável no caso (3) do \ref{nikos}.}
%\endcaption
\endinsert

\endproblem

\problem.
Num jogo de lotéria, tem os números de $1$ até $60$:
$$
\matrix
    01&02& 03 &04 &05 &06 &07 &08 &09 &10\\
    11&12& 13 &14 &15 &16 &17 &18 &19 &20\\
    21&22& 23 &24 &25 &26 &27 &28 &29 &30\\
    31&32& 33 &34 &35 &36 &37 &38 &39 &40\\
    41&42& 43 &44 &45 &46 &47 &48 &49 &50\\
    51&52& 53 &54 &55 &56 &57 &58 &59 &60
\endmatrix
$$
Os organizadores do jogo, escolhem aleatoriamente 6 números
deles (sem repetições).
Esses 6 números são chamados ``a megasena''.
Um jogador marca pelo menos 6 números na sua
lotéria e se conseguir ter marcados todos os 6 da megasena, ganha.

(Marcando mais que 6 números,
as chances do jogador aumentam, mas o preço da lotéria aumenta também.)

(1)
Um jogador marcou $6$ números.
Qual a probabilidade que ele ganhe?

(2)
Uma jogadora marcou $9$ números.
Qual a probabilidade que ela ganhe?

(3)
Generaliza para um jogo com $N$ números, onde $w$ deles são escolhidos,
e com um jogador que marcou $m$ números, sendo $w\leq m \leq N$.

\solution
(1)
Apenas uma escolha é a certa, então a probabilidade de ganhar é:
    $$
    \dfrac 1 {\comb {60} 6}
    = \dfrac{6!\stimes 54!} {60!}
    = \dfrac {6!} {55 \ntimes 56 \ntimes 57 \ntimes 58 \ntimes 59 \ntimes 60}
    = \dfrac {1} {11\ntimes 14\ntimes 19\ntimes 29\ntimes 59\ntimes 10}
    = \dfrac 1 {50063860}\,.
    $$
\endgraf
\noindent
(2)
Para ganhar, com certeza acertamos nos 6 números da megasena,
então temos que contar todas as maneiras de escolher os 3 outros números dos 9 que escolhemos:
    $$
    \dfrac {\comb {60-6} {9-6}} {\comb {60} 9}
    = \dfrac {\comb {54} 3} {\comb {60} 9}
    = \dfrac {54!\stimes \cancel{51!}\stimes 9!} {\cancel{51!} \stimes 3!\stimes 60!}
    = \dfrac {4\ntimes 5 \ntimes 6 \ntimes 7 \ntimes 8 \ntimes 9} {55\ntimes 56\ntimes 57\ntimes 58\ntimes 59 \ntimes 60}
    = \dfrac 3 {1787995}\,.
    $$
\endgraf
\noindent
(3)
Generalizando a solução do (2), a probabilidade é
$$
\align
\frac
{\comb {N-w} {m-w}}
{\comb N m}
&=
\frac
{(N-w)! \stimes (N-m)! \stimes m!}
{((N-w)-(m-w))! \stimes (m-w)! \stimes N!}\\
&=
\frac
{(N-w)! \stimes (N-m)! \stimes m!}
{((N\cancel{{}-{}w}-m\cancel{{}+w}))! \stimes (m-w)! \stimes N!}\\
&=
\frac
{(N-w)! \stimes \cancel{(N-m)!} \stimes m!}
{\cancel{(N-m)!} \stimes (m-w)! \stimes N!}\\
&=
\frac
{(N-w)! \stimes m!}
{(m-w)! \stimes N!}\\
&=
\prod_{i=0}^{w-1}
\frac
{m-i}
{N-i}\,.
\endalign
$$

\endproblem

\problem.
\label{frogs}
Aleco e Bego são dois sapos.
Eles estão na frente de uma escada com 11 degraus.
No 6o degrau, tem Cátia, uma cobra, com fome.
Aleco pula 1 ou 2 degraus para cima.
Bego, 1, 2 ou 3.  E ele é tóxico: se Cátia o comer, ela morre na hora.
\midinsert
\tikzpicture[scale=0.666]%%{{{
%
\node[star,star points=17,fill=red!30,inner sep=3pt]    (boom) at (6.75,6.25) {\phantom{\niness C}};
\node[                                             ]    (catia) at (6.666,6.333) {{\niness C}};
\node[circle,fill=green!40]  (aleco) at (-0.333,0.5) {{\niness A}};
\node[circle,fill=blue!30]   (bego)  at (-1.75,0.5) {{\niness B}};
\draw [->,color=green!50,line width=1mm] (aleco) to [bend left=70] (2.333,2);
\draw [->,color=blue!50,line width=1mm] (bego)  to [bend left=66] (1.666,1);
\draw [->,color=green!50,line width=1mm] (aleco) to [bend left=60] (1.333,1);
\draw [->,color=blue!50,line width=1mm] (bego)  to [bend left=62] (2.666,2);
\draw [->,color=blue!50,line width=1mm] (bego)  to [bend left=60] (3.5,3);
\foreach \i in {1,2,3,4,5,6,7,8,9,10,11} {
  \path[fill=gray!10]
    (\i,\i) -- (\i,\i-1) -- (15,\i-1) -- (15,\i) -- (\i,\i);
  \node[circle,fill=black,inner sep=0pt] (b\i) at (\i,\i)   {};
  \node[circle,fill=black,inner sep=0pt] (e\i) at (\i+1,\i) {};
  \node[circle,fill=black,inner sep=0pt] (d\i) at (\i,\i-1) {};
  \node[                  inner sep=0pt] (s\i) at (\i+0.5,\i) {};
  \draw [-,line width=0.2mm] (b\i) -- (e\i);
  \draw [-,line width=0.2mm] (b\i) -- (d\i);
  \node[                  inner sep=0pt] (t\i) at (\i+0.5,\i-0.3) {\i};
}
\draw [-] (-3,0) -- (1,0);
\draw [-] (12,11) -- (15,11);
%\foreach \j in {0,1,2,3,4,5,6,7,8}
%  \draw [-] (0,\j) -- (9,\j);
%  \draw [line width=2mm,color=green!50] (0,0) -- (0,2) -- (3,2) -- (3,4) -- (7,4) -- (7,5) -- (8,5) -- (8,7) -- (9,7) -- (9,8);
%\node[circle,fill=gray!20]  (SW)    at (-0.3,-0.3) {$A$};
%\node[circle,fill=gray!20]  (NE)    at (9.3,8.3)   {$B$};
%\node[circle,fill=green!30] (nice)  at (3,2.5)     {{\niness S}};
%\node[circle,fill=red!30]   (boom)  at (6.5,5)     {{\niness N}};
%
\endtikzpicture
%%}}}
%\caption{Fig.~2}
\endgraf\centerline{Os dois sapos do~\ref{frogs} e suas possibilidades para começar.}
%\endcaption
\endinsert
\item{(1)} Por enquanto, Cátia está dormindo profundamente.
\itemitem{a.} De quantas maneiras Aleco pode subir a escada toda?
\itemitem{b.} De quantas maneiras Bego pode subir a escada toda?
\item{(2)} Cátia acordou!
\itemitem{a.} De quantas maneiras Aleco pode subir a escada toda?
\itemitem{b.} De quantas maneiras Bego pode subir a escada toda?
\item{(3)} Bego começou subir a escada\dots{}
Qual é a probabilidade que Cátia morra?
(Considere que antes de começar,
ele já decidiu seus saltos e não tem percebido a existência da cobra.)
\ignore{
\item{(4)} O que muda na questão (3) se ao invés de decidir seu caminho desde o
início, Bega decida cada vez aleatoriamente (com probabilidades iguais) qual
dos 3 possíveis saltos ele vai fazer?
\item{(5)}
Generalize o problema (4)~para o caso onde a escada
tem uma infinidade de degraus e Cátia fica no degrau $k$.
}

\hint Recursão.

\hint
Sejam $a(n)$ e $b(n)$ o número de maneiras que Aleco e Bego
podem subir uma escada de $n$ degraus, respeitivamente.

\hint
Grupe as maneiras em colecções (para aplicar o princípio da adição),
olhando para o primeiro salto.

\solution
Sejam $a(n)$ e $b(n)$ o número de maneiras que Aleco e Bego
podem subir uma escada de $n$ degraus, respeitivamente.
Cada maneira do Aleco pode começar com 2 jeitos diferentes:
salto de 1 degrau, ou salto de 2 degraus.
Cada maneira do Bego pode começar com 3 jeitos diferentes:
salto de 1, de 2, ou de 3 degraus.
Observe que, por exemplo, se Bego começar com um pulo de 2
degraus, falta subir uma escada de $n-2$ degraus.
Pelo princípio da adição então, temos as equações recursivas:
$$
\xalignat 2
a(n) &= a(n-1) + a(n-2)                & b(n) &= b(n-1) +  b(n-2) +  b(n-3)
\intertext{validas para $n\geq 2$ e $n \geq 3$ respeitivamente.
Devemos definir os casos básicos de cada função recursiva:
$n=0,1$ para a $a(n)$, e $n=0,1,2$ para a $b(n)$:}
     &                                 & b(0) &= 1\qquad\explanation{fica}\\
a(0) &= 1 \qquad\explanation{fica}     & b(1) &= 1\qquad\explanation{pula $1$}\\
a(1) &= 1 \qquad\explanation{pula $1$} & b(2) &= 2\qquad\explanation{pula $1+1$; ou pula $2$}\\
a(n) &= a(n-1) +  a(n-2)               & b(n) &= b(n-1) +  b(n-2) +  b(n-3)
\endxalignat
$$
Calculamos os 11 primeiros valores:
$$
\matrix
a:\quad& \overbrace {1}^{a(0)}, & 1, & 2, & 3, & 5, & \phantom08,  & 13, & 21, & 34, & \phantom055,  & \phantom089,  & \overbrace {144}^{a(11)}, &\dotsc\\
b:\quad& \underbrace{1}_{b(0)}, & 1, & 2, & 4, & 7, & 13,          & 24, & 44, & 81, & 149, & 274, & \underbrace{504}_{b(11)}, &\dotsc
\endmatrix
$$
Agora temos tudo que precisamos para responder facilmente nas questões do problema.
\endgraf
\item{(1)} Precisamos apenas os valores $a(11)$ e $b(11)$:
\itemitem{a.} De $a(11) = 144$ maneiras.
\itemitem{b.} De $b(11) = 504$ maneiras.
\item{(2)} Usamos ``$n\to m$'' para ``pula diretamente do degrau $n$ para o degrau $m$'' e ``$n\transto m$'' para ``vai do degrau $n$ para o degrau $m$ pulando num jeito''.
\itemitem{a.} Para conseguir subir, Aleco necessariamente precisa chegar no degrau 5, saltar até o degrau 7, e depois continuar até o degrau 11.  Formamos cada maneira então em passos, e usando o princípio da multiplicação achamos que Aleco tem
$$
\underbrace{a(5)}_{0 \transto 5} \ntimes
\underbrace{\phantom(1\phantom)}_{5 \to 7} \ntimes
\underbrace{a(4)}_{7 \transto 11}
=
8 \ntimes 1 \ntimes 5
= 40
$$
maneiras de subir a escada toda.
\itemitem{b.} 
Para o Bego a situação não é tão simples, porque ele pode evitar a cobra de vários jeitos.
Vamos grupar eles assim:
(i)   aqueles onde ele pulou a cobra com salto de tamanho 2;
(ii)  aqueles onde ele pulou a cobra com salto de tamanho 3 desde o degrau 5;
(iii) aqueles onde ele pulou a cobra com salto de tamanho 3 desde o degrau 4.
Contamos as maneiras em cada grupo como na questão anterior, e no final as somamos (princípio da adição) para achar a resposta final: Bego tem
$$
\overbrace{
\underbrace{b(5)}_{0 \transto 5} \ntimes
\underbrace{\phantom(1\phantom)}_{5 \to 7} \ntimes
\underbrace{b(4)}_{7 \transto 11}
}^{\text{grupo (i)}}
+
\overbrace{
\underbrace{b(5)}_{0 \transto 5} \ntimes
\underbrace{\phantom(1\phantom)}_{5 \to 8} \ntimes
\underbrace{b(3)}_{8 \transto 11}
}^{\text{grupo (ii)}}
+
\overbrace{
\underbrace{b(4)}_{0 \transto 4} \ntimes
\underbrace{\phantom(1\phantom)}_{4 \to 7} \ntimes
\underbrace{b(4)}_{7 \transto 11}
}^{\text{grupo (iii)}}
=
13 \ntimes 7 + 
13 \ntimes 4 + 
7 \ntimes 7 
=
192
$$
maneiras de subir a escada toda.
\item{(3)}
Pela definição, a probabilidade que Cátia morra é a fracção
$$
\frac
{\text{todas as maneiras em quais Bego pisou no degrau 6}}
{\text{todas as maneiras possíveis}}\,,
$$
ou seja,
$$
\frac
{504-192}
{504}
=
\frac
{312}
{504}
=
\frac
{156}
{252}
=
\frac
{78}
{126}
=
\frac
{39}
{63}
=
\frac
{13}
{21}
\,.
$$

\endproblem

\problem.
Temos $6$ músicos disponíveis, onde cada um toca:
\endgraf
\halign{
\hfil# & #\hfil & \hfil# & #\hfil\cr
Alex:       &violão, guitarra, baixo& Daniel:     &guitarra\cr
Bill:       &bateria                & Eduardo:    &piano, teclado, violão, fláuto\cr
Claudia:    &saxofone, clarineto    & Fagner:     &guitarra, baixo, teclado\cr
}

\noindent
(Considere que uma banda precisa \emph{pelo menos um membro},
todos os membros duma banda \emph{precisam tocar pelo menos algo na banda},
e que cada banda é diferenciada pelos músicos e
suas funções.
Por exemplo: uma bande onde Alex toca o violão (apenas) e Bill a bateria,
é diferente duma banda onde
Alex toca o violão \emph{e} a guitarra, e Bill a bateria,
mesmo que seus membros podem ser os mesmos.

\item{(1)}
Quantas bandas diferentes podemos formar?
\item{(2)}
Quantas bandas diferentes podemos formar com a restrição que nenhum
músico tocará mais que um instrumento na banda (mesmo se em geral sabe tocar mais)?
\item{(3)}
Quantas bandas diferentes podemos formar onde todos os
músicos fazem parte da banda?

\solution
(1):
$2^{14}-1$: para cada músico e cada instrumento, temos 2 opções: ``sim'' ou ``não''.
Tiramos $1$ porque hipercontamos (a ``banda vazia'').
\endgraf
\medskip
\noindent
(2):
Cada músico que toca $i$ instrumentos tem $i+1$ opções (a extra $+1$ corresponde no ``não participar na banda''):
podemos formar $4 \ntimes 2 \ntimes 3 \ntimes 2 \ntimes 5 \ntimes 4 - 1$ bandas, onde de novo tiramos 1 para excluir a ``banda vazia''.
\endgraf
\medskip
\noindent
(3):
Cada músico que toca $i$ instrumentos tem $2^i - 1$ opções (tirando a opção de ``não tocar nada'').  Então podemos formar $7\ntimes 1 \ntimes 3 \ntimes 1 \ntimes 15 \ntimes 7$ bandas.

\endproblem

\problem.
De quantas maneiras podemos escrever um string ternário
(usando o alfabeto $\set{0, 1, 2}$)
de tamanho 7,
tais que \emph{nunca aparece neles o substring $00$}.
\endgraf
Por exemplo:
$$
\align
0112220                                           &\qquad\text{é um string aceitável;}\\
2\underline{00}1\underline{0\overline0}\overline0 &\qquad\text{não é.}
\endalign
$$

\hint
Recursão.

\hint
Seja $a(n)$ o número dos strings ternários de tamanho $n$ tais que nunca aparece
neles o substring ${00}$.

\solution
Seja $a(n)$ o número dos strings ternários de tamanho $n$ tais que nunca aparece
neles o substring ${00}$.
Queremos achar o $a(8)$.
\endgraf
Observe que:
$$
\align
    a(0) &= 1 \qqqquad\explanation{o string vazio: ``$\,$''}\\
    a(1) &= 3 \qqqquad\explanation{os strings: ``$0$'', ``$1$'', e ``$2$''}\\
    a(n) &=
      \underbrace{a(n-1)}_{1\ldots}
    + \underbrace{a(n-1)}_{2\ldots}
    + \underbrace{a(n-2)}_{{01}\ldots}
    + \underbrace{a(n-2)}_{{02}\ldots}\\
         &= 2a(n-1) + 2a(n-2)\\
         &= 2(a(n-1) + a(n-2))
\endalign
$$
Então calculamos os primeiros $8$ termos da seqüência:
$$
1, 3, 8, 22, 60, 164, 448, \underbrace{1224}_{a(7)}.
$$

\endproblem

\problem.
Contar todas as palavras feitas por permutações das 12 letras da palavra
$$
\txt{PESSIMISSIMO}
$$
onde\dots
\item{(1)}
A palavra começa com $\txt P$.
\item{(2)}
Todos os $\txt I$ aparecem \emph{juntos}.
\item{(3)}
Os $\txt M$ aparecem \emph{separados}.
\item{(4)}
Nenhum dos $\txt S$ aparece ao lado de outro $\txt S$.

\hint
Para o (4), seria diferente se a restrição fosse
``os $\txt S$ não aparecem todos juntos''.

\solution
(1):
Como somos obrigados começar a palavra com ${\txt P}$,
precisamos apenas contar as permutações das letras da palavra
$
\txt{ESSIMISSIMO}
$,
que sabemos que são
$$
\frac
{11!}
{4!\stimes3!\stimes 2!}.
$$
\endgraf
\medskip
\noindent
(2):
Podemos considerar que temos apenas um $I$:
$
\dfrac
 {10!}
 {4!\stimes  2!}
$
\endgraf
\medskip
\noindent
(3):
Contamos em quantas palavras eles aparecem juntos,
e usando princípio da adição, os subtraimos das permutações sem restrição.
$$
\underbrace{
\,
\dfrac
 {12!}
 {4!\stimes  3!\stimes  2!}
\,
}_{\text{todas}}
 -
\underbrace{
\,
\dfrac
 {11!}
 {4!\stimes  3!}
\,
}_{\text{$\txt M$ juntos}}
$$
\endgraf
\noindent(4):
Construimos cada dessas palavras em passos.
Primeiramente escolhemos uma das permutações da palavra sem os ${\txt M}$'s:
$$
\phantom{\underline{\phantom{{\txt M}}}}*
\phantom{\underline{\phantom{{\txt M}}}}*
\phantom{\underline{\phantom{{\txt M}}}}*
\phantom{\underline{\phantom{{\txt M}}}}*
\phantom{\underline{\phantom{{\txt M}}}}*
\phantom{\underline{\phantom{{\txt M}}}}*
\phantom{\underline{\phantom{{\txt M}}}}*
\phantom{\underline{\phantom{{\txt M}}}}*
\phantom{\underline{\phantom{{\txt M}}}}
$$
(temos 
$
\dfrac
{8!}
{3!\stimes 2!}
$
opções).
\endgraf
\medskip
No próximo passo escolemos em qual das $9$ posições possíves colocamos os $M$:
$$
\underline{\phantom{{\txt M}}}*
\underline{\phantom{{\txt M}}}*
\underline{\phantom{{\txt M}}}*
\underline{\phantom{{\txt M}}}*
\underline{\phantom{{\txt M}}}*
\underline{\phantom{{\txt M}}}*
\underline{\phantom{{\txt M}}}*
\underline{\phantom{{\txt M}}}*
\underline{\phantom{{\txt M}}}
$$
Pelo princípio da multiplicação então, temos
$
\dfrac
{8!}
{3!\stimes 2!}
\cdot
\comb 9 4
$
palavras que satisfazem essa restrição.

\endproblem

\problem.
De quantas maneiras podemos escrever um string usando o alfabeto
de 26 letras
$$
\txt A, \txt B, \txt C, \dotsc, \txt X, \txt Y, \txt Z,
$$
tais que as vogais aparecem na ordem estrita alfabética, e as consoantes na órdem oposta?
(As vogais sendo as letras $\txt A$, $\txt E$, $\txt I$, $\txt O$, $\txt U$, $\txt Y$.)
{Por exemplo:}
$$
\align
\txt{TEDUCY}    &\qquad\text{é um string aceitável};\\
\txt{DETUCY}    &\qquad\text{não é ($\txt D \not> \txt T$)};\\
\txt{TEDUCA}    &\qquad\text{não é ($\txt U \not< \txt A$)}.
\endalign
$$
\item{(1)} \dots se os strings são de tamanho 26 e os vogais aparecem todos juntos;
\item{(2)} \dots se os strings são de tamanho 12 e aparecem todos os vogais;
\item{(3)} \dots se os strings são de tamanho 3;
\item{(4)} \dots se os strings são de tamanho $\ell$, com $0\leq\ell\leq 26$.

\solution
(1)
Como a ordem das consoantes e das vogais é predeterminada e as vogais devem aparecer juntas,
a única escolha que precisamos fazer é onde colocar as vogais, e temos $21$ possíveis posições.
Então existem $21$ tais strings.
\endgraf
\noindent
(2)
$$
\underbrace{\comb {20} 6}_{\text{\eightrm consoantes}},
\underbrace{\comb {12} 6}_{\text{\eightrm suas posições}}.
$$
\endgraf
\noindent
(3)
Separamos todos os strings que queremos contar em quatro grupos e contamos cada um separadamente:
$$
{
\overbrace{
\underbrace{\comb {20} 3}_{\text{as c.}}
}^{\text{3 c., 0 v.}}
}
+
{
\overbrace{
\underbrace{\comb {20} 2}_{\text{as c.}}
\underbrace{\comb 6 1}_{\text{a v.}}
\underbrace{\comb 3 2}_{\text{pos.~c.}}
}^{\text{2 c., 1 v.}}
}
+
\overbrace{
\underbrace{\comb {20} 1}_{\text{a c.}}
\underbrace{\comb 6 2}_{\text{as v.}}
\underbrace{\comb 3 1}_{\text{pos.~c.}}
}^{\text{1 c., 2 v.}}
+
\overbrace{
\underbrace{\comb 6 3}_{\text{as v.}}
}^{\text{0 c., 3 v.}}.
$$
Podemos descrever o resultado numa forma mais uniforme e mais fácil para generalizar:
$$
\sum_{i=0}^3
\underbrace{\comb {20} {3-i}}_{\text{as $3-i$ c.}}
\underbrace{\comb 6 i}_{\text{as $i$ v.}}
\underbrace{\comb 3 i}_{\text{pos.~v.}}
=
\sum_{\Sb c+v=3\\ c,v\in\nats\endSb}
\underbrace{\comb {20} c}_{\text{as c.}}
\underbrace{\comb 6 v}_{\text{as v.}}
\underbrace{\comb 3 v}_{\text{pos.~v.}}
$$
\endgraf
\noindent
(4)
Seguindo a última forma do (3), temos
$$
\sum_{i=0}^{\ell}
\underbrace{\comb {20} {\ell-i}}_{\text{as $\ell-i$ c.}}
\underbrace{\comb 6 i}_{\text{as $i$ v.}}
\underbrace{\comb {\ell} i}_{\text{pos.~v.}}
$$
maneiras.  O somatório pode ser escrito também assim:
$$
\sum
\bigg\{
\underbrace{\comb {20} c}_{\text{as c.}}
\underbrace{\comb 6 v}_{\text{as v.}}
\underbrace{\comb {\ell} v}_{\text{pos.~v.}}
\ \Big|\ 
c+v=\ell, \ 0\leq c \leq 20, \ 0\leq v \leq 6, \ c,v\in\nats
\bigg\}.
$$
Note que como o conjunto em cima é finito,
a adição é comutativa e associativa; logo, nosso somatório é bem definido.

\endproblem

\problem.
\label{roulette_multiple_balls}
Numa roleta dum cassino tem ``pockets'' (ou ``casas'') numerados com:
$$
00, 0, 1, 2, \dotsc, 36
$$
e cada um deles é suficientemente profundo para caber até 8 bolinhas.
O crupiê joga 8 bolinas na roleta no mesmo tempo.
De quantas maneiras elas podem cair nos pockets se\dots
\item{(1)}\dots as bolinhas são distintas e não importa sua ordem dentro um pocket.
\item{(2)}\dots as bolinhas são todas iguais.
\endgraf

\solution
\noindent
(1) São permutações com repetições: $38 ^ 8$.
\endgraf
\noindent
(2) São combinações com repetições: $\comb {38 + 8 - 1} 8 = \comb {45} 8$.

\endproblem

\problem.
De quantas maneiras podemos escrever um string usando
letras do alfabeto $\set{\txt A, \txt B, \txt C, \txt D}$,
tais que \emph{cada letra é usada exatamente duas vezes
mas não aparece consecutivamente no string}?
Por exemplo:
$$
\align
\txt{ABADCDBC}                      &\qquad\text{é um string aceitável;}\\
\txt{ABAC$\underline{\txt{DD}}$BC}  &\qquad\text{não é.}
\endalign
$$

\medskip

\hint
Inclusão--exclusão.

\hint
Considere as propriedades:
$$
\xalignat 4
 \alpha  &: \text{aparece o $\txt{AA}$}
&\beta   &: \text{aparece o $\txt{BB}$}
&\gamma  &: \text{aparece o $\txt{CC}$}
&\delta  &: \text{aparece o $\txt{DD}$}.
\endxalignat
$$

\solution
Seja $N$ o número de permutações totais das létras
e defina as 4 propriedades
$$
\xalignat 4
 \alpha  &: \text{aparece o $\txt{AA}$}
&\beta   &: \text{aparece o $\txt{BB}$}
&\gamma  &: \text{aparece o $\txt{CC}$}
&\delta  &: \text{aparece o $\txt{DD}$}.
\endxalignat
$$
Procuramos o número dos strings de tamanho 8 que não tenham nenhuma dessas 4 propriedades.
Assim que calcular os $N(\alpha),\dotsc,N(\alpha,\beta,\gamma,\delta)$
o princípio da inclusão--exclusão, vai nos dar o número que procuramos.
\endgraf
Observamos que
$$
\gather
N(\alpha) =N(\beta) =N(\gamma) =N(\delta)\\
N(\alpha,\beta) =N(\alpha,\gamma) = \dotsb = N(\gamma,\delta)\\
N(\alpha,\beta,\gamma) = \dotsb = N(\beta,\gamma,\delta).
\endgather
$$
\endgraf
Calculamos os
$$
\align
N
&= \frac {8!} {2!\stimes 2!\stimes 2!\stimes 2!} = 2520\\
N(\alpha)
&= \frac {7!} {2!\stimes 2!\stimes 2!} = \frac {7!} 8 = 7\ntimes 6 \ntimes 5 \ntimes 3 = 630\\
N(\alpha,\beta)
&= \frac {6!} {2!\stimes 2!} = \frac {6!} 4 = 180 \\
N(\alpha,\beta,\gamma)
&= \frac {5!} {2!} = \frac {5!} 2 = 60 \\
N(\alpha,\beta,\gamma,\delta)
&= {4!} = 24.
\endalign
$$
\endgraf
Para responder, temos
$$
\gather
    N
    - \comb 4 1 N(\alpha)
    + \comb 4 2 N(\alpha,\beta)
    - \comb 4 3 N(\alpha,\beta,\gamma)
    + N(\alpha,\beta,\gamma,\delta)\\
    =
    2520 - 4\ntimes 630 + 6\ntimes 180 - 4\ntimes 60 + 24
    =
    864
\endgather
$$
tais permutações.

\endproblem

\problem.
\label{p_divides_comb_p_r}
Para todo $p$ primo, e todo $r\in\set{1,\dotsc,p-1}$,
$$
p \divides \comb p r.
$$

\hint
$\comb p r \in\ints$, $r < p$, e $p-r < p$.

\endproblem

\problem O sonho do calouro.
\label{freshmans_dream}%
\ii{sonho do calouro}%
Seja $p$ primo, $x,y\in\ints$.
$$
(x + y)^p \cong x^p + y^p \pmod p.
$$

\hint
Use o teorema binomial~\refn{binomial_theorem}.

\hint
Use o \ref{p_divides_comb_p_r}.

\solution
Temos
$$
\alignat 2
(x + y)^p
&= \sum_{i=0}^p \binom p i x^{p-i}y^i    \qqby {por~\ref{binomial_theorem}}\\
&= \binom p 0 x^p + \sum_{i=1}^{p-1} \binom p i x^{p-i}y^i + \binom p p y^p   \qqby{$p\geq2$}  \\
&= x^p + \sum_{i=1}^{p-1} \binom p i x^{p-i}y^i + y^p     \\
&= x^p + \sum_{i=1}^{p-1} p c_i x^{p-i}y^i + y^p, \quad\text{para algum $c_i\in\ints$}  \qqby{por~\ref{p_divides_comb_p_r}}  \\
&= x^p + p \sum_{i=1}^{p-1} c_i x^{p-i}y^i + y^p      \\
&\cong x^p + y^p \pmod p.
\endalignat
$$

\endproblem

\problem.
Ache uma nova prova, \emph{por indução}, do teorema de Fermat~\refn{fermat_little_theorem_2}:
\endgraf\noindent
{\sl Para todo primo $p$ e todo $a\in\ints$},
$$
a^p \cong a \pmod p.
$$
(Note que $a\in\ints$ e não $a\in\nats$.)

\hint
Use o sonho de calouro (\ref{freshmans_dream}).

\endproblem

\problem.
\label{parity_respecting_strings_mutual_recursion}
De quantas maneiras podemos escrever um string binário
(usando o alfabeto $\set{0, 1}$) de tamanho 12,
tais que: 
\beginol
\li os $0$'s aparecem apenas em grupos maximais de tamanho par;
\li os $1$'s aparecem apenas em grupos maximais de tamanho impar.
\endol
Por exemplo:
$$
\align
{000000111001}                         &\qquad\text{é um string aceitável;}\\
{100\underline{11}001\underline{000}1} &\qquad\text{não é.}
\endalign
$$

\hint
Separe os strings em dois grupos, aqueles que terminam em $0$ e aqueles que terminam em $1$,
e conta os strings de cada grupo usando recursão.

\hint
Sejam $a(n)$ e $b(n)$ o número de strings binários de tamánho $n$ que terminam em $0$ e em $1$ respectivamente.

\endproblem

\problem.
\def\MM{\ensuremath{\mathtt{M}}}
\def\FB{\ensuremath{\mathtt{F}}}
\def\ST{\ensuremath{\mathtt{B}}}
Xÿźźÿ o Mago Bravo decidiu matar todos os lemmings que ele guarda no seu quintal.
Seus feitiços são os:
\beginul
\li ``magic missile'', que mata 2 lemmings simultaneamente, e gasta 1 ponto ``mana'';
\li ``fireball'', que mata 3 lemmings simultaneamente, e gasta 2 pontos ``mana''.
\endul
\noindent
Alem dos feitiços, Xÿźźÿ pode usar seu bastão para matar
os lemmings (que não custa nada, e mata 1 lemming com cada batida).
\endgraf
Suponha que o mago \emph{nunca} lançará um feitiço que mataria mais lemmings do
que tem (ou seu quintal vai se queimar).
Ele tem $m$ pontos ``mana'' e existem $n$ lemmings no seu quintal.
Em quantas maneiras diferentes ele pode destruir todos os lemmings se\dots
\beginol
\li os lemmings são indistinguíveis?
\li os lemmings são distinguíveis?
\li os lemmings são distinguíveis e cada vez que Xÿźźÿ mata um usando seu bastão,
ele \emph{ganha} um ponto de ``mana''?
\endol
\noindent
(Para os casos que os lemmings são distinguíveis,
o mago escolhe também \emph{quais} dos lemmings ele matará cada vez.)

\hint
Recursão.

\hint
Seja $f(m,n)$ o número de maneiras que Xÿźźÿ pode matar todos os $n$ lemmings,
começando com $m$ pontos de mana.

\endproblem

\endproblems
%%}}}

%%{{{ History 
\history.

Pascal não foi o primeiro de estudar o ``triângulo aritmético'',
cuja existência e sua relação com a teorema binomial já eram
conhecidas desde uns séculos antes do seu nascimento.
Mesmo assim, seu estudo
\emph{``Traité du triangle arithmétique, avec quelques autres petits traitez
sur la mesme matière''},
publicado no ano \oldstyle{1654} (depois da sua morte)
popularizou o triângulo e suas diversas aplicações e propriedades
(\cite{pascaltriangle})

\endhistory
%%}}}

%%{{{ Further reading 
\further.

Veja o~\cite{nivencount}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Generating functions and recurrence relations 
\chapter Funções geradoras e relações de recorrência.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Sets 
\chapter Conjuntos.

%%{{{ Concept, notation, equality 
\section Conceito, notação, igualdade.

Noções primitivas: ser conjunto, pertencer ($\in$)

Multiconjuntos e seqüências.

Conjuntos como ``black boxes''

Igualdade entre conjuntos: A = B

Set comprehension (Set-builder notation)

Diagramas de Venn e suas limitações

Homogenicidade de conjuntos

Sinónimos de ``conjunto'': família, colecção, etc.

O conjunto vazio $\emptyset$: definição e suas propriedades

O conjunto-universo $\univ$.

Como usar um fato do tipo $D\neq \emptyset$ em nossas provas: ``Seja $d\in D$.''

\endsection
%%}}}

%%{{{ Intension vs. Extension
\section Intensão vs{.}~extensão.

\endsection
%%}}}

%%{{{ Relations between sets and how to define them 
\section Relações entre conjuntos e como as definir.

As relações binárias: $=$, $\subseteq$, $\supseteq$, $\subsetneq$, $\supsetneq$.

\endsection
%%}}}

%%{{{ Operations on sets and how to define them 
\section Operações entre conjuntos e como as definir.

Operações entre conjuntos e dois jeitos de as definir

As operações binárias: $\inters$, $\union$, $\setminus$.

A operação unária de complemento: $^{\sim}$

Diferença simétrica ($\symdiff$)

Produto cartesiano ($\times$)

$A^n$: definição ``direta'' e recursiva

Powerset ($\powerset$)

Uniões disjuntas, famílias.

As operações unitárias de união e interseção.

Generalizando as operações de união e intersecção: as operações unárias $\Inters$, $\Union$.

Aplicando (e iterando) as $\powerset$, $\Inters$, e $\Union$ no $\emptyset$.

Intuição sobre os $\Inters$, $\Union$, $\powerset$, e as $\{$, e $\}$.

$\Inters$ e $\Union$ com subscripts (mais notações)

Uma diferença importantíssima entre os operadores $\sum{}$ e $\Union$ e seus indices:
um somatório infinito não é nem associativo nem comutativo!

Riemann's rearrangement theorem.

Intervalos de reais, suas intersecções e uniões arbitrárias 

Os operadores binários $\union$ e $\inters$ como açucar sintático
(definido pelos operadores unários $\Union$ e $\Inters$ respeitivamente).

\endsection
%%}}}

%%{{{ Proving equalities and inclusions 
\section Provando igualdades e inclusões.

Um teorema de igualdade de conjuntos:
Suponha que $A,B\neq\emptyset$.
$A \times B = B\times A \iff A = B$.
Prova direta, e prova pelo absurdo.

\endsection
%%}}}

%%{{{ Families and sequences of sets 
\section Famílias e seqüências de conjuntos.

Família de conjuntos indexada por algum conjunto $I$: $\set{A_i \st i\in I}$

Exemplos: Os conjuntos $A_p$ e $F_p$ de todos os ancestrais e todos os filhos de $p$, respeitivamente.

Traduzindo afirmações da linguagem natural para relações entre conjuntos e vice-versa

Seqüências de conjuntos

Conjuntos disjuntos e família de conjuntos disjuntos dois-a-dois (``pairwise disjoint''): definição com e sem índices.

\endsection
%%}}}

%%{{{ Cardinality 
\section Cardinalidade.

Cardinalidade de conjuntos finitos e propriedades.

\endsection
%%}}}

%%{{{ Multisets 
\section Multiconjuntos.

\note Multiconjuntos como black boxes.

\endsection
%%}}}

%%{{{ Tuples 
\section Tuplas.

\note Tuplas como black boxes.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Functions 
\chapter Funções.

%%{{{ Concept, notation, equality 
\section Conceito, notação, igualdade.

Conceito, notação, ``definição''

Domínios, codomínio.

Aridade.

Função como ``black box''.

Sinônimos de ``função''.

Igualdade: f = g 

Quaisquer duas das:
$\dom f = \dom g$;
para todo $x \in \dom f$, $f(x) = g(x)$;
para todo $x \in \dom g$, $f(x) = g(x)$.

Diagramas internos e externos.

Endomapas e fixpoints.

\endsection
%%}}}

%%{{{ Intension vs. Extension 
\section Intensão vs{.}~extensão.

\definition.
\tdefined{função!gráfico}%
\sdefined{\graph{\holed f}} {o gráfico da função $\holed f$}%
Dado função $f : X\to Y$, o \dterm{gráfico da $f$}, é o conjunto
$$
\graph f \defeq \setst {(x,f(x))} {x \in X}.
$$

\endsection
%%}}}

%%{{{ Defining functions 
\section Definindo funções.

Como definir funções e notação relevante

Como não definir funções: erros comuns

\endsection
%%}}}

%%{{{ The λ-notation 
\section A notação $\lambda$.

\endsection
%%}}}

%%{{{ Injections, Surjections, Bijections
\section Funções injetoras, sobrejetoras, e bijetoras.

Injetora, Sobrejetora, Bijetora

Exemplos e não-exemplos.

Quantas funções entre dois conjuntos tais que\dots?

Usando propriedades da $(g \of f)$ para deduzir propriedades das $f$ e $g$ 

\exercise Composição respeita -jetividade.
\label{composition_respects_jections}%
Sejam $f : A\to B$ e $g : B \to C$.  Então:
\item{(1)} Se $f$ e $g$ são injetoras, então $g\fcom f$ também é;
\item{(2)} Se $f$ e $g$ são sobrejetoras, então $g\fcom f$ também é;
\item{(3)} Se $f$ e $g$ são bijetoras, então $g\fcom f$ também é.

\endexercise

\endsection
%%}}}

%%{{{ Images and pre-images
\section Imagens e pre-imagens.

Imagem.

Pre-imagem.

\exercise.
Sejam conjuntos $A$ e $B$, $f : A\to B$, e $X\subseteq A$ e $Y\subseteq B$.
Compare os conjuntos:
$$
\align
X &\askeq f^{-1}\big[f[X]\big]\\
Y &\askeq f\big[f^{-1}[Y]\big]
\endalign
$$
Caso que alguma das igualdades não é válida em geral, que mais seria suficiente supor para a garantir?

\endexercise

Função inversa.

Notação mal definida ou\dots?

\endsection
%%}}}

%%{{{ Constructing functions 
\section Construindo funções.

Identidade, constante, caraterística

Função inversa.

Iteração de função: $f^n$ (idéia e definição recursiva)

Aplicação parcial e ``buracos'': com $-$, $\cdot$, etc.; com lambdas ($\lambda$)

Aplicação parcial como black box.

Eta conversion.

Aplicação como operação.

Conjuntos de funções

(Co)domínio vazio: função vazia

Composição como operação: comparação com multiplicação nos inteiros.

Composição como black box.

Restrição: definição e propriedades

União: hipoteses necessárias para definir

Produto: definição, idéia, black box

Embedding.

Operações point-wise.

\endsection
%%}}}

%%{{{ Composition laws 
\section Leis da composição.

O lei da composição: $h\of(g\of f) = (h\of g)\of f$; prova e intuição

\endsection
%%}}}

%%{{{ Commutative diagrams
\section Diagramas comutativos.

Como expressar o lei da identidade usando apenas a comutatividade de um diagrama.

\endsection
%%}}}

%%{{{ Recursive functions 
\section Funções recursivas.

Funções recursivas; recursão mutual.

\endsection
%%}}}

%%{{{ Higher-order functions and currification 
\section Funções de ordem superior e currificação.

Funções de ordem superior.

Exemplos: composição, derivação, integração, somatório, produtório, etc.

Currificação.

\endsection
%%}}}

%%{{{ Operations on sets 
\section Operações em conjuntos.

Composição como operação associativa.

\definition Conjunto fechado sobre operação.
Seja $A$ conjunto e $f\from A^n\to A$ uma função com aridade $n\in\nats$.
O conjunto $A$ é \dterm{fechado sobre $f$} sse
$f(\vec a) \in A$ para todo $\vec a\in A^n$.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

O \cite[Cap.~5]{velleman} defina e trata funções
como casos especiais de relações (veja~\ref{relations}),
algo que não fazemos nesse texto.
Muitos livros seguem essa abordagem, então o leitor é conselhado
tomar o cuidado necessário enquanto estudando esses assuntos.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Relations 
\chapter Relações.
\label{relations}%

{
\def\R{\rel R}
\def\S{\rel S}
\def\T{\rel T}

%%{{{ Concept, notation, properties
\section Conceito, notação.

\endsection
%%}}}

%%{{{ Defining relations 
\section Definindo relações.

\endsection
%%}}}

%%{{{ Properties of relations 
\section Propriedades de relações.

Aqui aumentamos nossa terminologia, identificando certas propriedades
interessantes que uma relação binária $\R$ no $X$ pode ter.

\note Reflexão.
\label{reflexion_terminology}
\tdefined{relação!reflexiva}
\tdefined{relação!irreflexiva}
Olhamos como cada elemento do $X$ relaciona com ele mesmo.
Dois casos notáveis aparecem:
(i) pode ser que para todo $x$ temos $x\R x$;
(ii) pode ser que para nenhum $x$ temos $x\R x$.
No primeiro caso, chamamos $\R$ \dterm{reflexiva}; no segundo, \dterm{irreflexiva}.
Observe que ``irreflexiva'' não significa ``não reflexiva'', etc:
$$
\alignat 2
\text{$\R$ é reflexiva}      &\iff \forall x R(x,x)             &&\iff \lnot\exists x \lnot R(x,x)\\
\text{$\R$ não é reflexiva}  &\iff \lnot\forall x R(x,x)        &&\iff \exists x \lnot R(x,x)\\
\text{$\R$ é irreflexiva}    &\iff \forall x \lnot R(x,x)       &&\iff \lnot\exists x R(x,x)\\
\text{$\R$ não é irreflexiva}&\iff \lnot\forall x \lnot R(x,x)  &&\iff \exists x R(x,x)
\endalignat
$$
onde os quantificadores quantificam sobre o $X$.

\example.
As relações $=$, $\leq$, $\geq$, nos números e $=$, $\subseteq$, $\supseteq$ nos conjuntos são todas reflexivas.
Também reflexivas são as relações
\trel{\thole\ nasceu no mesmo pais que \thole},
\trel{\thole\ tem o mesmo primeiro nome com \thole}, etc.,
definidas entre pessoas.
Típicos exemplos de irreflexivas são as $\neq$, $<$, $>$, $\subsetneq$, $\supsetneq$,
\trel{\thole\ é mais baixo que \thole},
\trel{\thole\ e \thole\ nunca estiveram em distância de 2 metros entre si},
etc.
\endexample

\note Simetria.
\label{symmetry_terminology}
\tdefined{relação!simétrica}
\tdefined{relação!assimétrica}
\tdefined{relação!antissimétrica}
Agora examinamos a relação $\R$ com respeito à ordem dos seus argumentos.
Novamente, certos casos notáveis aparecem:
(i) $\R$ pode comportar sempre no mesmo jeito independente da ordem dos seus argumentos; nesse caso a chamamos \dterm{simétrica}.
(ii) O $\R$-relacionamento dum objeto $x$ com outro $y$ atravez da $\R$ pode garantir que o $y$ não esta $\R$-relacionado com o $x$; a chamamos \dterm{asimmétrica}.
(iii) O único caso onde a $\R$ relaciona os mesmos argumentos com as duas possíveis órdens, é quando os dois argumentos são iguais; chamamos a $\R$ \dterm{antisimmétrica}.

\example.
Simétricas: $=$, $\neq$, composicionalidade de funções, \trel{\thole\ e \thole\ são irmãos}, \trel{\thole\ e \thole\ são cidades do mesmo país}, etc.
\endgraf\noindent
Asimétricas: $<$, $\subsetneq$, $>$, $\supsetneq$, \trel{\thole\ deve dinheiro para \thole}, \trel{\thole\ está andando no lado esquerdo de \thole}, \trel{\thole\ é a mãe de \thole}, etc.
\endgraf\noindent
Antisimétricas: $\leq$, $\subseteq$, $\geq$, $\supseteq$, $=$, \trel{a palavra \thole\ aparece, mas não depois da palavra \thole\ no dicionário}, etc.
\endexample

\exercise.
Verifique que ``não simétrica'' não significa nem ``assimétrica''
nem ``antissimétrica'', escrevendo todas as fórmulas envolvidas e suas negações,
como no~\refn{reflexion_terminology}.

\endexercise

\exercise.
Decida a ``reflexão'' e a ``simetria'' das relações seguintes:
$$
\align
R(A, B) &\letiff \text{os conjuntos $A$ e $B$ são disjuntos}\\
S(A, B) &\letiff |A\setminus B| > 1\\
T(A, B) &\letiff A\symdiff B \neq \emptyset
\endalign
$$

\endexercise

\exercise.
Mostre que:
$$
\R \text{assimétrica} \implies \R \text{irreflexiva}
$$

\hint
Contrapositivo.

\solution
Mostramos o contrapositivo.
Suponha que $R$ não é irreflexiva.
Então existe $s$ com $R(s,s)$,
e logo é impossível que a $R$ seja assimétrica,
pois achamos $x$ e $y$ ($x=y=s$) que satisfazem ambas
$R(x,y)$ e $R(y,x)$.

\endexercise

\exercise.
Uma das duas direções em baixo é válida:
$$
\R \text{assimétrica} \askiff \R \text{antissimétrica}
$$
Prove-la, e mostre que a oposta não é.

\hint
Como uma relação assimétrica poderia não ser antissimétrica?
(O que significa ``não ser antissimétrica''?)

\hint
Procure contraexemplo nos exemplos típicos de relação antissimétrica.

\solution
Para provar a \lrdir, observe que $R$ não é antissimétrica
sse existem $x$ e $y$ tais que:
$$
\underbrace{R(x,y)
\land
R(y,x)}_{\text{impossível por assimetria}}
{}\land\ \ 
{x\neq y}.
$$
Para refutar a \rldir, considere o contraexemplo da antissimétrica $\leq$
no $\nats$, que não é assimétrica, pois é reflexiva.

\endexercise

\note Totalidade.
Total.
Tricotomia.

\note Transições.
Transitividade.
Circular
Left-euclidean
Right-euclidean

\note Glossário.
Resumimos aqui as propriedades que encontramos.
Seja $X$ conjunto e $\R$ uma relação binária nele.
Definimos as seguintes propriedades:
$$
\alignat 2
&x \R x                                 &\qqqquad&\text{\rm(reflexiva)}\\
&x \not\R x                             &\qqqquad&\text{\rm(irreflexiva)}\\
&x \R y  \implies  y \R x               &\qqqquad&\text{\rm(simétrica)}\\
&x \R y  \implies  y \not\R x           &\qqqquad&\text{\rm(assimétrica)}\\
&x \R y  \mland y \R x \implies x = y   &\qqqquad&\text{\rm(antissimétria)}\\
&x \R y  \mland  y \R z \implies x \R z &\qqqquad&\text{\rm(transitiva)}\\
&x \R y  \mland  y \R z \implies z \R x &\qqqquad&\text{\rm(circular)}\\
&x \R y  \mland  x \R z \implies y \R z &\qqqquad&\text{\rm(right-euclidean)}\\
&x \R z  \mland  y \R z \implies x \R y &\qqqquad&\text{\rm(left-euclidean)}\\
&x \R y  \mlor   y \R x                 &\qqqquad&\text{\rm(total)}\\
\text{exatamente uma das:}\quad
&x \R y\, ; \  y \R x\, ; \  x = y      &\qqqquad&\text{\rm(tricotômica)}\\
\endalignat
$$

\proposition.
\label{wrong_property_of_sym_and_trans_implies_refl}
Seja $X\neq\emptyset$ e $\sim$ uma relação no $X$.
Se $\sim$ é simétrica e transitiva, então ela é reflexiva.
\wrongproof.
Como ela é simétrica, de $x\sim y$ concluimos que $y\sim x$ também.
E agora usando a transitividade, de $x\sim y$ e $y\sim x$, concluimos a $x\sim x$,
que mostra que $\sim$ é reflexiva também.
\mistaqed

\exercise.
Ache o erro na prova em cima e \emph{prove} que a proposição é falsa!

\endexercise

\endsection
%%}}}

%%{{{ Equivalence relations and partitions 
\section Relações de equivalência e partições.

\note Equivalência.
Considere um conjunto $A$, onde queremos ``identificar'' certos elementos deles,
talvez porque ligamos apenas sobre uma propriedade, e queremos ignorar os
detalhes irrelevantes que nos obrigariam distinguir uns deles.
Por exemplo, se $A$ é um conjunto de pessoas, podemos focar apenas na
``nacionalidade''.  Esquecendo todos os outros detalhes então, vamos
considerar todos os copatriotas como se fossem ``iguais'':
o termo certo é \dterm{equivalentes}.
Outra propriedade poderia ter sido o ano que cada pessoa nasceu,
ou o primeiro nome,  ou até quem é a mãe de cada pessoa.
Nesse último caso por exemplo, duas pessoas seriam equivalentes sse elas são
irmãos ``maternais''.
Queremos identificar as propriedades que uma relação desse tipo tem que ter:
\item{(i)} Reflexividade: não importa qual foi o critério que escolhemos
para ``equivaler'' os objetos, cada objeto com certeza vai ``concordar''
com ele mesmo nesse critério.
\item{(ii)} Simetría: pela natureza da nossa intuição é claro que
para decidir se dois elementos serão equivalentes ou não, não precisamos
os considerar numa certa ordem.
\item{(iii)} Transitividade:
Se $a$ e $b$ viram equivalentes, e $b$ e $c$ também, isso quis dizer
que não podemos distinguir entre $a$ e $b$, nem entre $b$ e $c$;
segue que $a$ e $c$ também serão equivalentes.
\endgraf
\noindent Chegamos assim na definição seguinte:

\definition.
\label{equivalence_relation}
\tdefined{relação!de equivalência}
Seja $A$ conjunto e $\sim$ uma relação binária no $A$.
Chamamos $\sim$ uma \dterm{relação de equivalência} sse ela é
reflexiva, simétrica, e transitiva.

\example.
\label{equivalent_relations_on_euclidean_space}
No $\reals^3$ considere as relações:
$$
\align
\tup{x,y,z} \sim_1 \tup{x',y',z'}
&\iff z = z'\\
\tup{x,y,z} \sim_2 \tup{x',y',z'}
&\iff x = x' \text{\ e\ } y = y'
\endalign
$$
Facilmente ambas são relações de equivalência.
\endexample

\exercise.
Mudamos o ``e'' para ``ou'' na última relação do~\ref{equivalent_relations_on_euclidean_space}:
$$
\tup{x,y,z} \sim_3 \tup{x',y',z'} \iff x = x' \text{\ ou\ } y = y'
$$
A $\sim_3$ é uma relação de equivalência?

\hint
Ache um contraexemplo que refuta sua transitividade.

\endexercise

\exercise.
Seja $R$ uma relação binária num conjunto $A$.
O.s.s.e.:
\item{(i)} $R$ é uma relação de equivalência;
\item{(ii)} $R$ é reflexiva e circular;
\item{(iii)} $R$ é reflexiva e triangular.

\endexercise

\exercise.
\label{how_many_equivalent_relations_on_3}%
Seja $A$ conjunto com $\card A = 3$.
Quantas relações de equivalência podemos definir no $A$?

\hint
Deixe para responder junto com o~\ref{how_many_partitions_on_3}.

\endexercise

\note Partição.
Voltamos de novo para nosso conjunto $A$, mas essa vez sem uma predeterminada
propriedade para focar.  Essa vez vamos dividir os elementos do $A$ em
\dterm{classes}, tais que cada membro do $A$ pertencerá em
\emph{exatamente uma delas}, e cada uma delas terá pelo menos um membro do $A$.
E nem vamos justificar essa separação, explicando o como ou o porquê.
Essa colecção de classes vamos definir agora:

\definition.
\label{partition}%
\tdefined{partição}%
Seja $A$ conjunto e $\scr A$ uma família de subconjuntos de $A$:
$$
\scr A \subseteq \powerset A.
$$
$\scr A$ é uma \dterm{partição} de $A$, sse:
\item{(i)} $\Union \scr A = A$;
\item{(ii)} os membros de $\scr A$ são disjuntos dois-a-dois;
\item{(iii)} $\emptyset \notin \scr A$;
\endgraf\noindent
Chamamos de \dterm{classes} os elementos de $\scr A$.

\exercise.
\label{partitions_of_seven}
Seja $A=\set{0,1,2,3,4,5,6}$.
Quais das colecções seguintes são partições do $A$?:
$$
\alignat 2
\scr A_1 &= \big\{ \set{0,1,3}, \set 2, \set{4,5}, \set 6 \big\}                &\quad\scr A_5 &= \big\{ \set{0,1,2}, \set{2,3,4}, \set{4,5,6} \big\} \\
\scr A_2 &= \big\{ \set{0,1,2,3}, \emptyset, \set{4,5,6} \big\}                 &\scr A_6 &= \big\{ \set{1,2}, \set{0,3}, \set 5, \set 6 \big\}  \\
\scr A_3 &= \big\{ \set{0,1,2,3,4,5,6} \big\}                                   &\scr A_7 &= \big\{ \set{0,1,2}, \set 3, \set{4,5,6,7} \big\}    \\
\scr A_4 &= \big\{ \set 0, \set 1, \set 2, \set 3, \set 4, \set 5, \set 6 \big\}&\scr A_8 &= \big\{ \set 0, \set{1,2}, \set{6,5,4,3} \big\}        
\endalignat
$$

\endexercise

\exercise.
Podemos trocar o (ii) da~\ref{partition} por
$$
\text{(ii$'$)}\quad\Inters \scr A = \emptyset\  ?
$$

\hint
Não: nossa definição vai permitir mais colecções ser chamadas ``partição'' do que deveriam.

\hint
Uma das colecções não-partições do~\ref{partitions_of_seven} vai
acabar sendo partição.

\solution
A $\scr A_5\subseteq\powerset A$ do~\ref{partitions_of_seven} satisfaz as
$$
\Union \scr A_5 = A,
\qqqquad
\Inters \scr A_5 = \emptyset,
$$
mas não é uma partição: o $2\in A$ por exemplo, pertenceria em duas classes
diferentes, algo contra da nossa idéia de ``partição''.

\endexercise

\note Dois lados da mesma moeda.
Os dois conceitos de ``relação de equivalência'' e ``partição'',
parecem diferentes mas realmente são apenas duas formas diferentes de
expressar a mesma idéia.
Cada relação de equivalência determina uma partição;
e vice-versa: cada partição determina uma relação de equivalência:

\exercise.
Escreva claramente como definir uma partição dum conjunto $A$,
dada uma relação de equivalência $\sim$ no $A$
Prove que realmente é uma partição
(a partição \dterm{induzida} pela $\sim$).

\endexercise

\exercise.
Escreva claramente como definir uma relação de equivalência num conjunto $A$,
dada uma partição $\scr A$ do $A$.
Prove que realmente é uma relação de equivalência
(a relação de equivalência \dterm{induzida} pela $\scr A$).

\endexercise

\exercise.
\label{how_many_partitions_on_3}%
Seja $A$ conjunto finito com $\card A = 3$.
Quantas partições de $A$ existem?

\endexercise

\definition.
\label{equivalent_class}%
\tdefined{classe de equivalência}%
\sdefined {\eqclass {\holed a} {\holed R}} {classe de equivalência do $\holed a$ atravez da $\holed R$}%
\sdefined {\eqclassimp {\holed a}} {classe de equivalência do $\holed a$ (relação implícita pelo contexto)}%
\sdefined {\quotset {\holed A} {\holed R}} {conjunto quociente do $\holed A$ por $\holed R$}%
Seja $A$ um conjunto e $\sim$ uma relação de equivalência no $A$.
Para cada $a\in A$, definimos a \dterm{classe de equivalência do} $a$
como o conjunto
$$
\eqclass a {\sim} \defeq \set {x\in A \st x\sim a},
$$
e quando a relação de equivalência é implicita pelo contexto
denotamos apenas por $\eqclassimp a$.
Definimos também o \dterm{conjunto quociente} de $A$ por $\sim$:
$$
\quotset A {\sim} \defeq \set {\eqclass a {\sim} \st a \in A }.
$$

\exercise.
Sejam $\sim$ uma relação de equivalência num conjunto $X$, e $x,y\in X$.
O.s.s.e.:
\item{(i)} $x\sim y$
\item{(ii)} $\eqclassimp x = \eqclassimp y$
\item{(iii)} $\eqclassimp x \inters \eqclassimp y \neq \emptyset$.

\endexercise

\exercise.
Descreva geometricamente e algebricamente as classes de equivalência das $\sim_1$
e $\sim_2$ do~\ref{equivalent_relations_on_euclidean_space}.

\endexercise

\exercise.
Seja $m\in\nats$.
Prove que a relação binária nos inteiros definida pela
$$
a \sim_m b \defiff a \cong b \pmod m
$$
é uma relação de equivalência.
Qual é a partição dos inteiros correspondente?

\endexercise

\definition.
\label{kernel_coimage}
\tdefined{kernel}
\tdefined{coimagem}
\sdefined {\ker {\holed f}} {kernel da \holed f}
\sdefined {\coim {\holed f}} {coimagem da \holed f}
\def\frel##1{\approx_{##1}}
Seja $f : X \to Y$ e defina a relação binária $\frel f$ no $X$ pela
$$
x_1 \frel f x_2 \defiff f(x_1)=f(x_2).
$$
Chamamos a $\frel f$ o \dterm{kernel} da $f$, e seu conjunto quociente a \dterm{coimagem} da $f$.
Usamos também os símbolos $\ker f$ e $\coim f$ respectivamente.

\exercise.
\def\frel#1{\approx_{#1}}
Com os dados da~\ref{kernel_coimage}
mostre que $\frel f$ é uma relação de equivalência e descreva os elementos da coimagem.
O que podemos dizer se $f$ é injetora?  Se ela é sobrejetora?

\endexercise

\exercise.
Seja real $\varepsilon\in(0,1)$, e defina a relação $\approx_{\varepsilon}$:
$$
x \approx_{\varepsilon} y \defiff (x-y)^2 < \varepsilon.
$$
A $\approx_{\varepsilon}$ é uma relação de equivalência?

\hint
Primeiramente resolve o mesmo problema mas para a relação:
$$
x \sim_{\varepsilon} y \defiff |x-y| < \varepsilon.
$$

\hint
Reflexividade e simetria das $\sim_{\varepsilon}$ e $\approx_{\varepsilon}$ são imediatas.
Sobre a transitividade, um desenho na linha real ajudaria.

\hint
Como podes usar a não-transitividade da $\sim_{\varepsilon}$
para deduzir a não-transitividade da $\approx_{\varepsilon}$?

\hint
Para todo $\alpha\in\reals$ com $\alpha\geq0$, temos:
$$
\cdots
\iff
\sqrt{\alpha}\in(0,1)
\iff
\alpha\in(0,1)
\iff
\alpha^2\in(0,1)
\iff
\cdots
$$

\endexercise

\endsection
%%}}}

%%{{{ Operations 
\section Operações.
%TODO Operações em relações, inversão, composição.

Relação inversa.
Composição.

\property.
Sejam as relações binárias:
$R$ de $A$ para $B$;
$S$ de $B$ para $C$; e
$T$ de $C$ para $D$.
Então
$$
(R\rcom S)\rcom T = R \rcom (S\rcom T),
$$
e logo podemos escrever apenas $R\rcom S\rcom T$.
\sketch.
Supomos $a \in A$ e $d\in D$, e mostramos a equivalência
$$
a \rel{((R\rcom S)\rcom T)} d
\iff
a \rel{(R\rcom (S\rcom T))} d.
$$
aplicando a definição de $\rcom$ e leis da lógica.
\qes
\proof.
Suponha $a\in A$ e $d\in D$.  Temos:
$$
\alignat 2
a \rel{((R\rcom S)\rcom T)} d
&\iff \lexists {c\in C} { a \rel{(R\rcom S)} c \;\land\; c \rel{T} d } \qqby{def.~de $\rcom$} \\
&\iff \lexists {c\in C} { \lexists {b\in B} {x \rel{R} b \;\land\; b \rel{R} c } \;\land\; c \rel{T} d } \qqby{def.~de $\rcom$} \\
&\iff \lexists {c\in C} { \lexists {b\in B} { \paren{ a \rel{R} b \;\land\; b \rel{R} c } \;\land\; c \rel{T} d } } \qqby{lógica} \\
&\iff \lexists {b\in B} { \lexists {c\in C} { \paren { a \rel{R} b \;\land\; b \rel{R} c } \;\land\; c \rel{T} d } } \qqby{lógica} \\
&\iff \lexists {b\in B} { \lexists {c\in C} { a \rel{R} b \;\land\; \paren{ b \rel{R} c \;\land\; c \rel{T} d } } } \qqby{lógica} \\
&\iff \lexists {b\in B} { a \rel{R} b \;\land\; \lexists {c\in C} {  b \rel{R} c \;\land\; c \rel{T} d } } \qqby{lógica} \\
&\iff \lexists {b\in B} { a \rel{R} b \;\land\; { b \rel{(R\rcom T)} d } } \qqby{def.~de $\rcom$} \\
&\iff a \rel{(R\rcom(S\rcom T))} d \qqby{def.~de $\rcom$}.
\endalignat
$$
\qed

\exercise.
Define formalmente a ``exponenciação'' $R^n$ duma dada relação binária $R$
num conjunto, informalmente definida por:
$$
x\mathrel{\paren{R^n}}y \pseudodefiff
x\mathrel{\Big(\underbrace{R\rcompose \dotsb\rcompose R}_{\text{$n$ vezes}}\Big)}y,
$$
valida \emph{para todo $n\in\nats$}.

\hint
Questão: o que precisa achar para tua definição servir para o caso $n=0$ também?

\hint
Resposta: precisa achar o elemento neutro da operação $\rcompose$.
Qual é?

\solution
Definimos:
$$
\align
x\mathrel{\paren{R^{0}}}y   &\defiff x=y\\
x\mathrel{\paren{R^{n+1}}}y &\defiff x\mathrel{\paren{R\rcompose {R^n}}}y
\endalign
$$

\endexercise

\endsection
%%}}}

%%{{{ Closures 
\section Fechos.

\exercise.
\label{isPred}
Considere a relação $\to$ no $\nats$, definida pela:
$$
x\to y \defiff x + 1 = y.
$$
Descreva as relações seguintes:
\item{$\transcl{\to}$}: seu fecho transitivo;
\item{$\rtranscl{\to}$}: seu fecho reflexivo transitivo;
\item{$\rtranscl{\leftrightarrow}$}: seu fecho reflexivo transitivo simétrico.
\endgraf\noindent
Descreva o conjunto quociente $\quotset{\nats}{\rtranscl{\leftrightarrow}}$.

\endexercise

\exercise.
Considere a relação $\to$ definida pela mesma equação como no \ref{isPred},
mas essa vez no conjunto $\reals$.
Descreva os mesmos fechos e o
$\quotset{\reals}{\rtranscl{\leftrightarrow}}$.

\endexercise

\endsection
%%}}}

%%{{{ Recursive and mutually recursive relations 
\section Relações recursivas e mutualmente recursivas.

\endsection
%%}}}

%%{{{ Order relations 
\section Relações de ordem.

\endsection
%%}}}

%%{{{ Logic programming 
\section Programação lógica.
\label{logic_programming}%

\endsection
%%}}}

%%{{{ Problems 
\problems.

\problem.
Define no $\ints\times(\ints\setminus\set0)$ a relação
$$
\tup{a,b} \approx \tup{c,d}
\defiff
ad = bc
$$
Mostre que $\approx$ é uma relação de equivalência
e descreva suas classes de equivalência.

\endproblem

\problem.
Define no $\rats$ a relação
$$
r \sim s \defiff r-s\in\ints.
$$
Prove que $\sim$ é uma relação de equivalência e descreva as classes do $\quotset {\rats} {\sim}$.

\endproblem

\problem.
Define no $\reals$ a relação
$$
x \sim y \defiff x-y\in\rats.
$$
Prove que $\sim$ é uma relação de equivalência e descreva as classes do $\quotset {\reals} {\sim}$.

\endproblem

\problem.
Define no $(\nats\to\nats)$ as relações seguintes:
$$
\align
f \mathrel{\buildrel{{}_{\exists\forall}} \over =} g &\defiff (\exists n\in\nats) (\forall x \geq n) [ f(x) = g(x) ]\\
f \mathrel{\buildrel{{}_{\forall\exists}} \over =} g &\defiff (\forall n\in\nats) (\exists x \geq n) [ f(x) = g(x) ]
\endalign
$$
Para cada uma das relações em cima, decida se ela é relação de equivalência,
e se é, descreva seu conjunto quociente.

\endproblem

\problem Números Bell.
\label{how_many_partitions}
Seja $A$ conjunto finito.
Quantas partições de $A$ podemos definir?

\hint
Conte ``manualmente'' os casos com $\card A = 0, 1, 2, 3$.

\hint
(Os números que tu achou na dica anterior devem ser: $1$, $1$, $2$, e $5$, respectivamente.)
Chame $B_n$ o número de partições dum conjunto finito com $n$ elementos.
Use recursão para definir o $B_n$.

\hint
Já temos umas bases desde a dica anterior:
$$
\align
B_0 &= 1\\
B_1 &= 1\\
B_2 &= 2\\
B_3 &= 5
\intertext{Para a equação recursiva,}
B_{n+1} &= \dots
\endalign
$$
lembra-se que podes considerar conhecidos \emph{todos} os números
$B_k$ para $k \leq n$.

\hint
Sejam $a_0,\dots,a_n$ os $n+1$ elementos de $A$
e considere uma partição arbitrária $\scr A$ dele.
Sendo partição, existe exatamente um conjunto-classe $A_0$ no $\scr A$
tal que $a_0\in A_0$.
Influenciados por a notação de classes de equivalência, denotamos
o $A_0$ por $\eqclassimp {a_0}$.
Tirando esse conjunto da partição $\scr A$ chegamos no
$$
\scr A \setminus \set {\eqclassimp {a_0}}
$$
que é (certo?) uma partição do conjunto
$$
\Union\paren{\scr A \setminus \set {\eqclassimp {a_0}}}.
$$
Seja $k$ o número de elementos desse conjunto.
Quais são os possíveis valores desse $k$?

\hint
Vamos melhorar nossa notação para nos ajudar raciocinar.
O conjunto 
$$
\Union\paren{\scr A \setminus \set {\eqclassimp {a_0}}}.
$$
da dica anterior, depende em que?
Como a gente fixou uma enumeração dos elementos do $A$,
ele depende apenas na partição $\scr A$.
Introduzimos então a notação
$$
R_{\scr A} \asseq
\Union\paren{\scr A \setminus \set {\eqclassimp {a_0}}}.
$$
E denotamos o $k$ da dica anterior com
$k_{\scr A} \asseq \card {R_{\scr A}}$.
O $k_{\scr A}$ da dica anterior pode ter qualquer um dos valores
$k_{\scr A}=0,\dotsc,n$.
E agora?

\hint
Agora separe todas as partições $\scr A$ de $A$ em grupos dependendo
no valor de $k_{\scr A}$, ache o tamanho de cada grupo separadamente,
e use o princípio da adição para achar a resposta final.

\hint
Todas as partições do $A$ são separadas assim em:
\beginul
\li as partições $\scr A$ de $A$ tais que $k_{\scr A} = 0$.
\li as partições $\scr A$ de $A$ tais que $k_{\scr A} = 1$.
\li \dots
\li as partições $\scr A$ de $A$ tais que $k_{\scr A} = n$.
\endul
Seja
$N_i$
o número das partições $\scr A$ de $A$ tais que $k_{\scr A} = i$.
Graças ao princípio da adição, procura-se o somatório $\sum_{i=0}^n N_i$.
Ache o valor do arbitrário $N_i$.

\hint
De quantas maneiras pode acontecer que o
$$
R_{\scr A} = \Union\paren{\scr A \setminus \set {\eqclassimp {a_0}}}
$$
tem $i$ elementos?

\hint
Sabemos que o $a_0$ não pode ser um deles,
então precisamos escolher $i$ elementos dos $n$ seguintes: $a_1, \dotsc, a_n$.
Ou seja, de $\comb n i$ maneiras.
Cada escolha $A_i$ corresponde numa colecção de partições:
$$
\Big\{
\eqclassimp {a_0}\ 
,
\underbrace{\quad\dots\quad}_{\hbox{partição do $A_i$}}
\Big\}
$$

\hint
Sabemos a quantidade de partições de qualquer conjunto de tamanho $i$
com $i\leq n$: são $B_i$.

\solution
Seguindo todas as dicas, basta definir:
$$
\align
B_0 &= 1\\
B_{n+1}
&= \sum_{i=0}^n N_i
= \sum_{i=0}^n \comb n i B_i
\endalign
$$
\tdefined{Bell numbers}
Essa seqüência de números é conhecida como números \Bell[números]{}Bell.

\endproblem

\ignore{

\problem.
No $(\nats\to\reals)$ defina a relação
$$
a\sim b \defiff \text{$\lim_{n\to+\infty} a_n = \lim_{n\to+\infty} b_n$\quad\text{ou}\quad\text{nenhum dos dois limites é definido.}}
$$
descreva o $(\nats\to\reals)/\sim$.

\endproblem

}

\problem.
Sejam conjunto $A$ com $\card A=1$, e $n\in\nats$ com $n\leq 2$.
No $A^n$ defina:
$$
a \sim b
\defiff
\card{ \set{ i\in\finord n \st a_i = b_i } } \geq n/2,
$$
onde
$a \eqass \tup{ a_0, \dotsc, a_{n-1}}$
e
$b \eqass \tup{ b_0, \dotsc, b_{n-1}}$.
A $\sim$ é uma relação de equivalência?

\solution
Não é.
Sejam $s,t,u\in A$ distintos dois a dois.
Tome
$$
\align
a &\leteq \tup{ s,s,\dots,s,t,t,\dotsc,t }\\
b &\leteq \tup{ s,s,\dots,s,u,u,\dotsc,u }\\
c &\leteq \tup{ t,t,\dots,t,u,u,\dotsc,u }
\endalign
$$
como contraexemplo, pois temos
$a \sim b$ e $b \sim c$ mas $a\not\sim c$.

\endproblem

\endproblems
%%}}}

%%{{{ Further reading 
\further.

O \cite[Cap.~4]{velleman} defina e trata relações
diretamente como conjuntos, algo que não fazemos nesse texto.
De novo: muitos livros seguem essa abordagem, então o leitor é conselhado
tomar o cuidado necessário enquanto estudando esses assuntos.
Nos vamos ver relações como conjuntos apenas no~\ref{axiomatic_set_theory}.

Sobre programação lógica:
\cite{lpbook},
\cite{artofprolog},
\cite{holpbook}.

\endfurther
%%}}}

}

\endchapter
%%}}}

%%{{{ chapter: Asymptotic notation 
\chapter A notação assintótica.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite[Cap.~1]{dpv}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Cantor's paradise 
\chapter O paraíso de Cantor.

%%{{{ A bit of historical context 
\section Um pouco de contexto histórico.
\Cantor{}%
\Liouville{}%
\Hermite{}%
\Fourier{}%
\vonLindemann{}%
\Weierstrass{}%

\endsection
%%}}}

%%{{{ What is counting? 
\section O que é contar?.

\definition.
\sdefined {\finord {\holed n}} {o conjunto $\set {0,\dotsc,n-1}$}
\label{finord}
Como usamos bastante o conjunto $\set{0,1,\dotsc,n-1}$,
vale a pena introduzir uma notação para o denotar:
$$
\finord n \pseudodefeq \set{0,\dotsc,n-1}.
$$

\exercise.
Defina o $\finord n$ usando a notação ``set-builder''.

\hint
Começa com o $\nats$ e filtre seus elementos usando suas relações de ordem.

\solution
Definimos
$$
\finord n \defeq \setst {i \in \nats} { 0 \leq i < n }.
$$

\endexercise

\exercise.
Defina o operador $\finord{\hole} : \nats \to \pset\nats$ recursivamente.

\hint
Cuidado com as operações e os ``tipos'' dos seus argumentos.

\solution
Qualquer uma das definições em baixo serve:
$$
\xalignat 2
\finord 0 &\defeq \emptyset                                     & \finord 0    &\defeq \emptyset\\
\finord n &\defeq \finord {n-1} \union \set{n-1}\qquad(n > 0)   & \finord {Sn} &\defeq \finord n \union \set n
\endxalignat
$$

\endexercise

\endsection
%%}}}

%%{{{ Equinumerosity 
\section Equinumerosidade.

\definition Eqüinúmeros.
\tdefined {eqüinúmeros}
\sdefined {\holed A \eqc \holed B} {os $A$ e $B$ são equinúmeros}
Chamamos os conjuntos $A$ e $B$ \dterm{eqüinúmeros} sse
existe bijeção $f : A \bijto B$.
Escrevemos:
$$
A \eqc B \defiff \lexists f {f : A \bijto B}.
$$

\exercise.
Prove que a relação $\eqc$ é uma relação de equivalência.

\endexercise

Continuamos em definir mais relações para comparar os tamanhos de conjuntos:

\definition.
\sdefined {\holed A \leqc \holed B} {o $A$ é menor-ou-igual em cardinalidade que o $B$}
\sdefined {\holed A \ltc \holed B}  {o $A$ é menor em cardinalidade que o $B$}
Sejam $A$ e $B$ conjuntos.
Definimos
$$
\align
A \leqc B &\defiff \lexists {B_0\subseteq B} {A \eqc B_0}\\
A \ltc B  &\defiff A\leqc B \mland A\neqc B
\endalign
$$
Seguindo nossa prática comum, usamos também $A\gtc B$ como sinónimo de $B\ltc A$,
$A \not\geqc B$ para significar que não é o caso que $B \leqc A$, etc.

\exercise.
Prove ou disprove a afirmação que podemos usar a seguinde definição como alternativa:
$$
A \ltc B \askiff \lexists {B_0\subsetneq B} {A \eqc B_0}.
$$

\hint
$\nats\ltc\ints$?

\endexercise

\proposition.
A $\eqc$ é:
$$
\align
\text{reflexiva:}\quad& A \eqc A;\\
\text{transitiva:}\quad& A \eqc B \mland B \eqc C \implies A \eqc C;\\
\text{simétrica:}\quad& A \eqc B \implies B \eqc A.
\endalign
$$
\sketch.
Usamos as bijeções seguintes: identidade, composição, inversa.
\qes

\proposition.
A $\leqc$ é:
$$
\align
\text{reflexiva:}              \quad &A \leqc A;\\
\text{transitiva:}             \quad &A \leqc B \mland B \leqc C \implies A \leqc C;\\
\text{não antisimétrica:}      \quad &A \leqc B \mland B \leqc A \nimplies A = B;\\
\text{``equiantissimétrica'':} \quad &A \leqc B \mland B \leqc A \implies A \eqc B.
\endalign
$$
\sketch.
Para as duas primeiras usamos a identidade e a composição respectivamente.
Para a próxima tomando $A\asseq \nats$ e $B\asseq \ints$ serve.
A última é realmente difícil para provar:
é um corolário direto
do teorema Schröder--Bernstein (\ref{schroder_bernstein}).
\qes

\exercise.
Quais das operações $\Union$, $\Intersection$, $\powerset$, $\to$, e $\times$ respeitam as cardinalidades?

\endexercise

\endsection
%%}}}

%%{{{ What is cardinality? 
\section O que é cardinalidade?.

\note A dupla abstração de Cantor.

\endsection
%%}}}

%%{{{ Guessing games 
\section Jogos de adivinhar.

\exercise.
Para cada um dos conjuntos seguintes, decida se é contável ou não.
$$
\align
I &= \setst {x\in\reals}   {\text{$x$ é irracional}}\\
A &= \setst {x\in\reals}   {\text{$x$ é algébrico}}\\
T &= \setst {x\in\reals}   {\text{$x$ é transcendental}}\\
C &= \setst {z\in\complex} {\modulus z = 1}\\
L &= \set {\text{os programas sintaticamente corretos numa linguagem de programação}}\\
G &= \graph(f), \quad \text{onde $f : \reals\to\reals$ definida pela $f(x) = x^2$}\\
D &= (\nats \to \set{0,2})\\
S &= (\nats \to \nats)\\
P &= (\nats \bijto \nats)\\
Z &= \setst {f\in(\nats\to\nats)} {(\exists n_0\in\nats)(\forall n>n_0)\left[\,f(n)=0\,\right]} 
\endalign
$$

\endexercise

\remark.
Para corresponder numa bijeção mesmo, o jogo tem que ser modificado, para
proibir repetições do mesmo palpite.
Observamos que se o jogador tem uma estratégia para ganhar num jogo que 
permite repetições de palpites, ele já pode a adaptar, para ganhar no 
jogo com a restrição: ele apenas segue a estratégia do jogo ``livre''
e quando aparecem palpites que ele já adivinhou, ele pula para o próximo,
até chegar num palpite que ele não tentou ainda, para o tentar. 
Por exemplo, para enumerar os racionais sabendo uma enumeração dos pares
de inteiros, copiamos a estrategia do $\ints^2$, pulando pares que ou não 
correspondem em racionais (como o $(0,0)$ por exemplo), ou que são iguais 
com palpites anteriores (como o $(2,4)$ que pulamos por causa do (1,2)).

\codeit EnumPairs.
\label{program_enumpairs}
Implemente uma estratégia para ganhar no jogo sem repetições com
conjunto-segredos o $\nats^2$.  Ou seja, escreva um programa que imprime (pra
sempre) os palpites do jogador na sua ordem. 
\endcodeit

\codeit EnumRatsReps.
\label{program_enumrats}
Modifique o EnumPairs para o caso com conjunto-segredos
o conjunto de racionais não-negativos, mas permitindo repetições. 
Represente cada palpite como fracção,
imprimindo por exemplo o racional $\frac 1 3$ como o string
``{\tt 1/3}''.
\endcodeit

\codeit EnumRats.
\label{program_enumratsnoreps}
Modifique o EnumRats para o caso que o jogo proibe
repetições (mas para o mesmo conjunto $\rats_{\geq0}$). 
\endcodeit

\exercise Jogador amnésico.
Ache uma estratégia para ganhar no jogo com conjunto-segredos o 
conjunto dos racionais não-negativos, se o jogador tem memória que o 
permite lembrar apenas seu último palpite!

\endexercise

\exercise.
\label{nextPair}
Defina uma função 
$\namedop{nextPair} : \nats^2 \to \nats^2$
tal que para cada entrada $(n,m)$ ela retorna o próximo palpite do jogador 
que acabou de tentar o $(n,m)$, no jogo com conjunto-segredos o $\nats^2$. 
Considera que sua estratégia começa com o palpite $(0,0)$. 
Assim, a enumeração representada por a estratégia do jogador seria a: 
$$
    (0,0), f(0,0), f^2(0,0), f^3(0,0), \dotsc,
$$
ou seja, a seqüência $\set{ f^n (0,0) }_{n}$.

\endexercise

\codeit NextPair.
Implemente função do~\ref{nextPair}.
\endcodeit

\codeit RatApprox.
\label{program_ratapprox}
Usando uma implementação de enumeração $\set{q_n}_n$ do $\rats$
(com ou sem repetições), implemente uma função
$a : \reals\times\reals \to \nats$ que, dados $x\in\reals$ e $\varepsilon>0$
retorna o primeiro $n\in\nats$ com a propriedade $\abs{q_n - x} < \varepsilon$:
$$
a(x,\varepsilon) = \min\setst{n\in\nats}{\abs{q_n-x}<\varepsilon}.
$$
\endgraf
Se tua linguagem de programação suporta funções de ordem superior,
considere que seu primeiro argumento deve ser a própria enumeração $q$:
$$
\align
\namedfun{ratApprox} &\eqtype (\nats\to\rats) \to \reals \to \reals \to \nats\\
\namedfun{ratApprox}\ q\ x\ \varepsilon &= \min\setst{n\in\nats}{\abs{q_n-x}<\varepsilon}
\endalign 
$$
Alternativamente, pode representar uma enumeração de racionais
como uma lista (infinita) de racionais.  Considere retornar o
primeiro racional suficientemente próximo alem de apenas seu
indice.  Improvise e teste sua função, vendo quanto ``demora''
uma enumeração para chegar suficientemente perto de um número
pre-determinado, sendo racional ou não.
Por exemplo, use $x=\sqrt 2$ ou $e$ ou $\pi$,
e
$\varepsilon=1, 1/2, 1/4, \dotsc$.
Assim, para qualquer real $x$, tu pode
\emph{construir}---mesmo não muito ``eficientemente''---uma
seqüência de racionais que converge em $x$, apenas aplicando a função
$\lambda \varepsilon. \namedfun{ratApprox}\ q\ x\ \varepsilon$
em argumentos que formam qualquer seqüência que convirja no zero!
\endcodeit

\endsection
%%}}}

%%{{{ Finite and infinite; countable and uncountable 
\section Finitos e infinitos; contáveis e incontáveis.

\definition.
\label{finite_set}
\label{infinite_set}
\tdefined{finito}
\tdefined{infinito}
O conjunto $A$ é \dterm{finito} sse existe $n\in\nats$ tal que $\finord n \eqc A$.
O conjunto $A$ é \dterm{infinito} sse $A$ não é finito.

\definition.
\label{countable_set}
\label{uncountable_set}
\tdefined{contável}[conjunto]
\tdefined{incontável}[conjunto]
O conjunto $A$ é \dterm{contável} sse $A$ é finito ou $\nats\eqc A$.
Usamos os termos \dterm{enumerável} e \dterm{denumerável} como sinónimos
de contável.
O conjunto $A$ é \dterm{incontável} sse $A$ não é contável.

\definition.
\label{enumeração}
\tdefined{enumeração}
Uma \dterm{enumeração} dum conjunto $A$ é qualquer surjecção
$\pi : \nats\surjto A$.
Assim temos:
$$
A = \img \pi {\nats} = \set{\pi(0), \pi(1), \pi(2), \dotsc}
$$

\proposition.
Seja $A$ conjunto.
O.s.s.e.:
\item{\rm (1)}   $A$ é contável
\item{\rm (2)}  $A \leqc \nats$
\item{\rm (3)} $A=\emptyset$ ou $A$ possui enumeração.
\sketch.
As direcões $(1)\Rightarrow(2)\Rightarrow(3)$ são conseqüências fáceis
das definições.  Para ``fechar o round-robin'' ($(3)\Rightarrow(1)$),
precisamos definir uma \emph{bijecção} $f : \nats\bijto A$, dados uma
\emph{surjecção} $\pi:\nats\surjto A$.  Usamos recursão e o princípio
da boa ordem.
\qes

\endsection
%%}}}

%%{{{ Cantor's first diagonal argument 
\section O primeiro argumento diagonal de Cantor.

\endsection
%%}}}

%%{{{ Cantor's segundo diagonal argument 
\section O segundo argumento diagonal de Cantor.

\exercise.
Por que não podemos usar o mesmo argumento para concluir que o $\setst{q \in \rats}{0\leq q\leq 1}$ também é incontável?

\hint
Como tu vai provar que o número construido pela método de Cantor realmente é um elemento de $\rats\inters[0,1]$?

\endexercise

\endsection
%%}}}

%%{{{ Some important applications 
\section Umas aplicações importantes da teoria de Cantor.

\note Os números racionais.

\note Os números irracionais.

\note Os números algebricos.

\note Os números transcendentais.

\endsection
%%}}}

%%{{{ Cantor set 
\section O conjunto de Cantor.

\endsection
%%}}}

%%{{{ Looking for bijections 
\section Procurando bijeções.

\endsection
%%}}}

%%{{{ The Schröder--Bernstein theorem 
\section O teorema Schröder--Bernstein.

\note Abordagem amorosa.

\theorem Schröder--Bernstein.
\Schroder{}\Bernstein{}%
\label{schroder_bernstein}%
\ii{teorema}[Schröder--Bernstein]%
Sejam conjuntos $A$ e $B$ e funções injetoras
$f : A \injto B$ e $g : B \injto A$.
Então existe bijeção $\phi : A \bijto B$.

\endsection
%%}}}

%%{{{ Looking for injections 
\section Procurando injeções.

\endsection
%%}}}

%%{{{ Encodings 
\section Codificações.

\endsection
%%}}}

%%{{{ The different infinities so far 
\section As diferentes infinidades até agora.

\endsection
%%}}}

%%{{{ Cantor's theorem and its consequences 
\section O teorema de Cantor e suas conseqüências.

\theorem Cantor.
\Cantor[teorema]%
\label{cantor_theorem}%
Seja $A$ conjunto.
Então $A\ltc \pset A$.

\corollary.
Existe uma infinidade (contável) de cardinalidades infinitas:
$$
\nats
\ltc \pset\nats
\ltc \pset\pset\nats
\ltc \pset\pset\pset\nats
\ltc \pset\pset\pset\pset\nats
\ltc \dotsc
$$

\definition.
\sdefined{\aleph_0}{a cardinalidade do $\nats$}%
\sdefined{\continuum}{a cardinalidade do $\pset\nats$ e do $\reals$}%
\tdefined{aleph 0}%
\tdefined{continuum}%
Denotamos a cardinalidade de $\nats$ por $\aleph_0$ (\dterm{aleph 0}),
e a cardinalidade de $\pset\nats\eqc\reals$ por $\continuum$.
Chamamos o $\continuum$ o \dterm{continuum}.

\corollary.
Não existe cardinalidade máxima: para qualquer conjunto $M$, o conjunto $\pset M$ tem cardinalidade maior.

\note.
Considere os conjuntos
$$
\emptyset
\ltc \pset\emptyset
\ltc \pset\pset\emptyset
\ltc \pset\pset\pset\emptyset
\ltc \pset\pset\pset\pset\emptyset
\ltc \dotsb
$$
Observe que cada conjunto nessa seqüência (infinita) de conjuntos é finito.
Mas, quais são suas cardinalidades?
Calculamos:
$$
\align
\card{\emptyset}                     &= 0\\
\card{\pset\emptyset}                &= 1\\
\card{\pset\pset\emptyset}           &= 2\\
\card{\pset\pset\pset\emptyset}      &= 4\\
\card{\pset\pset\pset\pset\emptyset} &= 8\\
                                     &\eqvdots\\
\endalign
$$
Observamos que a seqüência dessas cardinalidades ``tem burácos''.
Por exemplo, nenhum desses conjuntos tem cardinalidade $3$,
mesmo que realmente tem conjuntos com essa cardinalidade
(por exemplo o $\finord 3=\set{0,1,2}$).
Ou seja, existe conjunto $C$ com
$$
\pset\pset\emptyset\ltc C\ltc \pset\pset\pset\emptyset.
$$
Similarmente achamos conjuntos ``estritamente entre'' os conjuntos que aparecem
depois nessa seqüência.

Será que tem conjuntos ``estritamente entre'' alguns dos conjuntos infinitos
da seqüência anterior?

Será que tem algum conjunto incomparável com todos eles?

Será que tem algum conjunto com cardinalidade maior que qualquer uma das
cardinalidades deles?

\endsection
%%}}}

%%{{{ Cardinal comparability 
\section Comparabilidade de cardinais.

\endsection
%%}}}

%%{{{ The continuum hypothesis 
\section Hipótese do continuum.

\endsection
%%}}}

%%{{{ Ordinal vs. cardinal numbers 
\section Números ordinais vs.~cardinais.
\endsection
%%}}}

%%{{{ A taste of measure theory 
\section Um toque de teoria de medida.

\endsection
%%}}}

%%{{{ Problems 
\problems.

% Cantor's letter to Dedekind and Dedekind's reply 

\endproblems
%%}}}

%%{{{ Further reading 
\further.

Sobre a teoria de conjuntos de Cantor:
\cite{kleeneIM},
\cite{ynmnst}.

Sobre teoria da medida:
\cite{bartlemeasure},
\cite{halmosmeasure},
\cite{taylorintegration}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Structured sets 
\chapter Conjuntos estruturados.

%%{{{ Definitions
\section Definições.

\note Abuso notacional.
\label{notational_abuse_stuctured_sets}
Suponha $\ssetfont A = \sset A {\dotsc}$ é algum conjunto estruturado.
Tecnicamente falando, escrever ``$a\in \ssetfont A$'' seria errado.
Mesmo assim escrevemos sim $a\in \ssetfont A$ ao inves de $a\in A$,
similarmente falamos sobre ``os elementos de~$\ssetfont A$''
quando na verdade estamos se referendo aos elementos de~$A$,
etc.
Em geral, quando aparece um conjunto estruturado~$\ssetfont A$ num contexto
onde deveria aparecer algum conjunto, identificamos o~$\ssetfont A$
com seu carrier set~$A$.
As vezes usamos até o mesmo símbolo na sua definição, escrevendo
$A = \sset A {\dotsc}$.
\endsection
%%}}}

%%{{{ Operations 
\section Operações.

\endsection
%%}}}

%%{{{ Respectful mappings
\section Mapeamentos respeitosos.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Group theory 
\chapter Teoria de grupos.

%%{{{ Permutations 
\section Permutações.

\note.
\ii{permutação}%
Vamos começar considerando o conjunto $S_n$ de todas as permutações
dum conjunto com $n$ elementos.  Tomamos o $\set{1,2,\dotsc,n}$ como
nosso conjunto mas sua escolha é inessencial.
Logo, temos por exemplo
$$
S_3 \defeq (\set{1,2,3}\bijto\set{1,2,3}).
$$
Quantos elementos o $S_3$ tem?
Lembramos%
\footnote{Se não lembramos, veja a~\ref{total_permutations} e a~\refn{permutations_and_combinations} em geral!}
que são
$$
\card{S_3} = \arrange 3 = 3! = 3\ntimes 2\ntimes 1 = 6.
$$
Nosso primeiro objetivo é achar todos esses $6$ membros de $S_3$.
\endgraf
Primeiramente, a identidade $\idof {S_3} \in S_3$ pois é bijetora.
Para continuar, introduzimos aqui uma notação bem prática para
trabalhar com permutações:

\note Notação.
Denotamos a bijeção $f \in S_n$ assim:
$$
f = \permf{
1    & 2    & \dotsb & n\\
f(1) & f(2) & \dotsb & f(n)
}
$$
Por exemplo, a identidade de $S_3$,
e a permutação $\phi$ que troca apenas o primeiro com o segundo elemento
são denotadas assim:
$$
\xalignat2
\id
&= \permf{
1 & 2 & 3\\
1 & 2 & 3
}
&
\phi
&\asseq \permf{
1 & 2 & 3\\
2 & 1 & 3
}
\endxalignat
$$
Considere agora uma permutação do $S_8$ e uma do $S_{12}$ por exemplo as
$$
\align
\permf{
1 & 2 & 3 & 4 & 5 & 6 & 7 & 8\\
2 & 3 & 1 & 4 & 6 & 5 & 7 & 8
}
\quad&\text{e}\quad
\permf{
1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12\\
2 & 3 & 1 & 4 & 5 & 10 & 6 & 11 & 9 & 12 & 8 & 7
}.
\intertext{Podemos as quebrar em ``ciclos'' escrevendo}
\permc{1 & 2 & 3}
\permc{5 & 6}
\quad&\text{e}\quad
\permc{1 & 2 & 3}
\permc{6 & 10 & 12 & 7}
\permc{8 & 11}
\endalign
$$
respectivamente.
Entendemos o ciclo $\permc{1 & 2 & 3}$ como
$1 \mapsto 2 \mapsto 3 \mapsto 1$.

\exercise.
Verifique que as duas permutações que escrevemos usando ciclos
realmente correspondem nas permutações anteriores.

\endexercise

\note Cuidado.
Para usar a notação com ciclos para denotar os membros de algum
$S_n$, precisamos esclarecer o $n$---algo que não é necessário
com a notação completa, onde esta informação é dedutível pela
sua forma.  Por exemplo as duas permutações
$$
\underbrace{
\permf{
1 & 2 & 3 & 4 & 5\\
2 & 1 & 3 & 5 & 4
}}_{\permc{1 & 2}\permc{4 & 5}}
\quad\text{e}\quad
\underbrace{
\permf{
1 & 2 & 3 & 4 & 5 & 6 & 7\\
2 & 1 & 3 & 5 & 4 & 6 & 7
}}_{\permc{1 & 2}\permc{4 & 5}}
$$
compartilham a mesma forma usando a notação com cíclos!
Olhando para as formas em cima, sabemos que a primeira
é uma permutação do $S_5$, e a segunda do $S_7$.
\endgraf
Mais um defeito dessa notação é que não temos como denotar
a identidade numa forma consistente, então concordamos
a denotar pelo $\permc {1}$.

\note Os membros de $S_3$.
Já achamos $2$ dos $6$ elementos de $S_3$:
$$
\xalignat2
\idof {S_3}
&=\permf{
1 & 2 & 3\\
1 & 2 & 3
}
&
\phi
&\leteq\permf{
1 & 2 & 3\\
2 & 1 & 3
}
=\permc{1 & 2}
\endxalignat
$$
Sabendo
que a composição de bijeções é bijeção (\ref{composition_respects_jections}),
tentamos a
$$
\phi^2 = \phi\com\phi
=\permf{
1 & 2 & 3\\
2 & 1 & 3
}\com\permf{
1 & 2 & 3\\
2 & 1 & 3
}
=\permf{
1 & 2 & 3\\
1 & 2 & 3
}
=\id
$$
e voltamos para a propria $\id$!
Uma outra permutação no $S_3$ é a
$$
\psi\leteq\permf{
1 & 2 & 3\\
2 & 3 & 1
}
=\permc{1 & 2 & 3}.
$$
Vamos agora ver quais diferentes permutações ganhamos combinando essas:
$$
\align
\psi^2
= \psi\com\psi
&=\permf{
1 & 2 & 3\\
2 & 3 & 1
}\com\permf{
1 & 2 & 3\\
2 & 3 & 1
}
=\permf{
1 & 2 & 3\\
3 & 1 & 2
}
=\permc{1 & 3 & 2}
\\
\phi\com\psi
&=\permf{
1 & 2 & 3\\
2 & 1 & 3
}\com\permf{
1 & 2 & 3\\
2 & 3 & 1
}
=\permf{
1 & 2 & 3\\
1 & 3 & 2
}
=\permc{2 & 3}\\
\psi\com\phi
&=\permf{
1 & 2 & 3\\
2 & 3 & 1
}\com\permf{
1 & 2 & 3\\
2 & 1 & 3
}
=\permf{
1 & 2 & 3\\
3 & 2 & 1
}
=\permc{1 & 3}
\endalign
$$
Achamos todos os membros de $S_3 = \set{\id, \phi, \psi, \psi^2, \phi\com\psi,\psi\com\phi}$:
$$
\alignat2
\id &= \permc {1}           &\psi^2 &= \permc {1 & 3 & 2}  \\
\phi &= \permc {1 & 2}      &\phi\com\psi &= \permc {2 & 3}\\
\psi &= \permc {1 & 2 & 3}  \qquad\qquad&\psi\com\phi &= \permc {1 & 3}  
\endalignat
$$

\exercise.
Calcule a $\psi\com\psi^2$ e justifique que
ela é igual à $\psi^2\com\psi$.

\endexercise

\exercise.
Calcule as $\phi\com\psi^2$ e $\psi^2\com\phi$.

\endexercise

\exercise.
Ache o inverso de cada elemento de $S_3$.

\endexercise

\note Abstraindo.
Temos um conjunto cujos elementos podemos ``combinar'' atravez duma operação binária.
Observamos que nosso exemplo tem as propriedades:
\beginil
\item{(G0)}
O conjunto é fechado sobre a operação.%
\footnote{Aplicando a operação em quaisquer membros do nosso conjunto,
o resultado pertence no conjunto.}
\item{(G1)}
A operação é associatíva.
\item{(G2)}
A operação tem identidade no conjunto.
\item{(G3)}
Cada elemento do conjunto possui inverso no conjunto.
\endil
\endgraf
Conjuntos onde é definida uma operação que satisfaz essas propriedades
aparecem com freqüência, e vamos ver que são suficientes para construir
uma teoria rica baseada neles.

\endsection
%%}}}

%%{{{ What is a group? 
\section O que é um grupo?.

%%{{{ df: group_def_wordy
\definition.
\label{group_def_wordy}%
Um conjunto $G$ com uma operação associativa é um \dterm{grupo} sse
ele fechado sobre a operação; possui identidade e todos os seus elementos
possuem inversos.
%%}}}

%%{{{ Multiplicative and additive groups 
\note Grupos multiplicativos e aditivos.
Dependendo da situação, podemos adoptar um ``jeito multiplicativo'' para a
notação dum grupo,
ou um ``jeito additivo'', ou ficar realmente com um jeito neutro.
Num \dterm{grupo multiplicativo} usamos $\cdot$ para denotar a operação do grupo,
aproveitamos a convenção de omitir o símbolo totalmente, usando apenas
juxtaposição: $a(bc)$ significa $a\cdot(b\cdot c)$ por exemplo.
A identidade parecerá com $e$ ou $1$, e $a^{-1}$ será o inverso de~$a$.
Num \dterm{grupo aditivo} usamos $+$ para denotar a operação do grupo,
a identidade parecerá com $e$ ou $0$; e $-a$ será o inverso de~$a$.
Naturalmente usamos $\ast$, $\bullet$, etc.~para denotar operação
de grupo, $e$ para sua identidade e $a^{-1}$ ou $a'$ para denotar o inverso de~$a$.
É importante entender que os termos ``grupo multiplicativo'' e ``grupo aditivo''
usados assim não carregam nenhum significado matemático mesmo: apenas mostram
uma preferência notacional.
Mas quando um conjunto já tem adição e/ou multiplicação definida
(como por exemplo os inteiros), então usamos frases como
``o grupo aditivo dos inteiros'' para referir no $\sset \ints +$.
%%}}}

%%{{{ df: group (1) 
\definition Grupo (1).
\label{group_def_classic}%
\tdefined{grupo}%
Um conjunto $G$ com uma operação $\ast$ é um \dterm{grupo} sse:
$$
\gather
a,b \in G \implies a\ast b \in G                                                \tag{G0} \\
a\ast(b\ast c) = (a\ast b)\ast c                                                \tag{G1} \\
\text{existe $e\in G$ tal que para todo $a\in G$, $e\ast a = a = a\ast e$}      \tag{G2} \\
\text{para todo $a\in G$, existe $a'\in G$, tal que $a'\ast a = e = a \ast a'$} \tag{G3}
\endgather
$$
%%}}}

\blah.
Para entender melhor as quatro leis de grupo, as escrevemos novamente, essa vez
sem deixar nenhum quantificador como implicito, e começando com um conjunto estruturado
com uma operação binária:

%%{{{ df: group (2) 
\definition Grupo (2).
\label{group_def_struct_2}%
\tdefined{grupo}%
Um conjunto estruturado $\ssetfont G = \sset G {\ast}$ é um grupo sse
$$
\alignat2
\paren{\forall a,b\in G}                      &\bracket{a\ast b \in G}                   &\tag{G0} \\
\paren{\forall a,b,c\in G}                    &\bracket{a\ast(b\ast c) = (a\ast b)\ast c}&\tag{G1} \\
\paren{\exists e\in G} \paren{\forall a \in G}&\bracket{e\ast a = a = a\ast e}           &\tag{G2} \\
\paren{\forall a\in G} \paren{\exists a'\in G}&\bracket{a'\ast a = e = a \ast a'}        &\tag{G3} 
\endalignat
$$
Chamamos o elemento garantido pela (G2) a \dterm{identidade} do grupo,
e o~$a'$ o \dterm{inverso} de~$a$.
%%}}}

%%{{{ x: check_group_def_classic_and_group_def_struct_2 
\exercise.
Tá tudo certo com as definições~\refn{group_def_classic} e~\refn{group_def_struct_2}?

\hint
Quem é esse $e$ que aparece no (G3)?

\hint
Como assim \emph{o} inverso?

\endexercise
%%}}}

%%{{{ df: group (3) 
\definition Grupo (3).
\label{group_def_struct_3}%
\tdefined{grupo}%
Um conjunto estruturado $\ssetfont G = \sset G {e, \ast}$ é um grupo sse
$$
\alignat2
\paren{\forall a,b\in G}                      &\bracket{a\ast b \in G}                   &\tag{G0} \\
\paren{\forall a,b,c\in G}                    &\bracket{a\ast(b\ast c) = (a\ast b)\ast c}&\tag{G1} \\
\paren{\forall a \in G}                       &\bracket{e\ast a = a = a\ast e}           &\tag{G2} \\
\paren{\forall a\in G} \paren{\exists a'\in G}&\bracket{a'\ast a = e = a \ast a'}        &\tag{G3} 
\endalignat
$$
%%}}}

%%{{{ x: check_group_def_struct_3 
\exercise.
Tá tudo certo com a~\ref{group_def_struct_3}?

\solution
Sim!

\endexercise
%%}}}

%%{{{ x: group (4) 
\exercise Grupo (4).
Defina ``grupo'' como um conjunto estruturado
$\sset G {e, {}^{\prime}, \ast}$.
Comece escrevendo as aridades da assinatura.

\solution
Um conjunto estruturado $\ssetfont G = \sset G {e, {}^{\prime}, \ast}$ é um \dterm{grupo} sse
$$
\alignat2
\paren{\forall a,b\in G}    &\bracket{a\ast b \in G}                   &\tag{G0} \\
\paren{\forall a,b,c\in G}  &\bracket{a\ast(b\ast c) = (a\ast b)\ast c}&\tag{G1} \\
\paren{\forall a \in G}     &\bracket{e\ast a = a = a\ast e}           &\tag{G2} \\
\paren{\forall a\in G}      &\bracket{a'\ast a = e = a \ast a'}        &\tag{G3} 
\endalignat
$$

\endexercise
%%}}}

%%{{{ Notational abuse 
\note Abuso notacional.
Lembra-se o abuso notacional que introduzímos
no~\refn{notational_abuse_stuctured_sets}:
usamos $a,b\in\ssetfont G$, $G=\sset G {\bullet}$, etc.
%%}}}

%%{{{ df: abelian group 
\definition Grupo abeliano.
\label{abelian_group}%
\tdefined{grupo!abeliano}%
Um grupo $\sset G {\ast}$ é \dterm{abeliano}
(também: \dterm{comutatívo})
sse sua operação $\ast$ é comutativa:
$$
\alignat2
\paren{\forall a,b\in G}    &\bracket{a\ast b = b\ast a}.                   &\tag{GA}
\endalignat
$$
%%}}}

%%{{{ df: order of group 
\definition Ordem de grupo.
\label{order_of_group}%
\tdefined{ordem!de grupo}%
\sdefined {\gord {\holed G}} {a ordem do grupo $\holed G$}%
O número de elementos de um grupo $G$ é sua \dterm{ordem}.
Denotamos a ordem de $G$ com:
$\gord G$, $\tord G$, ou até $\bord G$ quando não existe ambiguidade.
Se o carrier set do grupo é infinito, escrevemos
$\gord G = \infty$.
%%}}}

\endsection
%%}}}

%%{{{ Examples 
\section Exemplos.

\example Números.

\endexample

\exercise.
Mostre mais grupos formados de números dos
$\nats$, $\ints$, $\rats$, $\reals$, $\complex$,
e uma operação da sua escolha.

\endexercise

\example Matrizes.
\label{matrix_group_examples}%

\endexample

\example Aritmética modular.

\endexample

\example Simetrias.

\endexample

\definition.
\label{symmetric_group}%
\tdefined {grupo}[simétrico]%
\sdefined {S_{\holed n}} {O grupo simétrico $S_{\holed n}$}%
Usamos $S_n$ para denotar o conjunto de todas as permutações
dum conjunto de tamanho $n\in\nats$.
Para definir mesmo o $S_n$ escolhemos o conjunto canônico:
$$
S_n \pseudodefeq (\set{1,\dotsc,n}\bijto\set{1,\dotsc,n}).
$$
Para qualquer $n\in\nats$, chamamos o $\sset {S_n} {\fcom}$
o \dterm{grupo simétrico} de tamanho $n$.

\exercise.
Justifique a~\ref{symmetric_group}: prove que o grupo simétrico $S_n$
realmente é um grupo.

\endexercise

\exercise Funções reais.

\endexercise

\exercise Conjuntos.
Seja $A$ conjunto.
Com quais das operações $\union$, $\intersection$, $\symdiff$, $\setminus$
o $\pset A$ é um grupo?

\endexercise

\endsection
%%}}}

%%{{{ First consequences 
\section Primeiras conseqüências.

%%{{{ lm: uniqueness_of_identity_in_group 
\lemma Unicidade da identidade.
\label{uniqueness_of_identity_in_group}%
Em todo grupo $G$ existe exatamente uma identidade $e$
que satisfaz o $(G2)$.
%%}}}

%%{{{ lm: uniqueness_of_inverses_in_group 
\lemma Unicidade dos inversos.
\label{uniqueness_of_inverses_in_group}%
Em todo grupo $G$, cada $a\in G$ tem
exatamente um inverso $a^{-1}$ que satisfaz a (G3).
%%}}}

%%{{{ lm: inverse_of_inverse_in_group 
\lemma Inverso de inverso.
\label{inverse_of_inverse_in_group}%
Em todo grupo $G$, $\paren{a\ast b}^{-1} = b^{-1}\ast a^{-1}$
para todo $a,b\in G$.
%%}}}

%%{{{ lm: inverse_of_product_in_group 
\lemma Inverso de produto.
\label{inverse_of_product_in_group}%
Em todo grupo $G$, $\paren{a^{-1}}^{-1} = a$
para todo $a\in G$.
%%}}}

%%{{{ lm: cancellation_laws_in_group 
\lemma Leis de cancelação.
\label{cancellation_laws_in_group}%
Seja $G$ grupo.
Então as leis de cancelação pela esquerda e pela direita
$$
\alignat2
\paren{\forall a,x,y\in G}  &\bracket{a\ast x = a\ast y \implies x=y}            &\tag{GCL} \\
\paren{\forall a,x,y\in G}  &\bracket{x\ast a = y\ast a \implies x=y}            &\tag{GCR} \\
\endalignat
$$
são válidas em $G$
%%}}}

%%{{{ refute the arbitrary cancellation law 
\exercise.
Refuta: para todo grupo $\sset G {e, \ast}$ e $a,x,y\in G$
$$
a\ast x = y\ast a \implies x=y
$$

\endexercise
%%}}}

%%{{{ criterion: Cancellation-based group definition
\criterion Definição de grupo com cancelação.
\label{cancellation_based_group_def}%
Seja $\ssetfont G = \sset G {e, \ast}$ um conjunto \emph{finito}
estruturado que satisfaz:
$$
\align
\paren{\forall a,b\in G}                        &\bracket{a\ast b \in G}                    \tag{G0} \\
\paren{\forall a,b,c\in G}                      &\bracket{a\ast(b\ast c) = (a\ast b)\ast c} \tag{G1} \\
\paren{\forall a \in G}                         &\bracket{a\ast e = a}                      \tag{GCR} \\
\paren{\forall a\in G} \paren{\exists a'\in G}  &\bracket{a \ast a' = e}                    \tag{GCL}
\endalign
$$
Então $\ssetfont G$ é um grupo.
%%}}}

%%{{{ x: we_need_both_cancellation_laws_to_have_a_group 
\exercise.
\label{we_need_both_cancellation_laws_to_have_a_group}
Podemos apagar um dos (GCL), (GCR) das hipoteses do~\ref{cancellation_based_group_def}?

\endexercise
%%}}}

%%{{{ x: cancellation_based_group_def_only_valid_for_finite_G 
\exercise.
Mostre que não podemos apagar o ``finito'' das nossas hipoteses.

\hint
Não.  Procure contraexemplo!

\endexercise
%%}}}

%%{{{ lm: solutions of equations 
\lemma Resolução de equações.
Seja $G$ grupo.
Para quaisquer $a,b,x,y\in G$,
cada uma da equações em baixo tem resolução única para $x$ e $y$:
$$
\xalignat2
a\ast x &= b
&
y\ast a &= b
\endxalignat
$$
\sketch.
Aplicando o inverso de $a$ em cada equação pelo lado certo,
achamos que as soluções necessariamente são
$x = \ginv a \ast b$ e $y = b \ginv a$.
\qes
\proof.
Aplicando $(a^{-1}\ast)$ nos dois lados da primeira
e $(\ast a^{-1})$ nos dois lados da segunda temos:
$$
\xalignat2
  a\ast x = b &\impliesbecause{$\ginv a\ast$} \ginv a\ast \paren{a\ast x} = a^{-1} \ast b 
& y\ast a = b &\impliesbecause{$\ast\ginv a$} \paren{x\ast a}\ast \ginv a = b \ast \ginv a
\\
&\implies\paren{\ginv a\ast a}\ast x = \ginv a \ast b
&&\implies y\ast \paren{a\ast \ginv a} = b \ast \ginv a
\\
&\implies e \ast x = \ginv a \ast b
&&\implies y\ast e = b \ast \ginv a
\\
&\implies x = \ginv a \ast b
&&\implies y = b \ast \ginv a
\endxalignat
$$
\qed
%%}}}

%%{{{ x: onesided_group_def 
\exercise Unilateral definição de grupo.
\label{onesided_group_def}%
Seja $\ssetfont G = \sset G {e, \ast}$ um conjunto estruturado que satisfaz:
$$
\align
\paren{\forall a,b\in G}                        &\bracket{a\ast b \in G}                    \tag{G0}  \\
\paren{\forall a,b,c\in G}                      &\bracket{a\ast(b\ast c) = (a\ast b)\ast c} \tag{G1}  \\
\paren{\forall a \in G}                         &\bracket{a\ast e = a}                      \tag{G2R} \\
\paren{\forall a\in G} \paren{\exists a'\in G}  &\bracket{a \ast a' = e}                    \tag{G3R} \\
\intertext{Mostre que $\ssetfont G$ é um grupo.
Comece verificando que mesmo se conseguir provar as}
\paren{\forall a \in G}                         &\bracket{e\ast a = a}                      \tag{G2L} \\
\paren{\forall a\in G} \paren{\exists a'\in G}  &\bracket{a' \ast a = e}                    \tag{G3L} 
\endalign
$$
isso não nos permite deduzir trivialmente as (G2) e (G3)!  Explique o por quê.

\hint
Para evitar as chances de ``roubar'' sem querer, use uma notação adaptada às novas leis:
chame $e_r$ a identidade-direita grantida pela (G2R);
$a_{R}$ para os inversos-direitos grantidos pela (G3R); e
$a_{L}$ para os inversos-esquerdos garantidos pela (G3L).

\hint
Precisas mostrar as (G2)--(G3).
Ou seja, verificar que o $e_r$ é uma identidade-esquerda,
$$
\align
\paren{\forall a\in G} & \bracket{e_r \ast a = a}           \tag{G2'}\\
\intertext{e que para todo $a\in G$,
seu inverso-direito $a_{R}$ é um inverso-esquerdo também:}
\paren{\forall a\in G} &\bracket{a_{R} \ast a = e}.          \tag{G3'}
\endalign
$$

\hint
Para provar as (G2') e (G3'),
tome um $a\in G$ e comece com:
$$
\xalignat2
e \ast a &= (a \ast a_R) \ast a     & e \ast a &= (e \ast a) \ast e\\
         &= \dotsb                  &          &= e \ast (a \ast e)\\
         &=                         &          &= e \ast (a \ast (\;?\;))\\
         &=                         &          &= \dotsc
\endxalignat
$$

\hint
Espero que já conseguiu a (G2').
Para a (G3'), qual produto podes botar no lugar do $(\;?\;)$ da dica anterior?
Sabendo que (G2G) é válida, faz sentido o substituir com um termo
$\paren{x \ast x_R}$ para algum $x\in G$, mas qual seria esse $x$?
\emph{Não precisamos adivinhar ainda!}
Continue assim com um $x$ não-especificado por enquanto,
e logo tu vai chegar numa expressão que vai te ajudar escolher teu $x$ para
continuar.

\endexercise
%%}}}

%%{{{ x: splitsided_group_notdef 
\exercise.
\label{splitsided_grou_notdef}%
Podemos substituir a (G3R) do~\ref{onesided_group_def} por
$$
\align
\paren{\forall a\in G} \paren{\exists a'\in G}  &\bracket{a' \ast a = e}                    \tag{G3L} \\
\endalign
$$
e ainda concluir que $\ssetfont G$ é grupo?

\hint
Não!

\hint
Procure um contraexemplo.
(Claramente, a operação não pode ser comutativa.)

\endexercise
%%}}}

\endsection
%%}}}

%%{{{ More definitions 
\section Mais definições.

%%{{{ df: exp_in_group 
\definition Exponenciação.
\label{exp_in_group}%
\sdefined {{\holed a}^{\holed m}} {$a \ast \dotsb \ast a$ ($m$ vezes)}
Seja $a$ elemento de um grupo $\sset G {e, \ast}$.
Definimos suas potências $a^n$ onde $n\in\nats$ recursivamente:
$$
\align
a^0     &\defeq e\\
a^{n+1} &\defeq a \ast a^n
\intertext{Estendemos a definição para tratar exponentes inteiros também botando:}
a^{-n}  &\defeq \paren{a^{-1}}^n
\endalign
$$
%%}}}

%%{{{ x: exp_in_group_altdef
\exercise.
Demostre que a definição alternativa de exponenciação ao natural
$$
\align
a^0     &= e\\
a^{n+1} &= a^n \ast a
\endalign
$$
é equivalente.

\endexercise
%%}}}

%%{{{ x: negexp_in_group_altdef 
\exercise.
Demostre que a definição alternativa de exponenciação ao inteiro negativo
$$
a^{-n} \defeq \paren{a^n}^{-1}
$$
é equivalente; ou seja prove que para todo $n\in\nats$,
$$
\paren{a^{-1}}^n = \paren{a^n}^{-1}.
$$

\endexercise
%%}}}

%%{{{ df: order_of_element_in_group 
\definition Ordem de elemento em grupo.
\label{order_of_element_in_group}%
\tdefined{ordem!de elemento em grupo}%
\sdefined {\gord {\holed a}} {a ordem do elemento $\holed a$ num grupo}%
Seja $\sset G {e,\ast}$ grupo e $a\in G$.
Chamamos \dterm{ordem} de $a$ o menor positivo $n\in\nats$ tal que
$a^n = e$, se tal $n$ existe; se não, dizemos que o $a$ tem ordem infinita.
Usamos a mesma notação como no caso de ordem de grupos:
$\gord a$, $\tord a$, ou $\bord a$, com os mesmos cuidados.
Logo:
$$
\gord a =
\cases
\min\set{ n\in\nats_{>0} \st a^n = e }, &\text{se existe}\\
\infty                                  &\text{se não}.
\endcases
$$
%%}}}

%%{{{ eg: orders_of_members_of_S3 
\example.
\label{orders_of_members_of_S3}%
No $S_3$, temos
$$
\xalignat3
\gord {\id} &= 1 & \gord {\phi}         &= 2  &  \gord {\psi}   &= 3\\
            &    & \gord {\phi\com\psi} &= 2  &  \gord {\psi^2} &= 3.\\
            &    & \gord {\psi\com\phi} &= 2  &  
\endxalignat
$$
\endexample
%%}}}

%%{{{ x: verify the numbers of orders_of_members_of_S3 
\exercise.
Verifique os números do~\ref{orders_of_members_of_S3}.

\endexercise
%%}}}

%%{{{ x: non-zero integer power = e guarantees positive one 
\exercise.
Seja $G$ grupo e $a\in G$.
Se existe $m\in\ints_{\neq 0}$ tal que $a^m = e$, então $\gord a < \infty$.

\hint
Precisamos mostrar que existe $n\in\nats_{>0}$ com $a^n = e$.

\hint
Se $m>0$, tome $n\leteq m$.  Se não?

\solution%%{{{
Precisamos mostrar que existe $n\in\nats_{>0}$ com $a^n = e$.
Se $m>0$, o conjunto $N \leteq \set{ n\in\nats_{>0} \st a^n = e}$ não é vazio,
então pelo princípio da boa ordem (PBO)\ii{princípio!da boa ordem}
possui elemento mínimo e logo
$\gord a = \min N < \infty$
Se $m<0$, observe que $-m > 0$, e calcule:
$$
a^{-m} = \paren{a^m}^{-1} = e^{-1} = e,
$$
e novamente $N\neq\emptyset$ e $\gord a < \infty$.
%%}}}

\endexercise
%%}}}

%%{{{ lm: a_has_exactly_gord_a_powers 
\lemma.
\label{a_has_exactly_gord_a_powers}%
Sejam $G$ grupo e $a\in G$, e suponha $\gord a = n\in\nats$.
Existem exatamente $n$ potências diferentes de $a$.
\sketch.
Consideramos os
$$
a^0, a^1, \dotsc, a^{n-1}
$$
e usando a definição de $\gord a$ provamos:
\endgraf\noindent
\casestyle{Existência:} os $a^0,\dotsc,a^{n-1}$ são distintas dois a dois.
\endgraf\noindent
\casestyle{Unicidade:} para todo $m\in\ints$ o $a^m$ é um dos $a^0,\dotsc,a^{n-1}$.
\qes
%%}}}

%%{{{ lm: a_exp_m_is_e_iff_gord_a_divides_m 
\lemma.
\label{a_exp_m_is_e_iff_gord_a_divides_m}%
Sejam $\sset G \ast$ grupo, $a\in G$, e $m\in\ints$.
Logo
$$
a^m = e \iff \gord a \divides m.
$$
\proof.
\rldir:
Como $\gord a \divides m$,
temos $m = k\gord a$ para algum $k\in\ints$.
Calculamos:
$$
a^m = a^{k\gord a} = a^{\gord a k} = \paren{a^{\gord a}}^k = e^k = e.
$$
\endgraf
\lrdir:
Para provar que $\gord a \divides m$,
aplicamos o~\ref{division_of_euclid} da divisão de Euclides\Euclid[lema da divisão],
dividindo o $m$ por $\gord a$, e ganhando assim inteiros $q$ e $r$ tais que
$$
m = \gord a q + r
\qquad
0\leq r < \gord a.
$$
Vamos provar que o resto $r=0$.
Calculamos:
$$
e
= a^m
= a^{\gord a q + r}
= a^{\gord a q} \ast a^r
= \paren{a^{\gord a}}^q \ast a^r
= e^q \ast a^r
= e \ast a^r
= a^r.
$$
Ou seja, $a^r = e$ com $0\leq r < \gord a$, então pela definição de $\gord a$
como o mínimo inteiro positivo $n$ que satisfaz a $a^n = e$,
o $r$ não pode ser positivo.
Logo $r=0$ e $\gord a \divides m$.
\qed
%%}}}

%%{{{ lm: infinite_order_of_a_guarantees_all_powers_distinct 
\lemma.
\label{infinite_order_of_a_guarantees_all_powers_distinct}%
Sejam $G$ grupo e $a\in G$, e suponha $\gord a = \infty$.
Todas as potências de $a$ são diferentes.
\sketch.
Precisamos provar que para todo $r,s\in\ints$,
$$
a^r = a^s \implies r = s.
$$
Sem perda de generalidade suponhamos $s\leq r$ e cancelamos pela direita
o $a^s$.  Usando a definição de $\gord a$ concluimos que $r-s=0$ e logo $r=s$.
\qes
%%}}}

\endsection
%%}}}

%%{{{ Subgroups 
\section Subgrupos.

%%{{{ df: subgroup 
\definition Subgrupo.
\label{subgroup}%
\tdefined{subgrupo}%
\tdefined{subgrupo!trivial}%
\sdefined {\holed H \subgroup \holed G} {$\holed H$ é um subgrupo de $\holed G$}
Seja $\sset G {e, \ast}$ grupo.
Um subconjunto $H\subseteq G$ é um \dterm{subgrupo} de $G$ sse
$H$ é um grupo com a mesma operação $\ast$.
Escrevemos $H \subgroup G$.
Chamamos os $\set e$ e $G$ \dterm{subgrupos triviais} de $G$.
%%}}}

%%{{{ x: subgroup_is_an_order 
\exercise.
\label{subgroup_is_an_order}%
Mostre que $\subgroup$ é uma relação de ordem:
$$
\gather
G \subgroup G\\
K \subgroup H \mland H \subgroup G \implies K\subgroup G\\
H \subgroup G \mland G \subgroup H \implies H = G.
\endgather
$$

\endexercise
%%}}}

%%{{{ x: singleton_e_is_a_subgroup 
\exercise.
\label{singleton_e_is_a_subgroup}%
Verifique que para todo grupo $\sset G {e, \ast}$, temos $\set e \subgroup G$.

\endexercise
%%}}}

%%{{{ property: empty_is_never_a_subgroup 
\property.
\label{empty_is_never_a_subgroup}%
$H\subgroup G \implies H \neq\emptyset$.
\proof.
Como $H$ é um grupo, necessariamente $e\in H$.
\qed
%%}}}

%%{{{ lm: subgroup_criterion 
\lemma.
\label{subgroup_criterion}%
Se $H$ é um subconjunto não vazio do grupo $\sset G {e,\ast}$, então:
$$
H \subgroup G
\iff
\left\{
\alignedat3
\text{\rm(1)} &\quad & a, b \in H   &\implies a\ast b \in H &\qquad&\text{\rm($H$ é $\ast$-fechado)}\\
\text{\rm(2)}&\quad & a \in H      &\implies a^{-1}  \in H &\qquad&\text{\rm($H$ é $^{-1}$-fechado)}
\endalignedat
\right.
$$
\sketch.
A direção \lrdir\ é trivial.
Para a \rldir\ observamos que a associedade é garantida pelo fato que $G$ é grupo,
então basta provar que $e\in H$.
Por isso, usamos a hipótese $H\neq\emptyset$ para tomar um $a\in H$
e usando nossas (poucas) hipoteses concluimos que $e\in H$ também.
\qes
\proof.
\lrdir: Trivial.
\endgraf
\rldir:
Precisamos verificar as leis (G0)--(G3) para o $\sset H {\ast}$.
Os (1) e (2) garantam as (G0) e (G3) respectivamente,
e o fato que $G$ é grupo garanta a (G1) também.
Basta verificar a (G2), ou seja, que $e\in H$:
$$
\alignat2
&\text{Tome $a\in H$.}                   \qqby{$H\neq\emptyset$\,}\\
&\text{\ttherefore $a^{-1} \in H$}       \qqby{pela (ii)}\\
&\text{\ttherefore $a\ast a^{-1} \in H$} \qqby{pela (i)}\\
&\text{\ttherefore $e \in H$}            \qqby{def.~$a^{-1}$}
\endalignat
$$
\qed
%%}}}

%%{{{ lm: finite_subgroup_criterion 
\lemma.
\label{finite_subgroup_criterion}%
Se $\sset G {e, \ast}$ é um grupo e $H$ é um subconjunto finito e não vazio do $G$,
fechado sobre a operação $\ast$, então $H$ é um subgrupo de $G$.  Em símbolos:
$$
\left.
\alignedat3
\text{\rm(0)} &\quad & &\emptyset \neq H \finsubseteq G\\
\text{\rm(1)} &\quad & & a, b \in H  \implies a\ast b \in H\quad
\endalignedat
\right\}
\implies
H \subgroup G
$$
\sketch.
Basta demonstar o (2) para aplicar o~\ref{subgroup_criterion}.
Tome um $a\in H$ e considere a seqüência das suas potências
$a, a^2, a^3, \dotsc \in H$.
Como o $H$ é finito vamos ter um elemento repetido,
$a^r = a^s$ com inteiros $r > s > 0$, e usamos isso
para achar qual dos $a, a^2, a^3, \dotsc$ deve ser o $a^{-1}$,
provando assim que $a^{-1}\in H$.
\qes
\proof.
Basta demonstar o (2) para aplicar o~\ref{subgroup_criterion}.
Tome um $a\in H$ e considere a seqüência das suas potências
$a, a^2, a^3, \dotsc \in H$, graças à hipótese (1).
Como o $H$ é finito vamos ter um elemento repetido,
$a^r = a^s$ para alguns inteiros $r > s > 0$.
Temos
$$
\align
\toverbrace{a\ast a \ast \dotsb \ast a}{$r$ vezes}
&=\toverbrace{a\ast a \ast \dotsb \ast a}{$s$ vezes}
\intertext{e como $r>s$, reescrevemos assim:}
\toverbrace{
\tunderbrace{a\ast a \ast \dotsb \ast a}{$r-s$ vezes}
\ast
\tunderbrace{\cancel{a\ast a \ast \dotsb \ast a}}{$s$ vezes}
}{$r$ vezes}
&=\toverbrace{\cancel{a\ast a \ast \dotsb \ast a}}{$s$ vezes}.
\intertext{Agora usamos a lei de cancelamento-direito:}
\toverbrace{a\ast a \ast \dotsb \ast a}{$r-s$ vezes}
&=e
\intertext{Acabamos de provar que $e\in H$.  Observe que $r-s>0$, então temos:}
\toverbrace{a\ast \tunderbrace{a \ast \dotsb \ast a}{$r-s-1$ vezes}}{$r-s$ vezes}
&=e
\endalign
$$
ou seja, $a^{-1} = a^{r-s-1} \in H$ pois $r-s-1\geq 0$ e podemos aplicar
o~\ref{subgroup_criterion} para concluir $H\subgroup G$.
\qed
%%}}}

%%{{{ eg: Numbers 
\example Números.
Considere o grupo $\sset \reals {+}$.
Observe que $\rats$ e $\ints$ são subgrupos dele, mas $\nats$ não é.
\endexample
%%}}}

%%{{{ x: nontrivial_subgroups_of_multiplicative_reals 
\exercise.
\label{nontrivial_subgroups_of_multiplicative_reals}%
Ache uns subgrupos não-triviais do
$\sset {\reals\setminus\set0} {\ntimes}$?

\endexercise
%%}}}

%%{{{ x: rationals 
\exercise.
Considere o grupo $\ssetfont Q \leteq \sset {\rats\setminus\set0} {\ntimes}$
e seus subconjuntos:
$$
\align
Q_1 &\leteq \setst { p/q } { p, q \in \ints,\ \text{$p$ e $q$ ímpares} }\\
Q_2 &\leteq \setst { p/q } { p, q \in \ints,\ \text{$p$ ímpar, $q$ par} }\\
Q_3 &\leteq \setst { p/q } { p, q \in \ints,\ \text{$p$ par, $q$ ímpar} }.
\endalign
$$
Para quais dos $i=1,2,3$ temos $Q_i \subgroup \ssetfont Q$?

\endexercise
%%}}}

%%{{{ x: Matrices 
\exercise Matrizes.
Verificamos que
$$
G \leteq \setst{ \matrixp{a & b\\c & d}\in\reals^{2\times2}} {ad - bc \neq 0 }
$$
com multiplicação é um grupo no~\ref{matrix_group_examples}.
Considere seus subconjuntos:
$$
\xalignat2
G_{\rats} &\leteq \setst{ \matrixp{a & b\\c & d}\in\rats^{2\times2}} {ad - bc \neq 0 }&\quad H &\leteq \setlst { \matrixp{a & b\\0 & d}      } { a,b,d \in\reals,\ ad \neq 0 }\\
G_{\ints} &\leteq \setst{ \matrixp{a & b\\c & d}\in\ints^{2\times2}} {ad - bc \neq 0 }&\quad K &\leteq \setlst { \matrixp{1 & b\\0 & 1}      } { b\in\reals }                 \\
G_{\nats} &\leteq \setst{ \matrixp{a & b\\c & d}\in\nats^{2\times2}} {ad - bc \neq 0 }&\quad L &\leteq \setlst { \matrixp{a & 0^{\phantom{-1}}\\0 & a^{-1}} } { a\in\reals,\ a\neq 0 }
\endxalignat
$$
Para cada relação de $\subseteq$ válida entre 2 dos 7 conjuntos em cima,
decida se a correspondente relação~$\subgroup$ também é válida.

\endexercise
%%}}}

%%{{{ eg: Modular arithmetic 
\example Aritmética modular.

\endexample
%%}}}

%%{{{ eg: Symmetries 
\example Simetrias.

\endexample
%%}}}

%%{{{ eg: Permutations (bijections) 
\example Permutações (bijeções).

\endexample
%%}}}

%%{{{ eg: Real functions 
\example Funções reais.

\endexample
%%}}}

%%{{{ eg: Sets 
\example Conjuntos.

\endexample
%%}}}

%%{{{ x: intersection_of_subgroups_is_a_subgroup 
\exercise.
\label{intersection_of_subgroups_is_a_subgroup}%
Seja $G$ grupo, e $H_1,H_2\subgroup G$.
Então $H_1\intersection H_2 \subgroup G$.

\hint
Precisa mostrar que $H_1\intersection H_2$ é fechado sobre a operação do grupo
e sobre inversos.

\hint
Para mostrar que é fechado sobre a operação do grupo
suponha $a,b\in H_1\intersection H_2$ e mostre que
$ab\in H_1\intersection H_2$.
Similarmente, para mostrar que é fechado sobre os inversos,
suponha $a\in H_1\intersection H_2$ e mostre que
$a^{-1} \in H_1\intersection H_2$.

\solution%%{{{
Como $H_1\intersection H_2 \subseteq G$,
precisamos mostrar que é fechado sobre a operação:
$$
\alignat2
&a,b \in H_1\intersection H_2\\
&\text{\ttherefore $a,b \in H_1$ e $a,b\in H_2$   }      \qqby{def.~$\intersection$}\\
&\text{\ttherefore $ab  \in H_1$ e $ab\in H_2$    }      \qqby{$H_1$ e $H_2$ grupos}\\
&\text{\ttherefore $ab  \in H_1\intersection H_2$ }      \qqby{def.~$\intersection$}
\intertext{e sobre os inversos:}
&a \in H_1\intersection H_2\\
&\text{\ttherefore $a      \in H_1$ e $a\in H_2$      } \qqby{def.~$\intersection$}\\
&\text{\ttherefore $a^{-1} \in H_1$ e $a^{-1}\in H_2$ } \qqby{$H_1$ e $H_2$ grupos}\\
&\text{\ttherefore $a^{-1} \in H_1\intersection H_2$  } \qqby{def.~$\intersection$}
\endalignat
$$
%%}}}

\endexercise
%%}}}

%%{{{ x: union_of_subgroups_is_a_subgroup_wrong 
\exercise.
\label{union_of_subgroups_is_a_subgroup_wrong}%
Trocamos o $\intersection$ para $\union$
no~\ref{intersection_of_subgroups_is_a_subgroup}.
Ache o erro na prova seguinte, e prove que a proposição não é válida:
\endgraf
Como $H \leteq H_1\intersection H_2 \subseteq G$,
precisamos mostrar que $H$ é fechado sobre a operação:
$$
\alignat2
&a,b \in H_1\union H_2\\
&\text{\ttherefore $a,b \in H_1$ ou $a,b\in H_2$} \qqby{def.~$\union$}\\
&\text{\ttherefore $ab \in H_1$ ou $ab\in H_2$  } \qqby{$H_1$ e $H_2$ grupos}\\
&\text{\ttherefore $ab \in H_1\union H_2$       } \qqby{def.~$\union$}
\intertext{e sobre os inversos:}
&a \in H_1\union H_2\\
&\text{\ttherefore $a \in H_1$ ou $a\in H_2$          } \qqby{def.~$\union$}\\
&\text{\ttherefore $a^{-1} \in H_1$ ou $a^{-1}\in H_2$} \qqby{$H_1$ e $H_2$ grupos}\\
&\text{\ttherefore $a^{-1} \in H_1\union H_2$         } \qqby{def.~$\union$}
\endalignat
$$

\endexercise
%%}}}

%%{{{ x: arbitrary_intersection_of_subgroups_is_a_subgroup 
\exercise.
\label{arbitrary_intersection_of_subgroups_is_a_subgroup}%
Generaliza a~\ref{intersection_of_subgroups_is_a_subgroup} para
interseções arbitrárias:
se $G$ é um grupo, e $\scr H$ uma famílica de subconjuntos de $G$,
então $\Intersection {\scr H} \subgroup G$.

\endexercise
%%}}}

%%{{{ x: congruence_mod_H_teaser 
\exercise.
\label{congruence_mod_H_teaser}%
Seja $G$ conjunto e $H\subgroup G$.
Defina no $G$ a relação $\rel R$ pela
$$
a \rel R b \defiff ab^{-1} \in H.
$$
Decida se a relação $\rel R$ é uma
relação de ordem parcial, de ordem total, de equivalência, ou nada disso.

\endexercise
%%}}}

\endsection
%%}}}

%%{{{ Orders, generators, and cyclic groups 
\section Ordens, geradores, e grupos cíclicos.

%%{{{ df: subgroup_generated_by_a 
\definition.
\label{subgroup_generated_by_a}%
\tdefined{grupo}[subgrupo!gerado por elemento]%
\sdefined {\generate {\holed a}} {O subgrupo gerado por o elemento $\holed a$}%
Sejam $G$ grupo e $a\in G$.
Chamamos o
$$
\align
\generate{a}
&\defeq
\set{a^m\st m\in\ints}\\
&=\set{\dotsc,a^{-2},a^{-1},a^0,a,a^2,\dotsc}
\endalign
$$
o \dterm{subgrupo de $G$ gerado por $a$}.
%%}}}

%%{{{ x: justify_subgroup_on_subgroup_generated_by_a
\exercise.
\label{justify_subgroup_on_subgroup_generated_by_a}%
Justifica a palavra ``subgrupo'' na~\ref{subgroup_generated_by_a}.
Ou seja, prove que para qualquer grupo $G$ e qualquer $a\in G$,
$\generate a \subgroup G$.

\endexercise
%%}}}

%%{{{ x: Cyclic group of e 
\exercise.
Seja $\sset G {e,\ast}$ grupo.
Calcule o $\generate e$.

\endexercise
%%}}}

%%{{{ Calculate some sets and subgroups of ints 
\exercise.
Nos inteiros com adição, calcule os
$\generate 4$,
$\generate 4 \intersection \generate 6$,
$\generate 4 \intersection \generate {15}$,
e
$\generate 4 \union \generate 6$.
\endgraf\noindent
Quais deles são subgrupos do $\ints$?

\endexercise
%%}}}

%%{{{ df: cyclic_group 
\definition Grupo cíclico.
\label{cyclic_group}%
\tdefined {Grupo}[cíclico]%
Um grupo $G$ é \dterm{cíclico} sse existe $a\in G$ tal que $\generate a = G$.
%%}}}

%%{{{ A wrong generalization of <a> to <A> 
\note.
\label{wrong_generalization_of_gord_a_to_gord_A}%
Queremos generalizar o conceito de geradores para definir $\generate A$,
onde $A\subseteq G$.
Seguindo ingenuamente a definição de $\generate a$,
uma primeira abordagem seria botar
$$
\generate A = \set{ a^m \st a \in A,\  m \in\ints }
$$
e chamar $\generate A$ o subgrupo de $G$ gerado por $A$.\mistake
%%}}}

%%{{{ x: find_the_problem_in_wrong_generalization_of_gord_a_to_gord_A
\exercise.
\label{find_the_problem_in_wrong_generalization_of_gord_a_to_gord_A}%
Qual o problema com a definição de $\generate A$ em cima?

\hint
Calcule o $\generate {4,6}$ no $\sset \ints +$.

\hint
Ele é um subgrupo?

\endexercise
%%}}}

%%{{{ df: subgroup_generated_by_A 
\definition.
\label{subgroup_generated_by_A}%
\tdefined{grupo}[subgrupo!gerado por subconjunto]%
\sdefined {\generate {\holed a}} {O subgrupo gerado por o conjunto $\holed A$}%
Sejam $\sset G \ast$ grupo e $A\subseteq G$.
Chamamos o
$$
\align
\generate{A}
&\defeq
\set{a_0^{m_0}\ast\dotsb\ast a_{k-1}^{m_{k-1}}\st
a_i \in A,\ 
m_i \in \ints,\ 
k\in\nats,\ 
i\in\finord k
}
\endalign
$$
o \dterm{subgrupo de $G$ gerado por $A$}.
Abusando a notação, escrevemos também $\generate{ a_1, a_2,\dotsc, a_n }$
para o $\generate{ \set{a_1, a_2,\dotsc, a_n}}$.
%%}}}

%%{{{ x: Calculate <> and <G> 
\exercise.
Dado grupo $G$,
calcule os $\generate \emptyset$ e $\generate G$.

\endexercise
%%}}}

%%{{{ x: justify_subgroup_on_subgroup_generated_by_A 
\exercise.
\label{justify_subgroup_on_subgroup_generated_by_A}%
Prove que $\generate A \subgroup G$ para qualquer grupo $G$ e qualquer $A\subseteq G$.

\endexercise
%%}}}

%%{{{ prop: top_down_def_subgroup 
\proposition.
\label{top_down_def_subgroup}%
Sejam $G$ grupo e $A\subset G$.
$$
\generate A
=
\Intersection
\setst
    { H \subgroup G }
    { W \subseteq A }.
$$
\sketch.
Provamos os ``$\subseteq$'' e ``$\supseteq$'' separadamente
usando a definição do operador $\Intersection$.
\qes
%%}}}

%%{{{ Top-down and bottom-up 
\note ``Top-down'' e ``bottom-up''.
Discussão.
%%}}}

\endsection
%%}}}

%%{{{ Congruences and cosets 
\section Congruências e cosets.
\label{congruences_and_cosets}%

%%{{{ The relation R was actually congruence mod subgroup 
\note.
A relação de equivalência que definimos no~\ref{congruence_mod_H_teaser}
não é tão desconhecida como talvez apareceu ser.
Vamos a redefinir com seu próprio nome e sua própria notação:
%%}}}

%%{{{ df: congruence mod H 
\definition Congruência.
\label{congruence_mod_H}%
\tdefined{congruência}[módulo subgrupo]%
\tdefined{módulo!subgrupo}%
\sdefined{\holed a \cong {\holed b} \pmodr {\holed H}}{\holed a é congruente com \holed b módulo-direito \holed H, onde $\holed H \subgroup G$}
Seja $G$ grupo e $H\subgroup G$.
Definimos
$$
a \cong b \pmodr H \defiff ab^{-1} \in H.
$$
%%}}}

%%{{{ x: mod_m_as_a_special_case_of_mod_H 
\exercise.
\label{mod_m_as_a_special_case_of_mod_H}%
Explique a notação da~\ref{congruence_mod_H} a comparando com a
congruência módulo algum inteiro da~\ref{congruence}.
Ou seja, mostre como a definição nos inteiros é apenas um caso especial da definição nos grupos.

\endexercise
%%}}}

%%{{{ Investigating the congruence 
\note Investigando a congruência.
\label{investigation_of_cong_mod_H}%
Vamos supor que temos um grupo $G$ e um $H\subgroup G$.
Tomamos $a,b\in G$ e queremos ver se $a\cong b\pmodr H$.
Vamos separar em casos:
\beginil
\item{\casestyle{Caso 1:}} os dois elementos $a$ e $b$ estão no $H$;
\item{\casestyle{Caso 2:}} um dos elementos está dentro do $H$, o outro fora;
\item{\casestyle{Caso 3:}} os dois estão fora do $H$.
\endil
\topinsert
\centerline{
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm, fill=red!10]   (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
%\draw[help lines] (-3,-2) grid (2,2);
\node at (-1,0.5)      (a)      {$\bullet$};
\node at (-0.5,-0.5)  (b) {$\bullet$};
\node at (-1.5,0.5) (H) {$H$};
\node at (-2,1.5) (G) {$G$};
\node[above right, outer sep=1pt] at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\endtikzpicture
%%}}}
\hfil
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm, fill=red!10]   (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
\node at (-1,0.5)      (a)      {$\bullet$};
\node at (1,-0.5) (b) {$\bullet$};
\node at (-1.5,0.5) (H) {$H$};
\node at (-2,1.5) (G) {$G$};
\node[above right, outer sep=1pt] at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\endtikzpicture
%%}}}
\hfil
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm, fill=red!10]   (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
\node at (0.5,1)      (a)      {$\bullet$};
\node at (1,-0.5) (b) {$\bullet$};
\node at (-1.5,0.5) (H) {$H$};
\node at (-2,1.5) (G) {$G$};
\node[above right, outer sep=1pt] at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\endtikzpicture
%%}}}
}
\botcaption{}
Os 3 casos da Investigação~\refn{investigation_of_cong_mod_H}.
\endcaption
\endinsert
\noindent
Para cada caso, queremos decidir se:
\beginil
\item{(i)} podemos concluir que $a \ncong b \pmodr H$;
\item{(ii)} podemos concluir que $a \ncong b \pmodr H$;
\item{(iii)} nenhum dos (i)--(ii).
\endil
Vamos ver qual dos (i)--(iii) aplica no \casestyle{caso 1}.
Temos
$$
a \cong b \pmodr H
\defiff ab^{-1} \in H
$$
Como $b\in H$ e $H$ é um grupo ($H\subgroup G$) concluimos que
$b^{-1} \in H$.  Agora, como $a, b^{-1} \in H$ ganhamos $ab^{-1}\in H$, ou seja, 
$a \cong b \pmodr H$:
\topinsert
\centerline{
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm, fill=red!10]   (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
%\draw[help lines] (-3,-2) grid (2,2);
\node at (-1,0.5)      (a)      {$\bullet$};
\node[inner sep=1pt] at (-0.5,-0.5)   (b)      {$\bullet$};
\node[color=blue,inner sep=1pt] at (-1.5,-0.5)   (binv)   {$\bullet$};
\node at (-1.5,0.5) (H) {$H$};
\node at (-2,1.5) (G) {$G$};
\node[above right, outer sep=1pt] at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\draw[->,dashed,color=blue] (b)--(binv);
\node[above,  outer sep=1pt] at (binv) {$b^{-1}$};
\endtikzpicture
%%}}}
\hfil
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm, fill=red!10]   (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
%\draw[help lines] (-3,-2) grid (2,2);
\node[inner sep=1pt] (a)      at (-1,0.5)      {$\bullet$};
\node (b)      at (-0.5,-0.5)   {$\bullet$};
\node[inner sep=1pt] (binv)   at (-1.5,-0.5)   {$\bullet$};
\node[color=blue,inner sep=1pt] (abinv)  at (-0.75,-0.75) {$\bullet$};
\node at (-1.5,0.5) (H) {$H$};
\node at (-2,1.5) (G) {$G$};
\node[above right, outer sep=1pt] at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\node[above, outer sep=1pt] at (binv) {$b^{-1}$};
\node[below, inner sep=1pt, outer sep=1pt] at (abinv) {$ab^{-1}$};
\draw[|-,color=blue]  (a)    edge[out=240,  in=135] (abinv);
\draw[|->,color=blue] (binv) edge[out=60, in=135] (abinv);
\endtikzpicture
%%}}}
}
\botcaption{}
Os passos do \casestyle{caso 1} do~\refn{investigation_of_cong_mod_H}.
\endcaption
\endinsert
%%}}}

%%{{{ x: do case 2 
\exercise.
\label{investigation_of_cong_mod_H_case_2}%
Decida qual dos (i)--(iii) aplica no \casestyle{caso 2}
do~\refn{investigation_of_cong_mod_H}.

\hint
Sem perca de generalidade, podes supor que $a \in H$ e $b \notin H$.
Comece desenhando como fizermos no \casestyle{caso 1}.

\hint
Mostre que $b^{-1}\notin H$.  (Qual seria o problema se $b^{-1} \in H$?)

\hint
Se $b{-1} \in H$ seu inverso também deveria estar no $H$, pois $H$ é um grupo.

\hint
Suponha que $ab^{-1} \in H$ para chegar num absurdo, mostrando assim que necessariamente,
$a \ncong b \pmodr H$.  Cuidado:
$$
xy \in H \nimplies x \in H \mland y \in H.
$$

\hint
Mostre que $a^{-1}\in H$.

\solution%%{{{
Sem perda de generalidade, suponha $a\in H$ e $b\notin H$.
Primeiramente mostramos que $b^{-1} \notin H$:
$$
b^{-1}\in H \implies \paren{b^{-1}}^{-1} \in H \implies b \in H,
$$
logo $b^{-1}\notin H$.
Para chegar num absurdo, vamos supor que $ab^{-1} \in H$.
\topinsert
\centerline{
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm,  fill=red!10]  (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
\node[inner sep=1pt] at (-1,0.5)   (a) {$\bullet$};
\node[inner sep=1pt] at (0.5,-0.5) (b) {$\bullet$};
\node                at (-1.5,0.5) (H) {$H$};
\node                at (-2,1.5)   (G) {$G$};
\node[above, outer sep=1pt]       at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\endtikzpicture
%%}}}
\hfil
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm, fill=red!10]   (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
\node[inner sep=1pt, color=blue] at (0,1.5) (binv) {$\bullet$};
\node[inner sep=1pt] at (-1,0.5)      (a)      {$\bullet$};
\node[inner sep=1pt] at (0.5,-0.5) (b) {$\bullet$};
\node at (-1.5,0.5) (H) {$H$};
\node at (-2,1.5) (G) {$G$};
\node[above, outer sep=1pt] at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\draw[->,dashed,color=blue] (b) edge[out=180, in=225] (binv);
\node[above, inner sep=3pt, outer sep=1pt] at (binv) {$b^{-1}$};
\endtikzpicture
%%}}}
\hfil
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm, fill=red!10]   (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
\node[inner sep=1pt] at (0,1.5) (binv) {$\bullet$};
\node[inner sep=1pt] at (-1,0.5)      (a)      {$\bullet$};
\node[inner sep=1pt] at (0.5,-0.5) (b) {$\bullet$};
\node[color=red] at (-0.5,-1) (abinv) {$\bullet$};
\node at (-1.5,0.5) (H) {$H$};
\node at (-2,1.5) (G) {$G$};
\node[above, outer sep=1pt] at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\node[above, inner sep=3pt, outer sep=1pt] at (binv) {$b^{-1}$};
\node[below, inner sep=1pt, outer sep=1pt] at (abinv) {$ab^{-1}$};
\endtikzpicture
%%}}}
}
\medskip
\centerline{
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm, fill=red!10]   (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
\node[inner sep=1pt] at (0,1.5) (binv) {$\bullet$};
\node[inner sep=1pt, color=blue] at (-1.25,-1) (ainv) {$\bullet$};
\node[inner sep=1pt] at (-1,0.5)      (a)      {$\bullet$};
\node[inner sep=1pt] at (0.5,-0.5) (b) {$\bullet$};
\node[color=red] at (-0.5,-1) (abinv) {$\bullet$};
\node at (-1.5,0.5) (H) {$H$};
\node at (-2,1.5) (G) {$G$};
\node[above, outer sep=1pt] at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\draw[->,dashed,color=blue] (a) to (ainv);
\node[below, inner sep=1pt, outer sep=1pt] at (ainv) {$a^{-1}$};
\node[above, inner sep=3pt, outer sep=1pt] at (binv) {$b^{-1}$};
\node[below, inner sep=1pt, outer sep=1pt] at (abinv) {$ab^{-1}$};
\endtikzpicture
%%}}}
\hfil
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm, fill=red!10]   (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
\node at (-1,0.5)      (a)      {$\bullet$};
\node at (0.5,-0.5) (b) {$\bullet$};
\node at (0,1.5) (binv) {$\bullet$};
\node at (-1.25,-1) (ainv) {$\bullet$};
\node[color=red] at (-0.5,-1) (abinv) {$\bullet$};
\node at (-1.5,0.5) (H) {$H$};
\node at (-2,1.5) (G) {$G$};
\node[above, outer sep=1pt] at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\node[below, inner sep=1pt, outer sep=1pt] at (ainv) {$a^{-1}$};
\node[below, inner sep=1pt, outer sep=1pt] at (abinv) {$ab^{-1}$};
\node[above, outer sep=1pt] at (binv) {$b^{-1}$};
\draw[|-]  (ainv)  edge[out=60, in=250] (binv);
\draw[|->,color=red] (abinv) edge[out=90, in=250] (binv);
\endtikzpicture
%%}}}
\hfil
\tikzpicture[>=stealth]%%{{{
\draw [rounded corners=10mm, fill=gray!20] (-2.5,-1.5)--(-2.5,2)--(1.5,2)--(1.5,-1.5)--cycle;
\draw [rounded corners=5mm, fill=red!10]   (-2,-1.5)--(-2,1)--(0,1)--(0,-1.5)--cycle;
\node[inner sep=1pt] at (-1,0.5)      (a)      {$\bullet$};
\node[inner sep=1pt] at (0.5,-0.5) (b) {$\bullet$};
\node at (0,1.5) (binv) {$\bullet$};
\node at (-1.25,-1) (ainv) {$\bullet$};
\node[inner sep=1pt,color=blue] at (1,1) (abinv) {$\bullet$};
\node at (-1.5,0.5) (H) {$H$};
\node at (-2,1.5) (G) {$G$};
\node[above, outer sep=1pt] at (a) {$a$};
\node[above right, outer sep=1pt] at (b) {$b$};
\node[below, inner sep=1pt, outer sep=1pt] at (ainv) {$a^{-1}$};
\node[below, inner sep=1pt, outer sep=1pt] at (abinv) {$ab^{-1}$};
\node[above, outer sep=1pt] at (binv) {$b^{-1}$};
\draw[-,dashed,color=blue] (a) edge[out=20,  in=160] (abinv);
\draw[->,dashed,color=blue] (b) edge[out=110, in=160] (abinv);
\endtikzpicture
%%}}}
}
\botcaption{}
Os passos da resolução do~\ref{investigation_of_cong_mod_H_case_2}.
\endcaption
\endinsert
\noindent
Vamos deduzir a contradição $b^{-1}\in H$.
Para conseguir isso, observamos que $a^{-1} \in H$ (pois $a\in H$),
e logo
$$
\overbrace{\underbrace{\vphantom{(}a^{-1}}_{\in H}\underbrace{(ab^{-1})}_{\in H}}^{\dsize b^{-1}} \in H.
$$
\noindent
Achamos assim nossa contradição:
$$
b^{-1} = eb^{-1} = (a^{-1}a)b^{-1} = a^{-1}(ab^{-1}) \in H.
$$
Concluimos então que $ab^{-1} \notin H$, ou seja $a \ncong b \pmodr H$.
%%}}}

\endexercise
%%}}}

%%{{{ x: do case 1 
\exercise.
Decida qual dos (i)--(iii) aplica no \casestyle{caso 3} do~\refn{investigation_of_cong_mod_H}.

\hint
Ache dois exemplos com $a,b\notin H$, tais que num
$a \cong b \pmodr H$ e no outro $a \ncong b \pmodr H$.

\hint
Um exemplo consiste em: um grupo $G$, um subgrupo $H\subgroup G$, e dois elementos $a,b\in G\setminus H$ tais que satisfazem (ou não) a congruência $a\cong b \pmodr H$.

\hint
Procure teus exemplos no grupo dos inteiros com adição $\sset \ints +$.

\hint
Tome $G \leteq \sset \ints +$, $H \leteq 2\ints$, $a \leteq 1$, $b \leteq 3$
e observe que $1 \cong 3 \pmodr {2\ints}$.

\hint
Não é possível achar o outro exemplo com o mesmo subgrupo $2\ints$,
mas pode sim no $3\ints$.

\solution%%{{{
No grupo $G\leteq\sset \ints +$ considere seu subgrupo $H\leteq 5\ints$.
Temos:
$$
\xalignat2
\left.
\aligned
G&\leteq \sset \ints +\\
H&\leteq 5\ints\\
a&\leteq 1  \\
b&\leteq 6  
\endaligned
\right\}
&\implies a \cong b \pmodr H
&
\left.
\aligned
G&\leteq \sset \ints +\\
H&\leteq 5\ints\\
a&\leteq 1  \\
b&\leteq 3  
\endaligned
\right\}
&\implies a \ncong b \pmodr H,
\endxalignat
$$
porque $1 + (-6) = -5 \in 5\ints$ e $1 + (-3) = -2 \notin 5\ints$ respectivamente.
%%}}}

\endexercise
%%}}}

%%{{{ def: cosets 
\definition Cosets.
\label{coset}%
\tdefined{coset}%
\iisee{coclasse}{coset}%
\sdefined{\holed a H} {o left-coset do $H\subgrp G$ através do $a\in G$}%
\sdefined{H\holed a} {o right-coset do $H\subgrp G$ através do $a\in G$}%
Seja $G$ grupo e $H\subgrp G$.  Para $a\in G$ definimos
$$
\xalignat2
aH &\defeq \set{ ah \st h\in H }.
&
Ha &\defeq \set{ ha \st h\in H }
\endxalignat
$$
Chamamos o $aH$ o \dterm{left-coset} do $H$ através de $a$,
e similarmente o $Ha$ seu \dterm{right-coset}.
Também usamos os termos \dterm{coclasse (lateral) à esquerda/direita}.
%%}}}

%%{{{ Q: How many cosets? 
\question.
\emph{Dados um $G$ grupo e $H\subgroup G$, quantas coclasses $Ha$ tem?
Ou seja, qual é a cardinalidade do conjunto $\set { Ha \st a \in G }$?}
%%}}}

%%{{{ thm: the cosets of H are the quotient set G / congmodR 
\theorem.
\ii{partição}%
\ii{relação!de equivalência}%
Seja $G$ grupo e $H\subgroup G$.
A família $\scr A = \set { Ha \st a\in G }$ é uma partição do $G$
e sua correspondente relação de equivalência é a congruência modulo-direito $H$.
\proof.
Vamos denotar por $\eqclassimp a$ a classe de equivalência de $a\in G$.
Provamos que $\eqclassimp a = Ha$.
\endgraf
``$\subseteq$'':
Suponha $x \in \eqclassimp a$.
Logo $x \cong a \pmodr H$, ou seja, $xa^{-1} \in H$.
Pela definição de $Ha$ então temos
$$
Ha\ni
\underbrace{\paren{xa^{-1}}}_{\in H}a
= x\paren{a^{-1}a}
= x.
$$
\endgraf
``$\supseteq$'':
Suponha que $x\in Ha$.
Logo $x=ha$ para algum $h\in H$ e queremos mostrar que $ha\in\eqclassimp a$,
ou seja $ha \cong a \pmodr H$.
Confirmamos:
$$
\paren{ha} a^{-1}
= h \paren{aa^{-1}}
= h
\in H
$$
e pronto.
\qed
%%}}}

%%{{{ x: direct proof that coclasses form a partition 
\exercise.
\ii{partição}%
Prove diretamente (sem passar pela relação de equivalência) que
a família de todas as coclásses dum $H\subgroup G$ é uma partição de $G$:
\beginil
\item{(i)}   para todo $x\in G$, existe coclasse $Ha$ com $x \in Ha$;
\item{(ii)}  para todo $c\in G$, se $c\in Ha\inters Hb$ então $Ha = Hb$;
\item{(iii)} nenhuma coclasse $Ha$ é vazia.
\endilnoskip

\hint%%{{{
Para os (i) e (iii) explique porque $a \in Ha$ para todo $a\in G$ e vice versa.
Para o (ii) tome um elemento comum $c\in G$ tal que
$$
h_a a = c = h_b b.
$$
Agora mostra que $Ha \subseteq Hb$; a outra diração será similar.
%%}}}

\hint%%{{{
Para os (i) e (iii) lembra que $H$ sendo subgrupo de $G$ ele também é grupo.
Qual elemento é garantido de pertencer no $H$ e como podemos usar esse fato aqui?
Para o (ii) tome $ha \in Ha$ e mostre que $ha \in Hb$.
Aplique uma série de substituições $ha = \dotsb$ para chegar num elemento
do $Hb$, ou seja, um produto que começa com elementos de $H$ e termina em $b$.
%%}}}

\hint%%{{{
Para o (ii):
como temos que $h_aa=h_bb$, precisamos ``criar'' a expressão
``$h_aa$'' para a substituir por $h_bb$.
Com que precisamos e podemos multiplicar o $ha$ pela equerda para conseguir isso?
Cuidado: para garantir igualdade só pode multiplicar com $e$,
mas pode substituir o $e$ com muitos produtos iguais ao $e$.
%%}}}

\solution%%{{{
Como $H$ é um grupo, sabemos que $e\in H$, então para qualquer $x\in G$,
temos que $x = ex \in Hx$, ou seja todos os elementos de $G$ pertencem em
alguma coclasse, e vice versa:
toda coclasse $Ha$ tem pelo menos um elemento: o proprio $a$.
Para o (iii) suponha que $Ha\inters Hb\neq \emptyset$ e tome $c\in Ha\inters Hb$.
Logo
$$
h_aa = c = h_bb
\qqquad
\text{para alguns $h_a, h_b\in H$}
$$
Para provar que $Ha = Hb$, mostramos que $Ha\subseteq Hb$ e $Hb\subseteq Ha$.
Suponha então que $x \in Ha$, logo $x = ha$ para algum $h\in H$.
Precisamos mostrar que $x \in Hb$.
Calculamos:
$$
x
= ha
= e(ha)
= \paren{\paren{h_a h^{-1}}^{-1}\paren{h_a h^{-1}}} (ha)
= \paren{\paren{h^{-1}}^{-1} h_a^{-1}} h_a \cancel{\paren{h^{-1} h}} a
= \paren{h h_a^{-1}} \paren{h_a a}
= \paren{h h_a^{-1}} \paren{h_b b}
= \paren{h h_a^{-1} h_b} b
\in Hb.
$$%%}}}

\endexercise
%%}}}

%%{{{ thm: Lagrange 
\theorem Lagrange.
\Lagrange[teorema]%
Seja $G$ grupo finito e $H\subgroup G$.
Então $\groupord H \divides \groupord G$.
\sketch.
Sabemos que o $G$ pode ser particionado pelos right cosets de $H$,
e que cada um deles tem a mesma cardinalidade com o proprio $H$.
\qes
%%}}}

%%{{{ Corollaries as exercises 
\note Corollários.
Graças ao teorema de Lagrange ganhamos muitos
corollários diretamente, como tu vai verificar
agora resolvendo os exercícios seguintes:
%%}}}

%%{{{ x: subgroups_of_group_with_prime_order 
\exercise.
\label{subgroups_of_group_with_prime_order}%
Seja $G$ grupo com $\gord G = p$, onde $p$ primo.
Quais são todos os subgrupos de $G$?

\hint
Se $H\subgroup G$, pelo teorema de Lagrange temos que
$\gord H \divides \gord G$.  Quais são os divisores de $\gord G$?

\solution
Se $H\subgroup G$, pelo teorema de Lagrange temos que
$\gord H \divides \gord G = p$, logo $\gord H = 1$ ou $p$.
No primeiro caso $H = \set e$, no segundo, $H = G$.
Ou seja:
\emph{um grupo com ordem primo não tem subgrupos não-triviais}.

\endexercise
%%}}}

%%{{{ x: order_of_generate_a_divides_order_of_G 
\exercise.
\label{order_of_generate_a_divides_order_of_G}%
Seja $G$ grupo finito e $a\in G$.  Então $\gord a \divides \gord G$.

\hint
Se achar um subgrupo $H\subgroup G$ com $\gord H = \gord a$,
acabou (graças ao Lagrange).

\hint
Lembra que $\generate a$ é um subgrupo do $G$\dots?

\hint
\dots e que sua ordem é $\gord {\generate a} = \gord a$?

\solution
Sabemos que $\generate a$ é um subgrupo de $G$, com ordem
$\gord {\generate a} = \gord a$,
e pelo teorema de Lagrange, como $\generate a \subgroup G$
e $G$ é finito temos
$$
\gord a = \gord {\generate a} \divides \gord G.
$$

\endexercise
%%}}}

%%{{{ x: a_to_the_order_of_G_is_e 
\exercise.
\label{a_to_the_order_of_G_is_e}%
Seja $G$ grupo finito e $a\in G$.
Então $a^{\gord G} = e$.

\hint
Resolveu já o~\ref{order_of_generate_a_divides_order_of_G}?

\solution
Graças o~\ref{order_of_generate_a_divides_order_of_G} temos que
$\gord a \divides gord G$, ou seja, $\gord G = k\gord a$ para algum
$k\in\ints$.
Agora calculamos:
$$
a^{\gord G}
= a^{k\gord a}
= a^{\gord a k}
= \paren{a^{\gord a}}^k
= e^k
= e.
$$

\endexercise
%%}}}

\blah.
Vamos agora generalizar a notação que usamos nos cosets de
``multiplicação de subgrupo por elemento'' para
``multiplicação de subgrupo por subgrupo''.

%%{{{ df: HK 
\definition.
\label{HK_of_groups}%
Seja $G$ grupo e $H,K\subgroup G$.  Definimos
$$
HK \defeq \set { hk \st h\in H,\ k\in K }.
$$
%%}}}

%%{{{ Q: are HK and KH subgroups of G? 
\question.
$HK = KH$?
$HK \subgroup G$?
$KH \subgroup G$?
%%}}}

%%{{{ eg: calculate_HK_KH_S3 
\example.
No grupo $S_3$, sejam seus subgrupos
$$
\xalignat2
H &\leteq \set{ \id, \phi }
&
K &\leteq \set{ \id, \psi\phi }.
\endxalignat
$$
Calcule os $HK$ e $KH$ e decida se $HK=KH$ e se $HK$ e $KH$ são subgrupos de $S_3$.

\solution%%{{{
Pela definição
$$
\xalignat2
HK &= \set{ hk \st h\in H,\ k\in K}
& 
KH &= \set{ kh \st h\in H,\ k\in K}
\\
&= \set{
\id\compose\id,
\id\compose(\psi\compose\phi),
\phi\compose\id,
\phi\compose(\psi\compose\phi)
}
&
&= \set{
\id\compose\id,
\id\compose\phi,
(\psi\compose\phi)\compose\id,
(\psi\compose\phi)\compose\phi)
}
\\
&= \set{ \id, \psi\phi, \phi, \phi\psi\phi }
&
&= \set{ \id, \phi, \psi\phi, \psi\phi^2 }
\\
&= \set{ \id, \psi\phi, \phi, \psi^2}
&
&= \set{ \id, \phi, \psi\phi, \psi }\\
\intertext{Observamos que $HK\neq KH$ e nenhum deles é subgrupo de $S_3$, pois}
HK&\notni {(\psi\phi)}{\phi} = \psi(\phi\phi) = \psi\phi^2 = \psi
&KH&\notni {\psi}{\psi} = \psi^2.
\endxalignat
$$
%%}}}

\endexample
%%}}}

\blah.
Então descobrimos que em geral, nem $HK=KH$ nem $HK\subgroup G$, nem $KH\subgroup G$ são garantidos.
Pode acontecer que $HK \subgroup G$ mas $KH \not\subgroup G$?  E o que a igualdade $HK=KH$ tem
a ver com a ``subgrupidade'' dos $HK$ e $KH$?  Vamos responder em todas essas perguntas com
o teorema seguinte:

%%{{{ thm: HK = KH <=> HK subgrp G
\theorem.
\label{HK_equals_KH_iff_HK_subgroup}
Seja $G$ grupo e subgrupos $H,K \subgrp G$.  Então:
$$
HK = KH
\iff
HK \subgrp G
$$
%%{{{ sketch and proof 
\sketch.
Para a direção \lrdir, precisamos mostrar que $HK$ é fechado sobre a operação e fechado sobre os inversos.
Tomamos aleatorios $h_1k_1,h_2k_2\in HK$ e aplicando as propriedades de grupo e nossa hipótese,
mostramos que $(h_1k_1)(h_2k_2) \in HK$.  Similarmente para os inversos: consideramos um
arbitrario elemento $hk\in HK$ e mostramos que seu inverso $\pginv{hk} \in HK$.  Aqui, alem da
hipótese precisamos o~\ref{inverse_of_product_in_group}.
Para a direção \rldir, mostramos as ``$\subseteq$'' e ``$\supseteq$'' separadamente,
usando ideias parecidas.
\qes
\proof.
\lrdir:
Precisamos mostrar que $HK$ é fechado sobre a operação e fechado sobre os inversos.
Tomamos aleatorios $h_1k_1,h_2k_2\in HK$ e calculamos:
$$
\alignat2
(h_1k_1)(h_2k_2)
= h_1(k_1h_2)k_2 \qqby{ass.}\\
= h_1(h_3k_3)k_2\quad\text{para alguns $h_3\in H$ e $k_3 \in K$} \qqby{$k_1h_2\in KH = HK$}\\
= (h_1h_3)(k_3k_2)\qqby{ass.}\\
\in HK
\endalignat
$$
Para os inversos temos:
$$
\pginv {h_1k_1} = \ginv{k_1} \ginv{h_1} \in KH = HK.
$$
\endgraf
\rldir:
Mostramos as ``$\subseteq$'' e ``$\supseteq$'' separadamente.
``$\subseteq$'':
Tome $x \in HK$, logo $x^{-1} \in HK$ e $x^{-1} = hk$ \emph{para alguns}
$h\in H$ e $k\in K$.  Como $H$ e $K$ são sub\emph{grupos} de $G$ seus inversos
também estão em $H$ e $K$ respectivamente.
Mas
$$
x = \pginv{\ginv x} = \pginv{hk} \ginv k \ginv h \in KH.
$$
``$\supseteq$'':
Tome $x \in KH$, logo $x = kh$ \emph{para alguns} $k\in K$, $h\in H$.
Logo $\ginv k \in K$ e $\ginv h \in H$.
Como $HK\subgrp G$, basta apenas provar que $\ginv x \in HK$ pois isso
garantará que $x \in HK$ também.
Realmente, $\ginv x = \pginv{kh} = \ginv h \ginv k \in HK$.
\qed
%%}}}
%%}}}

\endsection
%%}}}

%%{{{ Number theory revisited 
\section Teoria de números revisitada.
\label{number_theory_revisited}%

%%{{{ x: the multiplicative group Zp 
\exercise.
Seja $p$ primo e defina
$\cal Z_p = \sset {\finord p \setminus \set0} {\ntimes}$
onde $\ntimes$ é a multiplicação módulo $p$.
Mostre que $\cal Z_p$ é um grupo e ache sua ordem.

\endexercise
%%}}}

%%{{{ x: the multiplicative group Zn 
\exercise.
Seja $n\in\nats$ com $n>1$ e defina
$\cal Z_n = \sset {\set{a \in \finord n \st \gcd a n = 1}} {\ntimes}$
onde $\ntimes$ é a multiplicação módulo $n$.
Mostre que $\cal Z_n$ é um grupo e ache sua ordem.

\endexercise
%%}}}

\endsection
%%}}}

%%{{{ Normal subgroups 
\section Subgrupos normais.

\endsection
%%}}}

%%{{{ Morphisms 
\section Morfismos.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

Livros introdutórios em álgebra abstrata tratam em geral
a teoria de grupos mais profundamente que podemos tratar aqui.
\cite{pinteralgebra} é um desses livros, bastante acessível,
com exemplos de diversas áreas, mostrando várias aplicações.
Uma \emph{excelente} introdução em vários tópicos de álgebra é
o~\cite{hersteintopics}, famoso para sua exposição e didática.

A álgebra abstrata foi introduzida nos currículos de graduação
com o clássico~\cite{babybm}.  Os mesmos autores, no~\cite{papamb},
apresentam álgebra mais profundamente com um ponto de vista
categórico (veja~\ref{category_theory}).

Depois de se acostumar com as idéias algébricas em geral,
dois livros focados especialmente em teoria de grupos
são os~\cite{rosegroups} e~\cite{rotmangroups}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Abstract algebra 
\chapter Álgebra abstrata.

%%{{{ History 
\history.

\Galois{}Galois, \Abel{}Abel.

\endhistory
%%}}}

%%{{{ Operations 
\section Operações.

\endsection
%%}}}

%%{{{ Algebraic structures 
\section Estruturas algébricas.

\endsection
%%}}}

%%{{{ Rings 
\section Aneis.

\endsection
%%}}}

%%{{{ Monoids 
\section Monoides.

\endsection
%%}}}

%%{{{ Homomorphisms 
\section Homomorfismos.

\endsection
%%}}}

%%{{{ Isomorphisms  
\section Isomorfismos.

\endsection
%%}}}

%%{{{ Fields 
\section Corpos.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{pinteralgebra},
\cite{hersteintopics},
\cite{babybm},
\cite{papamb}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Graph theory 
\chapter Teoria de grafos.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

Umas introduções extensas são
o clássico~\cite{bondymurty1976}
e o mais novo~\cite{ChartrandZhang}.
Depois continua com~\cite{diestelgraph}
e~\cite{bondymurty2011}.
Finalmente, um nível ainda mais avançado, \cite{bollobasmodern}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Structural induction and recursion 
\chapter Indução e recursão estrutural.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{aczelinductive},
\cite{ynminduction}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Algebraic data types 
\chapter Tipos de dados algébricos.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Lambda calculus and combinatory logic 
\chapter Lambda calculus e lógica combinatória.

%%{{{ The untyped lambda calculus 
\section O $\lambda$-calculus não-tipado.

\endsection
%%}}}

%%{{{ Faithfully representing mathematics 
\section Representando matemática fielmente.

\endsection
%%}}}

%%{{{ Programming 
\section Programmando.

\endsection
%%}}}

%%{{{ Recursion and fixpoints 
\section Recursão e fixpoints.

\endsection
%%}}}

%%{{{ Combinatory logic 
\section Lógica combinatória.

\endsection
%%}}}

%%{{{ Functional programming 
\section Programação funcional.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{hindleyseldinlambdacl},
\cite{barendregtlambda}.

\cite{mockingbird},
\cite{bimbocl}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Mathematical logic 
\chapter Lógica matemática.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

Sobre lógica matemática:
\cite{kleeneIM},
\cite{curryfoundations};
\cite{kleenelogic},
\cite{smullyanfol};
\cite{corilascar1}~\&~\cite{corilascar2},
\cite{shoenfieldlogic},
\cite{bellmachover}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Proof theory 
\chapter Teoria de provas.
\label{proof_theory}%

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{vonplatoelements},
\cite{bimboproof},
\cite{negrivonplatospt},
\cite{takeuti},
\cite{prawitz},
\cite{proofsandtypes},
\cite{olthdem},
\cite{kleeneIM}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Axiomatic set theory 
\chapter Teoria axiomática de conjuntos.
\label{axiomatic_set_theory}%

%%{{{ Problems in paradise 
\section Problemas no paraíso.

\endsection
%%}}}

%%{{{ Naïve set theory and Russell's paradox 
\section Teoria ingênua de conjuntos e o paradoxo de Russell.

\endsection
%%}}}

%%{{{ Zermelo's solution 
\section A solução de Zermelo.
\endsection
%%}}}

%%{{{ Faithfully representing mathematics 
\section Representando matemática fielmente.

\endsection
%%}}}

% TODO List axioms gradually, defining/proving more and more

%%{{{ The Zermelo–Fraenkel–Skolem axioms 
\section Os axiomas de Zermelo--Fraenkel--Skolem.
\endsection
%%}}}

%%{{{ Controversal consequences 
\section Conseqüências controversiais.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{halmosnaive},
\cite{ynmnst},
\cite{kunenfoundations}.
\cite{kunen2011},
\cite{cohensetch},
\cite{kunen1980},
\cite{jechset}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Constructing the natural numbers
\chapter Construindo os números naturais.

% TODO Check for overlap with "the natural numbers, formally",
% in recursion chapter.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{ynmnst}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Cardinal arithmetic 
\chapter Aritmética cardinal.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Computability and complexity 
\chapter Computabilidade e complexidade.

%%{{{ A surprisingly difficult question 
\section Uma questão surpresamente difícil.

\endsection
%%}}}

%%{{{ Models of computation 
\section Modelos de computação.

\endsection
%%}}}

%%{{{ Decision problems 
\section Problemas de decisão.

\endsection
%%}}}

%%{{{ The halting problem 
\section O problema da parada.

\endsection
%%}}}

%%{{{ Analysis of algorithms 
\section Análise de algorítmos.

\endsection
%%}}}

%%{{{ Computational complexity 
\section Complexidade computacional.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{cutlandcomputability},
\cite{kleeneIM},
\cite{rogersrecursive}.

\cite{dpv},
\cite{jonescomputability}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Formal languages 
\chapter Linguagens formais.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Ordered sets 
\chapter Conjuntos ordenados.

%%{{{ Concept, notation, properties 
\section Conceito, notação, propriedades.
%TODO (Conceito)
%TODO (Diagramas Hasse)
%TODO (Ordens parciais, totais, densas, bem-fundadas)
%TODO (Elementos notáveis: majorantes, máximos, supremos)
\endsection
%%}}}

%%{{{ Operations and constructions
\section Operações e construções.
%TODO (Construções de conjutos ordenados)
%TODO (Dualidade)
%TODO (Ordens canônicas, ordens lexicográficas)
\endsection
%%}}}

%%{{{ Down-sets and up-sets 
\section Down-sets e up-sets.

\endsection
%%}}}

%%{{{ Mappings 
\section Mapeamentos.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{DaveyPriestley},
\cite{goldreisets}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Lattices 
\chapter Reticulados.

%%{{{ Lattices as posets 
\section Reticulados como posets.

\endsection
%%}}}

%%{{{ Lattices as algebraic structures 
\section Reticulados como estruturas algébricas.

\endsection
%%}}}

%%{{{ Complete lattices 
\section Reticulados completos.

\endsection
%%}}}

%%{{{ Irreducible elements 
\section Elementos irredutíveis.

\endsection
%%}}}

%%{{{ The Knaster--Tarski fixpoint theorem 
\section O teorema fixpoint de Knaster--Tarski.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\problem Teorema de decomposição de Banach.

\endproblem

\problem Teorema de Schröder--Bernstein.

\endproblem

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{DaveyPriestley},
\cite{gratzerlatticefirst},
\cite{gratzerlatticefoundation}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Denotational semantics 
\chapter Semântica denotacional.

%TODO: Check http://pages.cs.wisc.edu/~horwitz/CS704-NOTES/
%TODO: use Stoy and Tennent

%%{{{ A language of binary numerals 
\section Uma linguagem de numerais binários.

\endsection
%%}}}

%%{{{ A little programming language 
\section Uma pequena linguagem de programação.

\endsection
%%}}}

%%{{{ Domain theory 
\section Teoria de domínios.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{stoysemantics},
\cite{tennent1976},
\cite{tennentsemantics}.

\cite{streicherdomains}.

\cite{lpbook}.

\cite{winskelsemantics}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Boolean algebras 
\chapter Álgebras booleanas.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{halmosboolean}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Well-orderings and transfinite induction 
\chapter Bem-ordens e indução transfinita.

% mention bem vs boa (translation)

\definition Bem-ordem.
Seja $\sset A <$ um conjunto ordenado.
Sua ordem $<$ é uma \dterm{bem-ordem}, sse
\emph{cada subconjunto $S\subseteq A$ possui um elemento mínimo}.
Nesse caso chamamos o $A$ \dterm{bem-ordeneado}.

%%{{{ Transfinite induction 
\section Indução transfinita.

\endsection
%%}}}

%%{{{ Transfinite recursion 
\section Recursão transfinita.

\endsection
%%}}}

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{goldreisets},
\cite{ynmnst}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Ordinal arithmetic 
\chapter Aritmética ordinal.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{goldreisets},
\cite{ynmnst},
\cite{kunen2011}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: The real numbers 
\chapter Os números reais.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{ynmnst}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Metric spaces 
\chapter Espaços métricos.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{simmonstopology},
\cite{kolmogorovfomin},
\cite{carothersreal}.

``Baby Rudin''~\cite{babyrudin}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: General topology 
\chapter Topologia geral.

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{janichtopology},
\cite{simmonstopology},
\cite{munkrestopology},
\cite{willardtopology}.

\cite{vickerstopology}.

\endfurther
%%}}}

\endchapter
%%}}}

%%{{{ chapter: Category theory
\chapter Teoria de categorias.
\label{category_theory}%

%%{{{ Problems 
\problems.

\endproblems
%%}}}

%%{{{ Further reading 
\further.

\cite{babylawvere},
\cite{papalawvere}.
\cite{goldblatttopoi}.

\cite{awodeycats},
\cite{barrwellscatscs},
\cite{joyofcats}.

\cite{riehlcats},
\cite{maclanecats}.

\endfurther
%%}}}

\endchapter
%%}}}
